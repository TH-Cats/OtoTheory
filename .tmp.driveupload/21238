//
//  OtoTheoryApp.swift
//  OtoTheory
//
//  Created by Norito Harada on 2025/10/04.
//

import SwiftUI

@main
struct OtoTheoryApp: App {
    @UIApplicationDelegateAdaptor(AppDelegate.self) var appDelegate
    
    init() {
        audioTrace("BOOT mark — app did launch")
        
        // スモークテスト: リソースの存在確認
        let bundle = Bundle.main
        print("📦 [SmokeTest] Bundle path: \(bundle.bundlePath)")
        
        debugDumpArticlesTree()
    }
    
    func debugDumpArticlesTree() {
        guard let base = Bundle.main.resourceURL?.appendingPathComponent("Resources") else {
            print("❌ [SmokeTest] Resources folder not found in bundle")
            return
        }
        
        let resourcesExists = FileManager.default.fileExists(atPath: base.path)
        print("📂 [SmokeTest] Resources folder exists: \(resourcesExists)")
        
        ["ja", "en"].forEach { lang in
            let path = base.appendingPathComponent(lang).path
            let exists = FileManager.default.fileExists(atPath: path)
            print("📦 [Bundle] \(lang) exists? \(exists) at \(path)")
            if exists, let files = try? FileManager.default.contentsOfDirectory(atPath: path) {
                print("   files:", files)
            }
        }
    }
    
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}

"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8685],{8685:function(e,t,a){a.r(t),a.d(t,{default:function(){return er}});var n=a(7437),s=a(2265),o=a(1720),r=a(888),i=a(1804),l=a(8427),c=a(4018),d=a(8501);let u={0:0,2:1,4:2,5:3,7:4,9:5,11:6},m={0:0,2:1,3:2,5:3,7:4,8:5,10:6},h=["I","ii","iii","IV","V","vi","vii\xb0"],p=["i","ii\xb0","III","iv","v","VI","VII"];function g(e){return/maj7|M7/.test(e)}function y(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{showQuality:s=!0,accidentalsForNonDiatonic:o=!1}=n;if(!e||!t)return"";let r=(0,l.Hl)(t),i=e.split("/")[0].match(/^([A-G](?:#|b)?)(.*)$/i);if(!i)return e;let c=function(e){var t;let a=(0,l.Hl)(e);return null!==(t=l.T_[a])&&void 0!==t?t:e}(i[1].toUpperCase()),d=i[2]||"",y=((0,l.Hl)(c)-r+12)%12,x="major"===a?h:p,f=("major"===a?u:m)[y];if(void 0!==f){let e=n.uppercase?["I","II","III","IV","V","VI","VII"][f]:x[f];return(n.uppercase&&("major"===a&&6===f||"minor"===a&&1===f)&&(e+="\xb0"),s)?g(d)?e+"M7":!(g(d)||/m7b5|ø|dim7/.test(d))&&(/(\b|[^a-zA-Z])7(?![b#0-9])/i.test(d)||/\bm7\b/i.test(d))?e+"7":e:e}if(o){let e="major"===a?[0,2,4,5,7,9,11]:[0,2,3,5,7,8,10];for(let t=0;t<e.length;t++){let a=e[t];if((a+1)%12===y)return"#"+x[t];if((a+11)%12===y)return"b"+x[t]}}return"(".concat(c,")")}var x=a(3561);function f(e){let{children:t,className:a="",right:s,as:o="h2"}=e;return(0,n.jsxs)("div",{className:"mb-2 flex items-center gap-2 ".concat(a),children:[(0,n.jsx)(o,{className:"text-xl md:text-2xl font-semibold tracking-tight text-foreground",children:t}),s?(0,n.jsx)("div",{className:"ml-auto",children:s}):null]})}function b(e){let{children:t,className:a="",right:s,as:o="h3"}=e;return(0,n.jsxs)("div",{className:"mb-1.5 flex items-center gap-2 ".concat(a),children:[(0,n.jsx)(o,{className:"text-sm md:text-base font-semibold tracking-wide text-foreground",children:t}),s?(0,n.jsx)("div",{className:"ml-auto text-xs md:text-sm text-muted-foreground",children:s}):null]})}var v=a(4591),j=a(6238),w=a(1774),k=a(9168);let I=["6","m6","9","m9","11","M11","13","M13","7b5","7#5","7b9","7#9","7#11","7b13","7alt","dim7","m7b5","sus2","add9","add11","add13","6/9","aug","mM7","/bass"];var N=a(8334),C=a(1690);let S=[{id:"doo-wop",name:"Doo‑Wop (I–vi–IV–V)",mode:"major",seq:["I","vi","IV","V"],summary:"50s/60s loop: I→vi→IV→V back to I."},{id:"axis",name:"Axis (I–V–vi–IV)",mode:"major",seq:["I","V","vi","IV"],summary:"Modern pop four‑chords loop."},{id:"canon",name:"Pachelbel's Canon",mode:"major",seq:["I","V","vi","iii","IV","I","IV","V"],variants:[["I","V","vi","IV"]],summary:"Pachelbel‑style ground; long loop back to I."},{id:"ii-V-I",name:"ii–V–I",mode:"any",seq:["ii","V","I"],summary:"The classic resolution run‑up."},{id:"turnaround",name:"Turnaround (I–vi–ii–V)",mode:"any",seq:["I","vi","ii","V"],summary:"Quick loop returning to the top."},{id:"andalusian",name:"Andalusian (i–VII–VI–V)",mode:"minor",seq:["i","VII","VI","V"],summary:"Classic minor descent; flamenco/Latin flavor."},{id:"authentic",name:"Authentic cadence (V–I)",mode:"any",seq:["V","I"],summary:"Perfect cadence V→I."},{id:"plagal",name:"Plagal cadence (IV–I)",mode:"any",seq:["IV","I"],summary:"Gentle IV→I resolution."},{id:"deceptive",name:"Deceptive cadence (V–vi)",mode:"major",seq:["V","vi"],summary:"Deceptive V→vi keeps motion going."}],V={dooWop:"Doo‑Wop (I–VI–IV–V)",axis:"Axis (I–V–vi–IV)",canon:"Canon (I–V–vi–iii–IV–I–IV–V)",twoFiveOne:"ii–V–I",turnaround:"Turnaround",andalusian:"Andalusian cadence",authentic:"Perfect cadence (V → I)",plagal:"Plagal cadence (IV → I)",deceptive:"Deceptive cadence (V → vi)"},T={dooWop:"’50s progression. Nostalgic loop: tonic → relative minor → subdominant → dominant. Try adding 7ths for color.",axis:"Modern pop staple. A catchy loop that feels forward yet stable. Swap to ii–V at the end for a stronger landing.",canon:"Pachelbel‑style ground. Persistent bass motion with rotating functions; great for variations and melodies.",twoFiveOne:"The classic run‑up then land. Link by guide tones (3rd↔7th). Works anywhere you want a clear resolution.",turnaround:"Short cycle that brings you back to the top (e.g., I–VI7–ii7–V7). Use at phrase ends or between sections.",andalusian:"Descending minor flavor (e.g., i–♭VII–♭VI–V). Adds drama; land clearly on the target chord.",authentic:"Strong homecoming: dominant pulls into tonic. Extend V with 7/9/13; keep the landing clean on I.",plagal:"Gentler IV → I resolution. Use to soften endings or after a bright Lydian moment.",deceptive:"Twist the expectation: V → vi instead of I. Keeps energy moving; return to I later for closure."};function M(e){return(e||"").toString().trim().toUpperCase().replace(/MAJ7|M7|7|MAJ|MIN|MI|DIM|AUG|SUS\d?|ADD\d+|Ø|O/g,"").replace(/\(|\)/g,"").replace(/[^IVB#]+/g,"").replace(/B/g,"B")}var P=a(5618);let E="ot_sketches",A=()=>JSON.parse(localStorage.getItem(E)||"[]"),D=e=>{let t=A().filter(t=>t.id!==e.id);return(t.unshift(e),t.length>3)?(localStorage.setItem(E,JSON.stringify(t.slice(0,3))),{ok:!1,reason:"limit_exceeded"}):(localStorage.setItem(E,JSON.stringify(t)),{ok:!0})},R=async e=>({ok:!0});var q=a(7152);let U=e=>{let[t,a]=(0,s.useState)(null),n=(0,s.useRef)(null),o=()=>{n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(()=>{t&&(async()=>{let a=e?await R(t):D(t);!a.ok&&"reason"in a&&"limit_exceeded"===a.reason?q.j("project_limit_warn",{page:"chord_progression"}):q.j("save_project",{page:"chord_progression"})})()},3e3)};return(0,s.useEffect)(()=>{o()},[t]),{sketch:t,setSketch:a}};var _=a(903);let z=()=>Math.random().toString(36).substr(2,9),F=(0,_.U)((e,t)=>({sketches:[],currentSketch:null,isLoading:!1,error:null,loadSketches:()=>{e({isLoading:!0,error:null});try{let t=A();e({sketches:t,isLoading:!1})}catch(t){e({error:"Failed to load sketches",isLoading:!1})}},saveSketch:async t=>{let a={...t,id:z(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(D(a).ok)return e({sketches:A(),currentSketch:a}),{ok:!0};try{await R(a);let t=A();return e({sketches:t,currentSketch:a}),{ok:!0}}catch(e){return{ok:!1,reason:"cloud_save_failed"}}},loadSketch:a=>{let n=t().sketches.find(e=>e.id===a);n&&e({currentSketch:n})},deleteSketch:a=>{var n;let s=t().sketches.filter(e=>e.id!==a);localStorage.setItem("ot_sketches",JSON.stringify(s)),e({sketches:s}),(null===(n=t().currentSketch)||void 0===n?void 0:n.id)===a&&e({currentSketch:null})},duplicateSketch:a=>{let n=t().sketches.find(e=>e.id===a);if(n){let t={...n,id:z(),name:"".concat(n.name," Copy"),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};D(t).ok&&e({sketches:A(),currentSketch:t})}},renameSketch:(a,n)=>{var s;let o=t().sketches.map(e=>e.id===a?{...e,name:n,updatedAt:new Date().toISOString()}:e);localStorage.setItem("ot_sketches",JSON.stringify(o)),e({sketches:o}),(null===(s=t().currentSketch)||void 0===s?void 0:s.id)===a&&e({currentSketch:{...t().currentSketch,name:n,updatedAt:new Date().toISOString()}})},startAutoSave:a=>setTimeout(()=>{var n;if((null===(n=t().currentSketch)||void 0===n?void 0:n.id)===a.id){let t={...a,updatedAt:new Date().toISOString()};D(t).ok&&e({sketches:A(),currentSketch:t})}},3e3),stopAutoSave:()=>{}}));var B=a(7293);let J=!1;async function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";if(!J){J=!0;try{let a=e.style.opacity,n=e.style.visibility;e.style.opacity="1",e.style.visibility="visible";let s=e.querySelectorAll("*"),o=[];s.forEach(e=>{let t=e.style.color,a=e.style.fill,n=e.style.background;if(o.push({elem:e,color:t,fill:a,bg:n}),e.style.color="#000000",("text"===e.tagName||"tspan"===e.tagName)&&(e.style.fill="#000000"),"SPAN"===e.tagName&&e.className.includes("inline-block")){var s;let t=null===(s=e.textContent)||void 0===s?void 0:s.trim();t&&/^\d+$/.test(t)&&(e.style.background="#f3f4f6",e.style.color="#000000")}}),await new Promise(e=>setTimeout(e,150)),e.dataset.export=t;let r=await (0,B.YM)(e,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0});e.style.opacity=a,e.style.visibility=n,o.forEach(e=>{let{elem:t,color:a,fill:n,bg:s}=e;t.style.color=a,t.style.fill=n,t.style.background=s});let i=document.createElement("a");i.href=r,i.download="ot-progression.png",i.click(),q.j("export_png",{page:"chord_progression",ok:!0})}catch(e){q.j("export_png",{page:"chord_progression",ok:!1,err:String(e)})}finally{e.removeAttribute("data-export"),J=!1}}}var L=a(4120),W=a(1792);let H={info:"bg-blue-600",success:"bg-green-600",warning:"bg-orange-600"};function G(e){let{message:t,type:a="info",ctaText:o,ctaHref:r,ctaPlace:i,onClose:l,duration:c=5e3}=e,{trackClick:d}=(0,W.Z)();(0,s.useEffect)(()=>{if(c>0){let e=setTimeout(l,c);return()=>clearTimeout(e)}},[c,l]);let u=(0,s.useCallback)(()=>{i&&d(i)},[i,d]),m=H[a];return(0,n.jsx)("div",{className:"fixed bottom-20 sm:bottom-6 left-1/2 -translate-x-1/2 z-50 animate-slide-up max-w-md w-full mx-4",role:"alert","aria-live":"polite",children:(0,n.jsxs)("div",{className:"".concat(m," text-white rounded-lg shadow-2xl p-4 flex items-center justify-between gap-3"),children:[(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)("p",{className:"text-sm font-medium",children:t})}),o&&r&&(0,n.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-white/20 hover:bg-white/30 rounded transition-colors",onClick:u,children:o}),(0,n.jsx)("button",{onClick:l,className:"flex-shrink-0 w-6 h-6 flex items-center justify-center hover:bg-white/20 rounded transition-colors","aria-label":"Close notification",children:"✕"})]})})}var Z=a(8041),Y=a(6463);let K={plan:"free",notationStyle:"english"},Q=new Set(["7b9","7#9","7#11","7b13","7alt","13","M13","m13"]),X=[{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"Major",commentJa:"Vibe: 明るくポジティブ。物語の始まりやサビにふさわしい、安定感と幸福感に満ちた響きです。\nUsage: J-POP、ロック、フォーク、童謡など、あらゆる音楽の基本となるコード。楽曲の骨格を形成します。\nTry: 曲の最も盛り上がる部分や、リスナーに安心感を与えたい場面で使ってみよう。ここぞという時の主役になります。\nTheory: 構成音はR-3-5。メジャースケール（イオニアン）上で完璧に調和し、ダイアトニックのI度、IV度、V度で登場します。",commentEn:"Vibe: Bright and positive. A sound full of stability and happiness, perfect for the start of a story or a chorus.\nUsage: The fundamental chord in all music, from J-Pop and rock to folk. It forms the skeleton of a song.\nTry: Use it in the most climactic parts of a song or when you want to give the listener a sense of security.\nTheory: Composed of R-3-5. It harmonizes perfectly with the Major (Ionian) scale and appears as the I, IV, and V chords."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"m (minor)",commentJa:"Vibe: 少し切なく、落ち着いた雰囲気。喜びだけでなく、哀愁や内省的な感情を表現するのに最適です。\nUsage: バラード、ロック、R&Bなど、深みのある楽曲には欠かせない存在。メジャーとの対比が曲にドラマを生みます。\nTry: Aメロで静かに始めたい時や、サビ後のクールダウン、感情的な歌詞に乗せて使ってみましょう。\nTheory: 構成音はR-b3-5。b3(短3度)の音が特徴です。ナチュラルマイナースケール（エオリアン）の基本コードになります。",commentEn:"Vibe: Slightly sad and calm. Perfect for expressing not just joy, but also melancholy and introspection.\nUsage: Essential for deep songs like ballads, rock, and R&B. Its contrast with major chords creates drama.\nTry: Use it to start a verse quietly, to cool down after a chorus, or to accompany emotional lyrics.\nTheory: Composed of R-b3-5. The b3rd is its key feature. It's the basic chord of the Natural Minor (Aeolian) scale."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"7",commentJa:"Vibe: 少し不安定で、次へ進みたいという推進力を持つサウンド。ブルージーでおしゃれな緊張感が魅力です。\nUsage: ブルース、ジャズ、ファンク、ロックンロールの魂。楽曲にドライブ感と解決への期待感を与えます。\nTry: サビの直前（V7）に置いて、解決感を劇的に高めてみましょう。ブルース進行の主役としても活躍します。\nTheory: 構成音はR-3-5-b7。ミクソリディアンスケール上で自然に発生。V7→Iという最強の進行（ドミナントモーション）を作ります。",commentEn:"Vibe: A slightly unstable sound with a drive to move forward. Its bluesy, stylish tension is captivating.\nUsage: The soul of blues, jazz, and funk. It gives a song drive and anticipation for resolution.\nTry: Place it right before the chorus (as a V7) to dramatically enhance the feeling of resolution.\nTheory: Composed of R-3-5-b7. It naturally occurs on the Mixolydian scale and creates the powerful V7→I progression (dominant motion)."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"maj7",commentJa:"Vibe: 明るさの中に洗練された都会的な響きが同居。爽やかな風が吹くような、開放的でおしゃれなサウンドです。\nUsage: J-POP、R&B、ジャズ、ボサノヴァの定番。楽曲の始まりや終わりに使うと、余韻のある雰囲気を演出できます。\nTry: 明るい曲のトニックコード(I)をこれ(Imaj7)に変えてみましょう。一瞬でサウンドが洗練され、シティポップ模が生まれます。\nTheory: 構成音はR-3-5-7。長7度の音が特徴です。メジャースケール（イオニアン）やリディアンスケールと相性抜群です。",commentEn:"Vibe: A sophisticated, urban sound within a bright context. Open and stylish, like a fresh breeze.\nUsage: A staple in J-Pop, R&B, and jazz. Using it at the beginning or end of a song creates a lingering atmosphere.\nTry: Change the tonic chord (I) of a bright song to Imaj7. The sound will instantly become more refined.\nTheory: Composed of R-3-5-7. The major 7th is its key feature. It pairs perfectly with the Major (Ionian) and Lydian scales."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"m7",commentJa:"Vibe: マイナーの切なさに、ジャズやソウルの香りを加えた、少し大人びた響き。クールで落ち着いています。\nUsage: ジャズのスタンダードやR&B、ファンク、AORで頻繁に使われる、マイナーキーの基本的な和音です。\nTry: マイナーキーの曲で、トニックコード(Im)をこれ(Im7)に変えてみましょう。ただ暗いだけでない、知的な雰囲気に変わります。\nTheory: 構成音はR-b3-5-b7。ナチュラルマイナー（エオリアン）やドリアンスケール上で発生します。",commentEn:"Vibe: Adds a touch of jazz and soul to minor sadness, creating a mature, cool, and calm sound.\nUsage: The fundamental minor chord in jazz standards, R&B, and funk.\nTry: In a minor key song, change the tonic chord from Im to Im7. It will shift the mood from simply dark to something more intelligent.\nTheory: Composed of R-b3-5-b7. It occurs on the Natural Minor (Aeolian) and Dorian scales."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"sus4",commentJa:"Vibe: メジャーでもマイナーでもない、解決を焦らす浮遊感。リスナーの期待感をグッと高める効果があります。\nUsage: ポップス、ロック、ファンクなどジャンルを問わず使われる。特にAメロからBメロへの繋ぎなどで効果的です。\nTry: V7の前に置き(V7sus4)、より劇的な解決感を演出してみましょう。アコギのストロークで使うと響きが豊かになります。\nTheory: 3度の音を4度にした(R-4-5)コード。susはSuspended(吊るされた)の略で、3度への解決を待ち望んでいます。",commentEn:'Vibe: A floating feel, neither major nor minor, that delays resolution and builds anticipation in the listener.\nUsage: Used across all genres. Especially effective for transitions, like from a verse to a bridge.\nTry: Place it before a V7 (as V7sus4) to create a more dramatic resolution. It sounds rich in acoustic strumming.\nTheory: Replaces the 3rd with a 4th (R-4-5). "Sus" is short for Suspended, as it longs to resolve to the 3rd.'},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"sus2",commentJa:"Vibe: sus4よりも、さらに明るく爽やかで、キラキラした浮遊感。若々しさや純粋さを感じさせます。\nUsage: J-POPやロックバラードのイントロやアルペジオで多用される。澄んだ響きがアコースティックギターによく合います。\nTry: メジャーコードの代わりに一瞬だけ使ってみましょう。サウンドに爽やかな風が吹き込み、単調さがなくなります。\nTheory: 3度の音を2度にした(R-2-5)コード。ポップスではadd9に近い響きの飾り（embellishment）として使われます。",commentEn:"Vibe: Brighter and fresher than sus4, with a sparkling floatiness that evokes youthfulness and purity.\nUsage: Often used in intros and arpeggios of J-Pop and rock ballads. Its clear sound suits acoustic guitars.\nTry: Briefly substitute it for a major chord. It will add a fresh breeze to your sound and break up monotony.\nTheory: Replaces the 3rd with a 2nd (R-2-5). In pop, it's often used as an embellishment with a sound similar to add9."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"add9",commentJa:"Vibe: 通常のコードに、透明感や希望の光を一筋加える、感動的な響き。サウンドに広がりと彩りを与えます。\nUsage: 現代のポップス、ロック、バラードではなくてはならない存在。特にピアノやギターのアルペジオで美しい響きを生みます。\nTry: サビの最後のコードをこれに変えてみましょう。曲のエンディングに、感動的な余韻と広がりが生まれます。\nTheory: メジャー(R-3-5)に9度の音を追加したコード。9度は2度と同じ音ですが、3度と共存しているのがポイントです。",commentEn:"Vibe: An emotional sound that adds a layer of transparency and hope to a basic chord, creating spaciousness and color.\nUsage: An indispensable chord in modern pop, rock, and ballads. It sounds beautiful in piano or guitar arpeggios.\nTry: Change the last chord of the chorus to this one. It will create a moving, expansive finish to your song.\nTheory: Adds a 9th note to a major triad (R-3-5-9). The 9th is the same note as the 2nd, but the key is its coexistence with the 3rd."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"dim",commentJa:"Vibe: 不気味で、聴き手を不安にさせるスリリングな響き。物語にサスペンスやミステリーの要素を加えます。\nUsage: ジャズやクラシックで、コードとコードを滑らかに繋ぐ「経過コード」として使われるのが定石です。\nTry: Bdimのような経過コードをCとAmの間に挟んでみましょう。ベースラインが滑らかになり、プロっぽい響きになります。\nTheory: 構成音はR-b3-b5。不安定なトライトーン(b5)が強い緊張感を生み出します。",commentEn:'Vibe: A spooky, thrilling sound that creates unease, adding an element of suspense or mystery to a story.\nUsage: A classic "passing chord" in jazz and classical music used to smoothly connect other chords.\nTry: Insert a passing chord like Bdim between C and Am. The bassline will become smoother and sound more professional.\nTheory: Composed of R-b3-b5. Its unstable tritone interval (b5) generates strong tension.'},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"M9 (maj9)",commentJa:"Vibe: maj7をさらに進化させた、優雅で甘美、夢見心地な響き。ラグジュアリーな空間を演出します。\nUsage: R&B、ネオソウル、フュージョンの王道サウンド。これ一つで曲のおしゃれ度が格段にアップします。\nTry: 静かなバラードのトニックコード(Imaj7)をこれ(Imaj9)にしてみましょう。サウンドに深みと極上の甘さが加わります。\nTheory: maj7(R-3-5-7)に9度の音を追加したコード。リディアンスケールとの相性は最高です。",commentEn:"Vibe: An evolution of maj7, creating an elegant, sweet, and dreamy atmosphere. Evokes a sense of luxury.\nUsage: The quintessential sound of R&B, Neo-Soul, and Fusion. It instantly elevates the chicness of a song.\nTry: In a quiet ballad, change the tonic Imaj7 to Imaj9. It will add depth and a sublime sweetness to the sound.\nTheory: Adds a 9th to a maj7 chord (R-3-5-7-9). It has a fantastic compatibility with the Lydian scale."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"6",commentJa:"Vibe: maj7よりも少しだけ素朴で、温かくレトロな雰囲気。50-60年代のような、懐かしい響きです。\nUsage: 古き良き時代のジャズやポップス、ハワイアン音楽で多用される。サウンドを柔らかく、穏やかにします。\nTry: maj7の代わりに使ってみましょう。特に曲のエンディングで使うと、ハッピーエンドの映画のような、温かい余韻が残ります。\nTheory: メジャー(R-3-5)に長6度の音を加えたコード。トニックコード(I)のバリエーションとして使えます。",commentEn:"Vibe: A bit simpler and warmer than maj7, with a nostalgic, retro vibe like the 50s-60s.\nUsage: Frequently used in old-time jazz, pop, and Hawaiian music. It softens the sound and makes it gentle.\nTry: Use it instead of maj7. Especially at the end of a song, it leaves a warm afterglow, like a happy-ending movie.\nTheory: Adds a major 6th to a major triad (R-3-5-6). It can be used as a variation of the tonic chord (I)."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"6/9",commentJa:"Vibe: 6コードの温かさとadd9のキラキラ感を併せ持つ、非常に豊かでゴージャスな響き。\nUsage: ジャズピアノのエンディングなどで聴ける、幸福感に満ちたサウンド。フュージョンやAORでも使われます。\nTry: 曲の最後の最後、全ての音が消える直前のキメの和音として使ってみましょう。最高の多幸感を演出できます。\nTheory: R-3-5に6度と9度の両方を加えた贅沢なコード。構成音が多く、豊かな倍音を生み出します。",commentEn:"Vibe: Combines the warmth of a 6 chord with the sparkle of an add9, creating a rich, gorgeous, and happy sound.\nUsage: A blissful sound often heard at the end of jazz piano pieces, also used in Fusion and AOR.\nTry: Use it as the final, ultimate chord of a song right before everything fades to silence for maximum euphoria.\nTheory: A luxurious chord adding both the 6th and 9th to a triad (R-3-5-6-9). Its many notes create rich overtones."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"add#11",commentJa:"Vibe: 現代的でドリーミーな、まさに「浮遊感」のあるサウンド。宇宙的な広がりと神秘的な美しさを感じさせます。\nUsage: ニューエイジ、アンビエント、現代ジャズで使われる、未来感のあるサウンド。映画音楽やゲーム音楽でも効果的です。\nTry: 静かな曲のエンディングや、間奏のアクセントとして使ってみましょう。聴き手を別世界に連れて行く効果があります。\nTheory: R-3-5に#11度（4度の半音上）を加えたコード。リディアンスケールとの相性が抜群です。",commentEn:'Vibe: A modern, dreamy sound that truly gives a "floating" feel. Evokes cosmic expansiveness and mystical beauty.\nUsage: A futuristic sound used in New Age, Ambient, and modern jazz. Also effective in film and game music.\nTry: Use it at the end of quiet songs or as accent chords in interludes. It has the effect of transporting listeners to another world.\nTheory: Adds a #11th (a semitone above the 4th) to R-3-5. It has an excellent compatibility with the Lydian scale.'},{tier:"Pro",categoryJa:"\uD83C\uDF03 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m9",commentJa:"Vibe: m7をさらにスムーズで洗練させた響き。大人の余裕と知的な魅力を感じさせます。\nUsage: ジャズ、フュージョン、AORの定番。特に都市的な雰囲気を演出したい時に威力を発揮します。\nTry: m7の代わりに使ってみましょう。サウンドがより洗練され、大人っぽい雰囲気になります。\nTheory: m7(R-b3-5-b7)に9度の音を追加したコード。ドリアンスケールとの相性が抜群です。",commentEn:"Vibe: An even smoother and more refined sound than m7. Evokes adult sophistication and intellectual charm.\nUsage: A staple in jazz, fusion, and AOR. Particularly effective when creating an urban atmosphere.\nTry: Use it instead of m7. The sound will become more refined and mature.\nTheory: Adds a 9th to an m7 chord (R-b3-5-b7-9). It has an excellent compatibility with the Dorian scale."},{tier:"Pro",categoryJa:"\uD83C\uDF03 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m11",commentJa:"Vibe: Lo-fi Hip HopやR&Bで定番の、少しアンニュイなサウンド。都会の夜を思わせる大人の雰囲気です。\nUsage: 都市的な音楽、特にLo-fi、R&B、ネオソウルで多用される。落ち着いた夜の雰囲気を演出できます。\nTry: 静かな夜の曲や、大人の恋愛をテーマにした楽曲で使ってみましょう。深い感情を表現できます。\nTheory: m7に11度を加えたコード。エオリアンスケールとの相性が良く、複雑な感情を表現します。",commentEn:"Vibe: A standard sound in Lo-fi Hip Hop and R&B, with a slightly melancholic vibe. Evokes the atmosphere of urban nights.\nUsage: Frequently used in urban music, especially Lo-fi, R&B, and Neo-Soul. Can create a calm night atmosphere.\nTry: Use it in quiet night songs or songs about adult romance. It can express deep emotions.\nTheory: Adds an 11th to an m7 chord. It pairs well with the Aeolian scale and expresses complex emotions."},{tier:"Pro",categoryJa:"\uD83C\uDF03 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m7b5",commentJa:"Vibe: ジャズの王道コード。少し不安定で、解決への期待感が強い、知的で洗練された響きです。\nUsage: ジャズスタンダードのIIm7b5として頻繁に使われる。特にマイナーキーの楽曲で重要な役割を果たします。\nTry: Dm7b5-G7-Cmのような進行で使ってみましょう。クラシックなジャズの雰囲気が演出できます。\nTheory: R-b3-b5-b7の構成音。ロクリアンスケール上で発生し、強い解決感を生み出します。",commentEn:"Vibe: A classic jazz chord. Slightly unstable with a strong anticipation for resolution, creating an intellectual and refined sound.\nUsage: Frequently used as IIm7b5 in jazz standards. Plays an important role especially in minor key songs.\nTry: Use it in progressions like Dm7b5-G7-Cm to create a classic jazz atmosphere.\nTheory: Composed of R-b3-b5-b7. It occurs on the Locrian scale and creates a strong sense of resolution."},{tier:"Pro",categoryJa:"\uD83C\uDF03 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"mM7",commentJa:"Vibe: マイナーの暗さとメジャー7の明るさが混在した、複雑で魅力的な響き。矛盾が生み出す美しさがあります。\nUsage: ジャズ、フュージョン、映画音楽で使われる、大人のサウンド。特に神秘的な雰囲気を演出したい時に効果的です。\nTry: 静かなバラードや、少し暗めの楽曲で使ってみましょう。独特の魅力が生まれます。\nTheory: R-b3-5-7の構成音。ハーモニックマイナースケールの特徴的なコードです。",commentEn:"Vibe: A complex and attractive sound that mixes the darkness of minor with the brightness of major 7. The beauty of contradiction.\nUsage: An adult sound used in jazz, fusion, and film music. Particularly effective when creating a mysterious atmosphere.\nTry: Use it in quiet ballads or slightly dark songs. It creates a unique charm.\nTheory: Composed of R-b3-5-7. It's a characteristic chord of the Harmonic Minor scale."},{tier:"Pro",categoryJa:"\uD83C\uDF03 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m6",commentJa:"Vibe: m7よりも少し明るく、懐かしさを感じさせる響き。レトロな魅力と現代的な洗練さを併せ持ちます。\nUsage: ジャズ、ボサノヴァ、アンビエントで使われる。特に落ち着いた雰囲気を演出したい時に効果的です。\nTry: 静かな夜の曲や、大人の雰囲気の楽曲で使ってみましょう。深い余韻が生まれます。\nTheory: R-b3-5-6の構成音。ドリアンスケールとの相性が良く、安定感と動きのバランスが取れています。",commentEn:"Vibe: A slightly brighter sound than m7, evoking a sense of nostalgia. Combines retro charm with modern sophistication.\nUsage: Used in jazz, bossa nova, and ambient music. Particularly effective when creating a calm atmosphere.\nTry: Use it in quiet night songs or songs with an adult atmosphere. It creates a deep afterglow.\nTheory: Composed of R-b3-5-6. It pairs well with the Dorian scale and balances stability with movement."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7sus4",commentJa:"Vibe: V7の前に置くことで、解決感を劇的に高めるプロの技。緊張感と解決感のコントラストが美しいです。\nUsage: ジャズ、ファンク、ロックで使われる高度なテクニック。特にドラマチックな効果を演出したい時に威力を発揮します。\nTry: C-F-G7sus4-G7のような進行で使ってみましょう。解決感がより劇的になります。\nTheory: V7コードの3度を4度に置き換えたコード。sus4の浮遊感が解決への期待感を高めます。",commentEn:"Vibe: A pro technique that dramatically enhances the feeling of resolution when placed before a V7 chord. The contrast between tension and resolution is beautiful.\nUsage: An advanced technique used in jazz, funk, and rock. Particularly effective when creating dramatic effects.\nTry: Use it in progressions like C-F-G7sus4-G7. The resolution will become more dramatic.\nTheory: Replaces the 3rd of a V7 chord with a 4th. The floating feel of sus4 enhances anticipation for resolution."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"aug",commentJa:"Vibe: 不安定で、次のコードへ進む推進力が強い。緊張感と動きのエネルギーを感じさせます。\nUsage: ジャズ、クラシック、映画音楽で使われる。特に緊張感を高めたい時に効果的です。\nTry: C-Caug-Fのような進行で使ってみましょう。ベースラインが滑らかになり、プロっぽい響きになります。\nTheory: R-3-#5の構成音。増5度の音が強い緊張感を生み出し、解決への推進力を与えます。",commentEn:"Vibe: An unstable sound with a strong drive to move to the next chord. Evokes tension and dynamic energy.\nUsage: Used in jazz, classical, and film music. Particularly effective when increasing tension.\nTry: Use it in progressions like C-Caug-F. The bassline will become smoother and sound more professional.\nTheory: Composed of R-3-#5. The augmented 5th creates strong tension and provides drive toward resolution."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"dim7",commentJa:"Vibe: 経過コードとして非常に便利。緊張感を一気に高める、プロのテクニックです。\nUsage: ジャズ、クラシック、映画音楽で頻繁に使われる。コードとコードを滑らかに繋ぐのに最適です。\nTry: C-Bdim7-Cmのような進行で使ってみましょう。ベースラインが滑らかになり、プロっぽい響きになります。\nTheory: R-b3-b5-bb7の構成音。減7度の音が強い緊張感を生み出し、解決への期待感を高めます。",commentEn:"Vibe: Very useful as a passing chord to instantly increase tension. A professional technique.\nUsage: Frequently used in jazz, classical, and film music. Perfect for smoothly connecting chords.\nTry: Use it in progressions like C-Bdim7-Cm. The bassline will become smoother and sound more professional.\nTheory: Composed of R-b3-b5-bb7. The diminished 7th creates strong tension and enhances anticipation for resolution."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(#9)",commentJa:"Vibe: ブルージーでロックな緊張感。エネルギッシュで情熱的な響きが特徴です。\nUsage: ブルース、ロック、ファンクで多用される。特に激しい感情を表現したい時に効果的です。\nTry: C7(#9)-Fのような進行で使ってみましょう。ブルージーで情熱的な雰囲気が演出できます。\nTheory: R-3-5-b7-#9の構成音。#9度の音がブルージーな緊張感を生み出します。",commentEn:"Vibe: A bluesy and rock-oriented tension. Characterized by energetic and passionate sound.\nUsage: Frequently used in blues, rock, and funk. Particularly effective when expressing intense emotions.\nTry: Use it in progressions like C7(#9)-F. It can create a bluesy and passionate atmosphere.\nTheory: Composed of R-3-5-b7-#9. The #9th creates a bluesy tension."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(b9)",commentJa:"Vibe: ジャズで多用される強い緊張感。知的で洗練された響きが特徴です。\nUsage: ジャズスタンダードで頻繁に使われる。特にマイナーキーの楽曲で重要な役割を果たします。\nTry: Dm7b5-G7(b9)-Cmのような進行で使ってみましょう。クラシックなジャズの雰囲気が演出できます。\nTheory: R-3-5-b7-b9の構成音。b9度の音が強い緊張感を生み出し、解決への期待感を高めます。",commentEn:"Vibe: A strong tension frequently used in Jazz. Characterized by an intellectual and refined sound.\nUsage: Frequently used in jazz standards. Plays an important role especially in minor key songs.\nTry: Use it in progressions like Dm7b5-G7(b9)-Cm. It can create a classic jazz atmosphere.\nTheory: Composed of R-3-5-b7-b9. The b9th creates strong tension and enhances anticipation for resolution."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(#5)",commentJa:"Vibe: augと同じ。解決先を強く示す、エネルギッシュな響きです。\nUsage: ジャズ、ロック、ファンクで使われる。特に緊張感を高めたい時に効果的です。\nTry: C7(#5)-Fのような進行で使ってみましょう。解決感がより劇的になります。\nTheory: R-3-#5-b7の構成音。増5度の音が強い緊張感を生み出し、解決への推進力を与えます。",commentEn:"Vibe: Same as augmented. Strongly indicates the point of resolution with an energetic sound.\nUsage: Used in jazz, rock, and funk. Particularly effective when increasing tension.\nTry: Use it in progressions like C7(#5)-F. The resolution will become more dramatic.\nTheory: Composed of R-3-#5-b7. The augmented 5th creates strong tension and provides drive toward resolution."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(b13)",commentJa:"Vibe: 複雑でムーディーな緊張感。深みのある感情を表現するのに最適です。\nUsage: ジャズ、フュージョン、映画音楽で使われる。特に複雑な感情を表現したい時に効果的です。\nTry: C7(b13)-Fのような進行で使ってみましょう。深い余韻が生まれます。\nTheory: R-3-5-b7-b13の構成音。b13度の音が複雑な緊張感を生み出します。",commentEn:"Vibe: A complex and moody tension. Perfect for expressing deep emotions.\nUsage: Used in jazz, fusion, and film music. Particularly effective when expressing complex emotions.\nTry: Use it in progressions like C7(b13)-F. It creates a deep afterglow.\nTheory: Composed of R-3-5-b7-b13. The b13th creates a complex tension."}],$=e=>X.find(t=>t.quality===e),ee=(e,t)=>{let a=$(e);return a?"ja"===t?a.commentJa:a.commentEn:""},et=e=>{let t=X.filter(t=>t.tier===e),a={};return t.forEach(e=>{a[e.categoryJa]||(a[e.categoryJa]=[]),a[e.categoryJa].push(e)}),a};function ea(e){let{title:t,body:a,isOpen:s,onClose:o}=e;if(!s)return null;let r=(e=>{let t=e.split("\n"),a=[],n="",s="";for(let e of t){let t=e.trim();if(t.includes(":")&&(t.startsWith("Vibe:")||t.startsWith("Usage:")||t.startsWith("Try:")||t.startsWith("Theory:"))){n&&s&&a.push({title:n,content:s.trim()});let e=t.indexOf(":");n=t.substring(0,e),s=t.substring(e+1).trim()}else t&&(s?s+="\n"+e:s=e)}return n&&s&&a.push({title:n,content:s.trim()}),a})(a);return(0,n.jsx)("div",{className:"fixed inset-0 z-50",onClick:o,children:(0,n.jsx)("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 w-80 max-h-[60vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:t}),(0,n.jsx)("button",{onClick:o,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,n.jsx)("div",{className:"p-3 overflow-y-auto max-h-[50vh]",children:r.length>0?(0,n.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,n.jsxs)("div",{className:"space-y-[3px]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{className:"text-orange-500 font-bold text-[11px]",children:"•"}),(0,n.jsx)("h4",{className:"font-extrabold text-orange-500 text-[13px]",children:e.title})]}),(0,n.jsx)("p",{className:"text-gray-700 dark:text-gray-300 text-xs leading-relaxed pl-4",children:e.content})]},t))}):(0,n.jsx)("p",{className:"text-gray-700 dark:text-gray-300 text-xs",children:a})})]})})})}let en=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],es=()=>(0,n.jsx)("span",{className:"absolute -top-1 -right-1 text-[10px]",title:"Pro専用",children:"\uD83D\uDC51"});function eo(e){let{plan:t="free",onConfirm:a,onBlock:o,onPreview:r}=e;console.log("[debug] plan in ChordBuilder:",t),console.log("[debug] Slash On buttons should be disabled for plan:",t);let i=(0,s.useMemo)(()=>({root:"C",family:"maj",seventh:"none",extMode:"add",ext:{},alt:{},sus:null,slash:null}),[]),[l,c]=(0,s.useState)(i),d={...K,plan:t},u=window.location.pathname.startsWith("/ja")?"ja":"en",[m,h]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),{spec:y,warnings:x}=(0,s.useMemo)(()=>(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=JSON.parse(JSON.stringify(e)),s=[];return"dom"===n.family&&(n.seventh="7"),"free"===t.plan&&("tension"===n.extMode&&(n.ext={nine:!1,eleven:!1,thirteen:!1}),n.alt={},n.slash&&(n.slash=null)),"add"===n.extMode?n.ext.nine=n.ext.eleven=n.ext.thirteen=!1:n.ext.add9=n.ext.add11=n.ext.add13=!1,n.ext.thirteen&&(n.ext.nine=!0),"sus2"===n.sus&&"sus4"===e.sus&&(n.sus="sus4"),"sus4"===n.sus&&"sus2"===e.sus&&(n.sus="sus2"),n.ext.eleven&&("maj"===n.family&&(a.autoCorrect11th?(n.ext.eleven=!1,n.alt?n.alt.sharpEleven=!0:n.alt={sharpEleven:!0},s.push("11 → #11 に自動調整しました（メジャーではavoid音のため）。")):s.push("メジャーでの11は3度と濁ります。#11（Lydian）を検討してください。")),"dom"===n.family&&(a.autoCorrect11th?(n.ext.eleven=!1,n.alt?n.alt.sharpEleven=!0:n.alt={sharpEleven:!0},s.push("11 → #11 に自動調整しました（ドミナントでは3度と衝突するため）。")):s.push("ドミナントでの11は3度と衝突します。#11 または sus4 を検討してください。"))),"dom"!==n.family&&(n.alt={}),"maj7"===n.seventh&&n.sus&&(s.push("maj7 with sus is uncommon; use sus4(maj7) in advanced mode."),n.sus=null),"tension"!==n.extMode||["7","maj7","m7"].includes(n.seventh)||(n.ext={nine:!1,eleven:!1,thirteen:!1}),{spec:n,warnings:s}})(l,d),[l,d]),f=(0,s.useMemo)(()=>(function(e,t){let a=[e.root],n="maj"===e.family?"":"min"===e.family?"m":"dom"===e.family?"":"sus"===e.family?"sus":"dim"===e.family?"dim":"aug"===e.family?"aug":"5";a.push(n);let s="maj7"===e.seventh?"compact"===t.notationStyle?"M7":"maj7":"7"===e.seventh?"7":"m7"===e.seventh?"m7":"6"===e.seventh?"6":"m7b5"===e.seventh?"m7b5":"dim7"===e.seventh?"dim7":"";if(a.push(s),"tension"===e.extMode)e.ext.thirteen?a.push("13"):e.ext.eleven?a.push("11"):e.ext.nine&&a.push("9");else{let t=[e.ext.add9&&"add9",e.ext.add11&&"add11",e.ext.add13&&"add13"].filter(Boolean);t.length&&a.push("(".concat(t.join(","),")"))}let o=[e.alt.b9&&"b9",e.alt.s9&&"#9",e.alt.s11&&"#11",e.alt.b13&&"b13"].filter(Boolean).join("");return a.push(o),e.sus&&a.push(e.sus),e.slash&&a.push("/".concat(e.slash)),a.join("")})(y,d),[y,d]),b=e=>c(t=>({...t,root:e}));(0,s.useEffect)(()=>{!m&&y.ext.eleven&&("maj"===y.family||"dom"===y.family)&&h(!0)},[y.ext.eleven,y.family,m]);let v=e=>e?"none"===e.seventh&&"add"===e.extMode&&e.ext.add9?"add9":"none"===e.seventh&&"add"===e.extMode&&e.ext.add11?"add#11":"sus4"===e.sus?"sus4":"sus2"===e.sus?"sus2":"maj"===e.family&&"none"===e.seventh?"M":"min"===e.family&&"none"===e.seventh?"m":"maj"===e.family&&"maj7"===e.seventh?"M7":"min"===e.family&&"m7"===e.seventh?"m7":"dom"===e.family&&"7"===e.seventh?"7":"dim"===e.family&&"none"===e.seventh?"dim":"aug"===e.family&&"none"===e.seventh?"aug":"maj"===e.family&&"maj7"===e.seventh&&e.ext.add9?"M9":"min"===e.family&&"m7"===e.seventh&&e.ext.add9?"m9":"min"===e.family&&"m7"===e.seventh&&e.ext.add9&&e.ext.add11?"m11":"min"===e.family&&"m7b5"===e.seventh?"m7b5":"min"===e.family&&"maj7"===e.seventh?"mM7":"min"===e.family&&"6"===e.seventh?"m6":"maj"===e.family&&"6"===e.seventh?"6":"maj"===e.family&&"6"===e.seventh&&e.ext.add9?"6/9":"dom"===e.family&&"7"===e.seventh&&"sus4"===e.sus?"7sus4":"dim"===e.family&&"dim7"===e.seventh?"dim7":"dom"===e.family&&"7"===e.seventh&&e.alt.s9?"7(#9)":"dom"===e.family&&"7"===e.seventh&&e.alt.b9?"7(b9)":"dom"===e.family&&"7"===e.seventh&&e.alt.s11?"7(#5)":"dom"===e.family&&"7"===e.seventh&&e.alt.b13?"7(b13)":"":"",j=(0,s.useMemo)(()=>{console.log("\uD83D\uDD0D ChordBuilder: Creating quality presets...");let e=et("Free"),a=et("Pro");console.log("\uD83D\uDD0D Free qualities:",e),console.log("\uD83D\uDD0D Pro qualities:",a),console.log("\uD83D\uDD0D Total qualities in QUALITY_MASTER:",X.length);let n=[];return Object.entries(e).forEach(e=>{let[t,a]=e;a.forEach(e=>{let a="m (minor)"===e.quality?"m":"Major"===e.quality?"M":"maj7"===e.quality?"M7":e.quality;n.push({label:a,apply:()=>{let t=w(e.quality);t&&c(t)},pro:!1,comment:ee(e.quality,u),category:t})})}),Object.entries(a).forEach(e=>{let[a,s]=e;s.forEach(e=>{let s="M9 (maj9)"===e.quality?"M9":"m7b5"===e.quality?"m7b5":"mM7"===e.quality?"mM7":"m6"===e.quality?"m6":"7(#9)"===e.quality?"7(#9)":"7(b9)"===e.quality?"7(b9)":"7(#5)"===e.quality?"7(#5)":"7(b13)"===e.quality?"7(b13)":e.quality;n.push({label:s,apply:()=>{if("free"===t){null==o||o("pro_quality",e.quality);return}let a=w(e.quality);a&&c(a)},pro:!0,comment:ee(e.quality,u),category:a})})}),console.log("\uD83D\uDD0D Final presets count:",n.length,"Free count:",n.filter(e=>!e.pro).length,"Pro count:",n.filter(e=>e.pro).length),n},[c,t,o]),w=e=>{let t={ext:{},alt:{},sus:null,slash:null};switch(e){case"Major":return{...t,root:"C",family:"maj",seventh:"none",extMode:"add"};case"m (minor)":return{...t,root:"C",family:"min",seventh:"none",extMode:"add"};case"7":return{...t,root:"C",family:"dom",seventh:"7",extMode:"tension"};case"maj7":return{...t,root:"C",family:"maj",seventh:"maj7",extMode:"add"};case"m7":return{...t,root:"C",family:"min",seventh:"m7",extMode:"add"};case"sus4":return{...t,root:"C",family:"maj",seventh:"none",sus:"sus4",extMode:"add"};case"sus2":return{...t,root:"C",family:"maj",seventh:"none",sus:"sus2",extMode:"add"};case"add9":return{...t,root:"C",family:"maj",seventh:"none",extMode:"add",ext:{add9:!0}};case"dim":return{...t,root:"C",family:"dim",seventh:"none",extMode:"add"};case"M9 (maj9)":return{...t,root:"C",family:"maj",seventh:"maj7",extMode:"add",ext:{add9:!0}};case"6":return{...t,root:"C",family:"maj",seventh:"6",extMode:"add"};case"6/9":return{...t,root:"C",family:"maj",seventh:"6",extMode:"add",ext:{add9:!0}};case"add#11":return{...t,root:"C",family:"maj",seventh:"none",extMode:"add",ext:{add11:!0},alt:{s11:!0}};case"m9":return{...t,root:"C",family:"min",seventh:"m7",extMode:"add",ext:{add9:!0}};case"m11":return{...t,root:"C",family:"min",seventh:"m7",extMode:"add",ext:{add9:!0,add11:!0}};case"m7b5":return{...t,root:"C",family:"min",seventh:"m7b5",extMode:"add"};case"mM7":return{...t,root:"C",family:"min",seventh:"maj7",extMode:"add"};case"m6":return{...t,root:"C",family:"min",seventh:"6",extMode:"add"};case"7sus4":return{...t,root:"C",family:"dom",seventh:"7",sus:"sus4",extMode:"tension"};case"aug":return{...t,root:"C",family:"aug",seventh:"none",extMode:"add"};case"dim7":return{...t,root:"C",family:"dim",seventh:"dim7",extMode:"add"};case"7(#9)":return{...t,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{s9:!0}};case"7(b9)":return{...t,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{b9:!0}};case"7(#5)":return{...t,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{s11:!0}};case"7(b13)":return{...t,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{b13:!0}};default:return null}},k=(e,a,s,o)=>(0,n.jsxs)("div",{className:"relative inline-block",children:[(0,n.jsxs)("button",{className:"h-9 px-3 rounded border text-xs transition-all flex items-center gap-2 ".concat(a?"bg-[var(--brand-primary)] text-white":(null==o?void 0:o.locked)?"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 border-gray-300 dark:border-gray-600 cursor-not-allowed hover:bg-gray-300 dark:hover:bg-gray-600":"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"),onClick:()=>{(null==o?void 0:o.disabled)||(null==o?void 0:o.locked)?(null==o?void 0:o.locked)&&window.open("https://www.ototheory.com/ios-coming-soon","_blank"):s()},title:(null==o?void 0:o.locked)?"Try Pro features on iOS!":void 0,"aria-disabled":(null==o?void 0:o.disabled)||(null==o?void 0:o.locked),children:[(0,n.jsx)("span",{children:e}),(null==o?void 0:o.comment)&&(0,n.jsx)("span",{className:"text-yellow-500 hover:text-yellow-600 transition-colors cursor-pointer",onClick:t=>{t.stopPropagation(),g({title:e,body:o.comment})},title:"Show quality info",children:(0,n.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 0 1 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"})})})]}),(null==o?void 0:o.showProBadge)&&"free"===t&&(0,n.jsx)(es,{})]},e);return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs opacity-70 mb-0.5",children:"ja"===u?"ルート":"Root"}),(0,n.jsx)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:en.map(e=>k(e,y.root===e,()=>b(e)))})]}),(()=>{let e=j.filter(e=>!e.pro);return j.filter(e=>e.pro),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-xs opacity-70 mb-0.5",children:["ja"===u?"コードタイプ":"Quality"," (",e.length," types)"]}),(0,n.jsx)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:e.map(e=>{let t=(l?v(l):null)===e.label;return(0,n.jsx)("div",{className:"relative",children:k(e.label,t,e.apply,{locked:!1,showProBadge:!1,comment:e.comment})},e.label)})})]})})(),(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{className:"cursor-pointer text-sm",children:"Advanced (Pro) \uD83D\uDC51"}),(0,n.jsxs)("div",{className:"mt-3 space-y-3",children:[(()=>{let e=et("Pro");return["✨ Sparkle & Float","\uD83C\uDF03 Stylish & Urban","⚡️ Tension & Spice"].map(a=>{let s=e["✨ Sparkle & Float"===a?"✨ キラキラ・浮遊感":"\uD83C\uDF03 Stylish & Urban"===a?"\uD83C\uDF03 おしゃれ・都会的":"⚡️ Tension & Spice"===a?"⚡️ 緊張感・スパイス":a];return s?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs opacity-70 mb-0.5",children:a}),(0,n.jsx)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:s.map(e=>{let a="M9 (maj9)"===e.quality?"M9":"m7b5"===e.quality?"m7b5":"mM7"===e.quality?"mM7":"m6"===e.quality?"m6":"7(#9)"===e.quality?"7(#9)":"7(b9)"===e.quality?"7(b9)":"7(#5)"===e.quality?"7(#5)":"7(b13)"===e.quality?"7(b13)":e.quality;return(0,n.jsx)("div",{className:"relative",children:k(a,!1,()=>{console.log("Pro quality clicked:",e.quality,"Plan:",t)},{comment:e.commentJa,locked:!0,showProBadge:!1})},e.quality)})})]},a):null})})(),(0,n.jsxs)("div",{className:"mt-3",children:[(0,n.jsx)("div",{className:"text-xs opacity-70 mb-0.5",children:"Slash (On)"}),(0,n.jsxs)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:[(0,n.jsx)("button",{className:"h-9 px-3 rounded border text-xs ".concat("free"===t?"bg-gray-400 text-gray-200 cursor-not-allowed opacity-60":"bg-orange-500 text-white hover:bg-orange-600"),onClick:()=>{if("free"===t){window.open("https://www.ototheory.com/ios-coming-soon","_blank");return}c({...l,slash:void 0})},disabled:"free"===t,title:"free"===t?"Try Pro features on iOS!":void 0,children:"Clear"}),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].map(e=>(0,n.jsx)("button",{className:"h-9 px-3 rounded border text-xs ".concat("free"===t?"bg-gray-400 text-gray-200 cursor-not-allowed opacity-60":(null==l?void 0:l.slash)===e?"bg-[var(--brand-primary)] text-white":"bg-gray-600 text-white hover:bg-gray-500"),onClick:()=>{if("free"===t){window.open("https://www.ototheory.com/ios-coming-soon","_blank");return}c({...l,slash:e})},disabled:"free"===t,title:"free"===t?"Try Pro features on iOS!":void 0,children:e},e))]})]})]})]}),"free"===t&&(0,n.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 text-center",children:[(0,n.jsx)("div",{className:"text-sm font-medium mb-2",children:"\uD83D\uDCF1 Try Pro features on iOS!"}),(0,n.jsx)("div",{className:"text-xs opacity-70 mb-3",children:"Advanced chord qualities and Slash features are available in the iOS Pro version."}),(0,n.jsx)("button",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",onClick:()=>{window.open("https://www.ototheory.com/ios-coming-soon","_blank")},children:"Try iOS Version"})]}),x.length>0&&(0,n.jsx)("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:x[0]}),(0,n.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ja"===u?"プレビュー":"Preview"}),(0,n.jsx)("div",{className:"text-xl font-bold text-gray-900 dark:text-white bg-white dark:bg-gray-700 px-3 py-1 rounded border",children:f||"Select a chord"})]}),(0,n.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,n.jsxs)("button",{className:"flex items-center gap-1 rounded-lg bg-green-500 hover:bg-green-600 text-white px-4 py-2 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>null==r?void 0:r(f),disabled:!f,children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{d:"M8 5v10l8-5-8-5z"})}),"Play"]}),(0,n.jsx)("button",{className:"rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>c(i),children:"Clear"}),(0,n.jsx)("button",{className:"rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-2 text-sm font-medium transition-all transform hover:scale-105",onClick:()=>{let e=!!y.slash,n="";y.ext.thirteen?n="13":y.alt.b9?n="7b9":y.alt.s9?n="7#9":y.alt.s11?n="7#11":y.alt.b13?n="7b13":y.alt.alt&&(n="7alt"),function(e,t){let{isPro:a,hasSlash:n}=t;return!!a||!n&&!Q.has(e)}(n,{isPro:"pro"===t,hasSlash:e})?null==a||a(f,y):e?null==o||o("pro_slash"):null==o||o("pro_quality",n)},children:"Add"})]})]}),p&&(0,n.jsx)(ea,{title:p.title,body:p.body,isOpen:!0,onClose:()=>g(null)})]})}function er(){let e=(0,Z.p)(),t=(0,Y.usePathname)(),a=(0,Y.useSearchParams)(),u=t.startsWith("/ja"),m=(0,s.useRef)(null);(0,r.H)(m,{orientation:"horizontal"});let h=(0,s.useRef)(null);(0,r.H)(h,{orientation:"horizontal"});let p=(0,s.useRef)(null);(0,r.H)(p,{orientation:"horizontal"});let g=(0,s.useRef)(null),E=(0,s.useRef)(null),[A,D]=(0,s.useState)(()=>{let e=Array(12).fill("");return e[0]="C",e[1]="Am",e[2]="F",e[3]="G",e}),R=(0,s.useMemo)(()=>A.reduce((e,t,a)=>(t&&e.push(a),e),[]),[A]),_=(0,s.useMemo)(()=>R.map(e=>A[e]),[R,A]),z=(0,s.useMemo)(()=>{let e=A.findIndex(e=>!e);return -1===e?11:e},[A]),[B,J]=(0,s.useState)(0);(0,s.useEffect)(()=>{J(z)},[z]),(0,s.useMemo)(()=>["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],[]),(0,s.useMemo)(()=>[{label:"M",value:""},{label:"M7",value:"maj7"},{label:"7",value:"7"},{label:"6",value:"6"},{label:"add9",value:"add9"},{label:"sus4",value:"sus4"},{label:"sus2",value:"sus2"},{label:"m",value:"m"},{label:"m7",value:"m7"},{label:"dim",value:"dim"},{label:"m7b5",value:"m7b5"},{label:"aug",value:"aug"}],[]);let[W,H]=(0,s.useState)("C"),[K,Q]=(0,s.useState)("M"),[X,$]=(0,s.useState)([]);(0,s.useMemo)(()=>[{label:"sus2",value:"sus2"},{label:"sus4",value:"sus4"},{label:"add9",value:"add9"},{label:"add11",value:"add11"},{label:"add13",value:"add13"}],[]);let[ee,et]=(0,s.useState)([]),[ea,en]=(0,s.useState)(""),[es,er]=(0,s.useState)(null),[ei,el]=(0,s.useState)([]),[ec,ed]=(0,s.useState)([]),[eu,em]=(0,s.useState)(null),[eh,ep]=(0,s.useState)([]),{keyCandidates:eg,selectedKey:ey,analyze:ex,selectKey:ef,scaleCandidates:eb,selectedScale:ev,selectScale:ej,reset:ew}=(0,x._)(),[ek,eI]=(0,s.useState)("degrees"),[eN,eC]=(0,s.useState)(null),[eS,eV]=(0,s.useState)(null),[eT,eM]=(0,s.useState)(null),[eP,eE]=(0,s.useState)(null),eA=(0,s.useCallback)(()=>{eM(null),eE(null)},[]),eD=e=>({Ionian:"major",Aeolian:"naturalMinor",Dorian:"dorian",Phrygian:"phrygian",Lydian:"lydian",Mixolydian:"mixolydian",Locrian:"locrian",MajorPentatonic:"majPent",MinorPentatonic:"minPent",Blues:"bluesMinor",HarmonicMinor:"harmonicMinor",MelodicMinor:"melodicMinor",DiminishedWH:"dimWholeHalf",DiminishedHW:"dimHalfWhole",Lydianb7:"lydianb7",Mixolydianb6:"mixolydianb6",PhrygianDominant:"phrygDominant",Altered:"altered",WholeTone:"wholeTone"})[e]||"major",eR=(0,s.useMemo)(()=>{let e=null==ev?void 0:ev.type,t=e?c.vb[e]:null;return!t||7===t.length},[null==ev?void 0:ev.type]);(0,s.useEffect)(()=>{eR||"degrees"===ek||eI("degrees")},[eR]);let[eq,eU]=(0,s.useState)(null),e_=(0,s.useRef)(null),ez=(0,s.useRef)(null),eF=(0,s.useRef)(null),eB=(0,s.useRef)(null),[eJ,eO]=(0,s.useState)(null),eL=(0,s.useRef)(null);(0,s.useRef)(null);let[eW,eH]=(0,s.useState)(!1),[eG,eZ]=(0,s.useState)(120),eY=(0,s.useRef)(null),[eK,eQ]=(0,s.useState)(-1),eX=(0,s.useCallback)((e,t)=>{D(a=>{if(e===t)return a;let n=a.slice(),s=n[e];return n[e]=n[t],n[t]=s,n})},[]),[e$,e0]=(0,s.useState)(null),e1=(0,s.useCallback)((e,t)=>{if(!A[t])return;e.stopPropagation();let a=e.touches[0];eL.current={index:t,startX:a.clientX,startY:a.clientY},eO(t),e0(null)},[A]),e7=(0,s.useCallback)((e,t)=>{if(null===eL.current||null===eJ)return;let a=e.touches[0],n=document.elementFromPoint(a.clientX,a.clientY);for(;n&&!n.hasAttribute("data-slot-index");)n=n.parentElement;if(n){let e=parseInt(n.getAttribute("data-slot-index")||"-1");e>=0&&e!==eJ&&e0(e)}},[eJ]),e2=(0,s.useCallback)(e=>{null!==eL.current&&null!==eJ&&null!==e$&&eJ!==e$&&eX(eJ,e$),eL.current=null,eO(null),e0(null)},[eJ,e$,eX]),e5=(0,s.useRef)(!1),e3=(0,s.useCallback)(()=>{e5.current=!1,eY.current&&(clearInterval(eY.current),eY.current=null),eH(!1),eQ(-1)},[]),e4=(0,s.useCallback)(async()=>{let e=A.map((e,t)=>({chord:e,index:t})).filter(e=>e.chord);if(0===e.length)return;e3(),await P.h.resume(),e5.current=!0,eH(!0),eQ(0);let t=60/eG*1e3;for(let e=0;e<4;e++){if(!e5.current||(await new Promise(e=>setTimeout(e,t)),!e5.current))return;P.h.playNote(84,100)}let a=0,n=0,s=async()=>{if(!e5.current){eY.current&&(clearInterval(eY.current),eY.current=null);return}if(n%4==0){a>=e.length&&(a=0);let{chord:t,index:n}=e[a];eQ(n),await tX(t),a++}else if(a>0&&a<=e.length){let{chord:t}=e[a-1];await tX(t)}n++};e5.current&&(await s(),e5.current&&(eY.current=setInterval(s,t),(0,q.j)("progression_play",{page:"chord_progression",bpm:eG,chordCount:e.length})))},[A,eG,e3]),e9=(0,s.useCallback)(()=>{eW?e3():e4()},[eW,e4,e3]);(0,s.useEffect)(()=>()=>{eY.current&&clearInterval(eY.current)},[]),(0,s.useEffect)(()=>{eW&&e3()},[A]);let e6=(0,s.useCallback)(e=>{D(t=>{let a=t.slice();return a[e]="",a})},[]),{isPro:e8}=(0,N.Z)();console.log("[debug] isPro in page:",e8);let{sketch:te,setSketch:tt}=U(e8),ta=(0,s.useRef)(null),tn=()=>(ta.current||(ta.current=Math.random().toString(36).slice(2,10)),ta.current),{sketches:ts,loadSketches:to,deleteSketch:tr,saveSketch:ti}=F(),[tl,tc]=(0,s.useState)(!1),[td,tu]=(0,s.useState)(null),tm=(0,s.useRef)(null),[th,tp]=(0,s.useState)(""),[tg,ty]=(0,s.useState)(!1),[tx,tf]=(0,s.useState)("C"),tb=(0,s.useRef)(null);(0,s.useEffect)(()=>{tl&&to()},[tl,to]),(0,s.useEffect)(()=>{let e=e=>{if(!tl)return;let t=tm.current;t&&!t.contains(e.target)&&tc(!1)},t=e=>{"Escape"===e.key&&tc(!1)};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[tl]),(0,s.useEffect)(()=>{if(!tg)return;let e=e=>{let t=tb.current;t&&!t.contains(e.target)&&ty(!1)},t=e=>{"Escape"===e.key&&ty(!1)};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[tg]);let[tv,tj]=(0,s.useState)(!1),[tw,tk]=(0,s.useState)(""),tI=(0,s.useMemo)(()=>_.length?_.join(" "):"Untitled ".concat(new Date().toLocaleString()),[_]),[tN,tC]=(0,s.useState)(null),tS=(0,s.useRef)(new Set);(0,s.useEffect)(()=>{let t=A.filter(e=>""!==e).length;9!==t||tS.current.has("limit_warn")?12!==t||tS.current.has("limit_block")||(tC({message:e.toast.limitBlock,type:"warning",ctaText:e.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"limit_toast"}),(0,q.EP)("limit_block",{page:"chord_progression",chordCount:t}),tS.current.add("limit_block")):(tC({message:e.toast.limitWarn,type:"info",ctaText:e.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"limit_toast"}),(0,q.EP)("limit_warn",{page:"chord_progression",chordCount:t}),tS.current.add("limit_warn"))},[A]);let[tV,tT]=(0,s.useState)(""),tM=async t=>{try{if(!E.current)return;tT(t.name||"Untitled Sketch"),await new Promise(e=>setTimeout(e,50));let a=E.current;a.style.opacity="1",a.style.visibility="visible",await new Promise(e=>setTimeout(e,200)),await O(a,"auto"),a.style.opacity="0.0001",a.style.visibility="hidden",tT(""),(0,q.j)("export_png",{page:"chord_progression",source:"sketch",id:t.id}),tS.current.has("png_export")||(tC({message:e.toast.pngExport,type:"success",ctaText:e.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"png_toast"}),tS.current.add("png_export"))}catch(e){console.error("Export failed:",e),tT("")}},tP=async()=>{try{if(!e8){let t=JSON.parse(localStorage.getItem("ot_sketches")||"[]");if(console.log("[DEBUG] doSaveSketch - isPro:",e8,"existing sketches:",t.length),t.length>=3){console.log("[DEBUG] Blocking save - limit reached"),tj(!1),tk(""),tC({message:e.toast.sketchLimit,type:"warning",ctaText:e.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"limit_toast"}),(0,q.EP)("limit_block",{page:"chord_progression",context:"sketch_limit"});return}}console.log("[DEBUG] Proceeding with save");let t=ey?l.T_[ey.tonic]:eq?eq.tonic:"C",a=(null==ev?void 0:ev.type)||(ey?ey.mode:"Ionian"),n={name:(tw.trim()||tI).slice(0,48),schema:"sketch_v1",appVersion:"3.0.0",key:{tonic:t,scaleId:String(a)},capo:{fret:0,note:"Shaped"},progression:{items:_.map((e,t)=>({id:e,degree:"",quality:""}))},fretboardView:{mode:"names"===ek?"Names":"Degrees",guide:!!eS}},s=await ti(n);(0,q.j)("save_project",{page:"chord_progression",ok:null==s?void 0:s.ok}),tj(!1),tk("")}catch(e){}},[tE,tA]=(0,s.useState)(!1),[tD,tR]=(0,s.useState)(!1),[tq,tU]=(0,s.useState)(!1),[t_,tz]=(0,s.useTransition)(),[tF,tB]=(0,s.useState)([]),[tJ,tO]=(0,s.useState)([]),[tL,tW]=(0,s.useState)(null),tH=(0,s.useRef)(null),tG=e=>e.map(e=>{let t=e.match(/^([A-G](?:#|b)?)(.*)$/);return{root:(null==t?void 0:t[1])||e,quality:(null==t?void 0:t[2])||""}}),tZ=(e,t,a)=>{let n=(0,l.Hl)(a);if(void 0===n||n<0||n>11)return;let s=t.map(e=>(0,l.O9)(e,n,"Major"));D(e=>{let t=[...e],a=t.findIndex(e=>!e);return -1===a&&(a=0),s.forEach((e,n)=>{t[(a+n)%12]=e}),t}),J(e=>{let t=[...A];s.forEach((e,a)=>{let n=t.findIndex(e=>!e);if(-1===n)return 0;t[(n+a)%12]=e});let a=t.findIndex(e=>!e);return -1===a?0:a}),(0,q.j)("preset_inserted",{page:"chord_progression",preset:e}),ty(!1)};(0,s.useEffect)(()=>{let e=ey||eq;if(!e)return;let t="number"==typeof e.tonic?l.T_[e.tonic]:e.tonic,a="Major"===e.mode||"Minor"===e.mode?"Major"===e.mode?"major":"minor":e.mode;ep(_.map(e=>y(e,t,a,{showQuality:!0,uppercase:!0})))},[ey,eq,_]),(0,s.useEffect)(()=>{if(!eq||0===eh.length){tB([]);return}eq.mode,tB(function(e,t){let a=e.map(M),n=[];for(let e of S){var s;for(let t of[e.seq,...null!==(s=e.variants)&&void 0!==s?s:[]].map(e=>e.map(M))){let s=t.length;for(let o=0;o+s<=a.length;o++){let r=!0;for(let e=0;e<s;e++)if(a[o+e]!==t[e]){r=!1;break}if(r){n.push({id:e.id,name:e.name,summary:e.summary,start:o,end:o+s});break}}}}return n.sort((e,t)=>t.end-t.start-(e.end-e.start)),function(e){let t=[];for(let a of e)t.some(e=>!(a.end<=e.start||e.end<=a.start))||t.push(a);return t}(n)}(eh,0))},[eh,eq]),(0,s.useEffect)(()=>{if(!eh||0===eh.length){tO([]);return}let e=eh.map(e=>{var t,a;let n=e.replace(/\s+/g,"").match(/^(b|#)?([ivIV]+)(?:[°ø].*)?/);if(!n)return e.toUpperCase();let s=null!==(t=n[1])&&void 0!==t?t:"",o=(null!==(a=n[2])&&void 0!==a?a:"").toUpperCase();return"".concat(s).concat(o)}),t=null;try{t=(0,l.W$)(e)}catch(e){}let a=(Array.isArray(t)?t:t?[t]:[]).map(e=>{var t,a;return"string"==typeof e?{type:e}:{type:null!==(t=null==e?void 0:e.type)&&void 0!==t?t:e,tail:null!==(a=null==e?void 0:e.tailRoman)&&void 0!==a?a:(null==e?void 0:e.pair)?{from:e.pair[0],to:e.pair[1]}:void 0}});if(e.length>=2){let t=e[e.length-1],n=e[0];a.some(e=>"perfect"===e.type)||"V"!==t||"I"!==n||a.push({type:"perfect",tail:{from:"V",to:"I"}}),a.some(e=>"deceptive"===e.type)||"V"!==t||"VI"!==n||a.push({type:"deceptive",tail:{from:"V",to:"vi"}})}tO(a)},[eh]);let tY=(0,s.useMemo)(()=>{if(!eh||0===eh.length)return null;let e=eh.map(e=>{var t,a;let n=e.replace(/\s+/g,"").match(/^(b|#)?([ivIV]+)(?:[°ø].*)?/);if(!n)return e.toUpperCase();let s=null!==(t=n[1])&&void 0!==t?t:"",o=(null!==(a=n[2])&&void 0!==a?a:"").toUpperCase();return"".concat(s).concat(o)});if(e.length<2)return null;let t=e[0],a=e[e.length-1];return"V"===a&&"I"===t?{type:"perfect",tail:{from:"V",to:"I"}}:"V"===a&&"VI"===t?{type:"deceptive",tail:{from:"V",to:"vi"}}:"V"===a?{type:"half",tail:{from:void 0,to:"V"}}:null},[eh]);(0,s.useEffect)(()=>{let e=()=>{if(!e_.current||!ez.current||!eF.current)return;if(!(window.matchMedia&&window.matchMedia("(min-width: 1024px)").matches)){ez.current.style.minHeight="0px";return}let e=ez.current.style.minHeight;ez.current.style.minHeight="0px",ez.current.offsetHeight;let t=e_.current.getBoundingClientRect().top+window.scrollY,a=Math.max(0,Math.ceil(Math.max(eB.current?eB.current.getBoundingClientRect().bottom+window.scrollY:0,eF.current.getBoundingClientRect().top+window.scrollY)-t));Math.abs(a-parseFloat(e||"0"))>1&&(ez.current.style.minHeight="".concat(a,"px"))};requestAnimationFrame(e);let t=setTimeout(e,120),a=null,n=()=>{a&&clearTimeout(a),a=setTimeout(e,120)};window.addEventListener("resize",n),window.addEventListener("orientationchange",n),window.addEventListener("load",e);let s=null,o=null;if("undefined"!=typeof ResizeObserver&&eB.current){let t=null;(s=new ResizeObserver(()=>{t&&clearTimeout(t),t=setTimeout(e,100)})).observe(eB.current)}if("undefined"!=typeof ResizeObserver&&eF.current){let t=null;(o=new ResizeObserver(()=>{t&&clearTimeout(t),t=setTimeout(e,100)})).observe(eF.current)}return()=>{clearTimeout(t),a&&clearTimeout(a),window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n),window.removeEventListener("load",e),s&&s.disconnect(),o&&o.disconnect()}},[]),(0,s.useEffect)(()=>{ez.current&&window.matchMedia&&window.matchMedia("(min-width: 1024px)").matches&&requestAnimationFrame(()=>{let e=new Event("resize");window.dispatchEvent(e)})},[es,tE,_.length]),"M"===K||"".concat(W).concat(K),X.length&&X.join(" "),(0,s.useEffect)(()=>{try{let e=tn(),t=_.length?_.join(" ").slice(0,48):"Untitled ".concat(new Date().toLocaleString()),a=ey?l.T_[ey.tonic]:eq?eq.tonic:"C",n=(null==ev?void 0:ev.type)||(ey?ey.mode:"Ionian");tt({id:e,name:t,createdAt:(null==te?void 0:te.createdAt)||new Date().toISOString(),updatedAt:new Date().toISOString(),schema:"sketch_v1",appVersion:"3.0.0",key:{tonic:a,scaleId:String(n)},capo:{fret:0,note:"Shaped"},progression:{items:_.map((e,t)=>({id:"".concat(t+1,"-").concat(e),degree:"",quality:""}))},fretboardView:{mode:"names"===ek?"Names":"Degrees",guide:!!eS}})}catch(e){}},[A,ek,eS,ey,eq,ev]);let[tK,tQ]=(0,s.useState)(!1);(0,s.useEffect)(()=>{try{var e,t;let a="ontouchstart"in window||(null!==(t=null===(e=navigator)||void 0===e?void 0:e.maxTouchPoints)&&void 0!==t?t:0)>0;tQ(!!a)}catch(e){tQ(!1)}},[]);let tX=async e=>{try{await P.h.resume();let t=(0,L.h)(e);t&&t.length>0&&P.h.playChord(t,"lightStrum",300)}catch(t){console.error("Failed to play chord:",e,t)}};return(0,n.jsxs)("main",{ref:g,className:"ot-page ot-stack","data-page":"find-key",children:[(0,n.jsxs)("section",{id:"progression",className:"ot-card",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(f,{className:"mb-0 text-left",children:u?"コード進行を作る":"Build progression"}),(0,n.jsx)(v.Z,{title:"Build Progression",text:u?"Choose Chordsからコードを選んでスロットに追加ボタンから追加してください。上部のプリセットからコード進行を選択して追加することもできます。":"Select chords from Choose Chords and add them using the slot add button. You can also select chord progressions from the presets at the top to add them."})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("button",{type:"button",className:"chip text-sm px-4 py-2 inline-flex items-center gap-2",title:"Reset progression",onClick:()=>{D(Array(12).fill("")),J(0),ew(),el([]),er(null),eV(null),eC(null),eI("degrees")},children:[(0,n.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{d:"M12 5V2L7 7l5 5V9c2.76 0 5 2.24 5 5a5 5 0 1 1-5-5z"})}),(0,n.jsx)("span",{children:u?"リセット":"Reset"})]}),(0,n.jsxs)("button",{type:"button",className:"chip inline-flex items-center gap-2 px-4 py-2",title:"Show sketches",onClick:()=>tc(e=>!e),"aria-expanded":tl,children:[(0,n.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{d:"M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h12v2H3v-2z"})}),u?"My進行":"Sketches"]}),tl&&(0,n.jsx)("div",{ref:tm,className:"fixed right-4 top-20 z-[10000] w-[320px] max-h-[70vh] overflow-auto rounded-md border bg-white dark:bg-neutral-900 shadow-2xl p-2 space-y-2",children:0===ts.length?(0,n.jsx)("div",{className:"text-xs opacity-70 p-2",children:u?"まだ進行がありません":"No sketches yet"}):ts.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 px-2 py-1 rounded hover:bg-black/5 dark:hover:bg-white/10",children:[(0,n.jsx)("button",{className:"text-left text-sm flex-1 truncate",title:"".concat(e.name),onClick:()=>tu(e),children:e.name}),(0,n.jsx)("button",{className:"ot-btn-ghost text-xs",title:"Delete",onClick:t=>{t.stopPropagation(),tr(e.id),to(),(0,q.j)("project_delete",{page:"chord_progression",id:e.id})},children:"\uD83D\uDDD1️"})]},e.id))}),(0,n.jsx)("div",{className:"w-4","aria-hidden":"true"}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("button",{type:"button",className:"chip px-4 py-2 inline-flex items-center gap-2",title:eW?"Stop playback":"Play progression",onClick:e9,disabled:0===_.length,style:{opacity:0===_.length?.5:1},children:eW?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,n.jsx)("rect",{x:"5",y:"5",width:"14",height:"14",rx:"1"})}),(0,n.jsx)("span",{children:u?"停止":"Stop"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,n.jsx)("path",{d:"M8 5v14l11-7z"})}),(0,n.jsx)("span",{children:u?"再生":"Play"})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{htmlFor:"bpm-input",className:"text-sm font-medium",children:"BPM:"}),(0,n.jsx)("input",{id:"bpm-input",type:"number",min:"40",max:"240",value:eG,onChange:e=>eZ(Math.max(40,Math.min(240,parseInt(e.target.value)||120))),className:"w-20 px-3 py-1 text-sm rounded-lg border bg-transparent",disabled:eW})]})]}),(0,n.jsxs)("select",{className:"chip px-4 py-2","aria-label":"Instrument",defaultValue:localStorage.getItem("ot-instrument")||"acoustic_guitar_steel",onChange:async e=>{let t=e.currentTarget.value;await P.h.setInstrument(t)},children:[(0,n.jsx)("option",{value:"acoustic_guitar_steel",children:u?"アコースティックギター":"Acoustic Steel"}),(0,n.jsx)("option",{value:"acoustic_guitar_nylon",children:u?"クラシックギター":"Acoustic Nylon"}),(0,n.jsx)("option",{value:"electric_guitar_clean",children:u?"クリーントーン（エレキ）":"Electric Clean"}),(0,n.jsx)("option",{value:"distortion_guitar",children:u?"ディストーション":"Distortion"}),(0,n.jsx)("option",{value:"overdriven_guitar",children:u?"オーバードライブ":"Over Drive"}),(0,n.jsx)("option",{value:"electric_guitar_muted",children:u?"ミュート":"Muted"}),(0,n.jsx)("option",{value:"acoustic_grand_piano",children:u?"ピアノ":"Piano"})]})]})]}),(0,n.jsx)("div",{className:"prog-slots mt-6 flex flex-wrap gap-3","aria-label":"Progression slots",children:Array.from({length:12}).map((e,t)=>{let a=!!A[t],s=t<8?0:(t-7)*.08,o="rgba(16,185,129,".concat(s.toFixed(2),")"),r=B===t,i=eK===t&&eW;return(0,n.jsxs)("div",{"data-slot-index":t,className:["inline-flex items-center justify-center rounded-xl border text-sm select-none relative chip-pressable",a?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700",r?"ring-2 ring-blue-400/60":"",i?"ring-4 ring-blue-500/80 shadow-lg":"",eJ===t?"opacity-50 scale-105":"",e$===t?"ring-2 ring-blue-400":""].join(" "),style:{padding:"12px 16px",minWidth:80,minHeight:48,background:a?void 0:o,transition:"all 0.2s ease",touchAction:a?"none":"auto"},onClick:()=>{a?tX(A[t]):J(t)},draggable:a,onDragStart:()=>eO(t),onDragOver:e=>e.preventDefault(),onDrop:()=>{null!==eJ&&(eX(eJ,t),eO(null))},onTouchStart:e=>e1(e,t),onTouchMove:e=>e7(e,t),onTouchEnd:e2,children:[(0,n.jsx)("span",{className:"absolute left-2 top-2 text-xs opacity-60 select-none pointer-events-none font-medium",children:String(t+1)}),a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:A[t]}),(0,n.jsx)("button",{"aria-label":"Remove chord",className:"absolute -top-1 -right-1 w-6 h-6 rounded-full bg-red-500 text-white text-xs leading-6 hover:bg-red-600 transition-colors",onClick:e=>{e.stopPropagation(),e6(t)},children:"\xd7"})]}):null]},"slot-".concat(t))})})]}),(0,n.jsxs)("section",{id:"choose",ref:eB,className:"ot-card",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(f,{className:"mb-0 text-left",children:u?"コードを選ぶ":"Choose chords"}),(0,n.jsx)(v.Z,{title:"Choose Chords",text:u?"ルートとコードタイプを選んでください。追加ボタンでコード進行のスロットに追加できます。\nProプランの場合、より複雑なコードタイプを選ぶことができます。":"Select a root note and chord type. Use the Add button to add to chord progression slots.\nPro plan allows you to select more complex chord types."})]}),(0,n.jsxs)("button",{type:"button",className:"chip px-4 py-2 inline-flex items-center gap-2",title:"Load preset progression",onClick:()=>ty(!0),children:[(0,n.jsx)("span",{children:"\uD83D\uDCCB"}),(0,n.jsx)("span",{children:u?"プリセット":"Presets"})]})]}),(0,n.jsx)(eo,{plan:(()=>{let e=a.get("plan");return"pro"===e||"free"===e?e:e8?"pro":"free"})(),onPreview:async e=>{try{await P.h.resume();let t=(0,L.h)(e);t&&P.h.playChord(t,"lightStrum",300)}catch(e){}},onBlock:(e,t)=>{"pro_quality"===e?alert("「".concat(t,"」はPro機能です。\n\niOS版のOtoTheoryアプリでPro機能をお試しください！\n\nApp Storeでダウンロードできます。")):"pro_slash"===e&&alert("Slash機能はPro機能です。\n\niOS版のOtoTheoryアプリでPro機能をお試しください！\n\nApp Storeでダウンロードできます。")},onConfirm:e=>{D(t=>{let a=[...t],n=a.findIndex(e=>!e);return -1===n&&(n=0),a[n]=e,a}),J(e=>{let t=[...A].findIndex(e=>!e);return -1===t?0:t}),tU(!0)}}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{className:"w-full px-6 py-3 text-base rounded-xl font-semibold text-white transition-all duration-200 active:scale-[.98] active:translate-y-px focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-300 ".concat(t_?"bg-gray-400 cursor-wait":"bg-blue-500 hover:bg-blue-600 shadow-lg"),onClick:()=>{if(tG(_).some(e=>I.some(t=>e.quality.includes(t)))&&!e8){window.alert("Advanced chords detected. Remove them or upgrade to Pro.");return}tz(()=>{er((0,k.w)(_));let e=(0,l.EZ)(_);if(el(e.slice(0,4)),e.length>0){let t="Major"===e[0].mode?"major":"minor",a={tonic:e[0].label.split(" ")[0],mode:t};eU(a),ep(_.map(e=>y(e,a.tonic,a.mode,{showQuality:!0,uppercase:!0})))}else ed([]),eU(null),ep([]);ex(_),setTimeout(()=>{let e=document.getElementById("result");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)})},disabled:t_,"aria-busy":t_,children:t_?(0,n.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,n.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 0 1 8-8v4a4 4 0 0 0-4 4H4z"})]}),"Analyzing…"]}):u?"分析":"Analyze"})})]}),(0,n.jsxs)("section",{id:"result",ref:eF,className:"ot-card",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)(f,{className:"text-left mb-0",children:u?"結果":"Result"}),(0,n.jsx)("div",{className:"flex items-center gap-3",children:(0,n.jsxs)("button",{type:"button",className:"chip px-4 py-2 inline-flex items-center gap-2",onClick:()=>tj(!0),title:"Save sketch",children:[(0,n.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{d:"M17 3H5a2 2 0 0 0-2 2v14l4-4h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"})}),u?"保存":"Save"]})})]}),tv&&(0,n.jsxs)("div",{className:"fixed inset-0 z-[10000]",role:"dialog","aria-modal":"true",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{tj(!1),tk("")}}),(0,n.jsxs)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-neutral-900 border rounded-lg shadow-xl p-4 w-[92vw] max-w-[420px]",children:[(0,n.jsx)("div",{className:"text-base font-semibold mb-2",children:u?"スケッチを保存":"Save sketch"}),(0,n.jsx)("input",{type:"text",className:"chip px-2 py-2 text-sm w-full",placeholder:tI,value:tw,onChange:e=>tk(e.target.value),"aria-label":"Sketch name",autoFocus:!0}),(0,n.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-2",children:[(0,n.jsx)("button",{type:"button",className:"chip-pressable inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm border",onClick:()=>{tj(!1),tk("")},children:u?"キャンセル":"Cancel"}),(0,n.jsx)("button",{type:"button",className:"chip-pressable inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm border",onClick:tP,children:"OK"})]})]})]}),td&&(0,n.jsxs)("div",{className:"fixed inset-0 z-[10001]",role:"dialog","aria-modal":"true",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>tu(null)}),(0,n.jsxs)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-neutral-900 border rounded-lg shadow-xl p-4 w-[92vw] max-w-[320px]",children:[(0,n.jsx)("div",{className:"text-base font-semibold mb-3",children:td.name}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("button",{type:"button",className:"w-full chip-pressable inline-flex items-center justify-center gap-1 px-4 py-2 rounded-lg text-sm border",onClick:()=>{try{var e,t;let a=Array(12).fill("");((null==td?void 0:null===(e=td.progression)||void 0===e?void 0:e.items)||[]).forEach((e,t)=>{t<12&&(a[t]=String((null==e?void 0:e.id)||""))}),D(a),J(-1===a.findIndex(e=>!e)?11:a.findIndex(e=>!e));try{ex(a.filter(Boolean))}catch(e){}let n=l.T_.indexOf(td.key.tonic);if(n>=0)try{null==ef||ef({tonic:n,mode:(null===(t=String(td.key.scaleId||""))||void 0===t?void 0:t.toLowerCase().includes("aeolian"))||String(td.key.scaleId||"").toLowerCase().includes("minor")?"Minor":"Major"})}catch(e){}(0,q.j)("open_project",{page:"chord_progression",id:td.id}),tc(!1),tu(null)}catch(e){}},children:u?"編集":"Edit"}),(0,n.jsx)("button",{type:"button",className:"w-full chip-pressable inline-flex items-center justify-center gap-1 px-4 py-2 rounded-lg text-sm border",onClick:async()=>{try{await tM(td),tu(null)}catch(e){}},children:u?"エクスポート":"Export"}),(0,n.jsx)("button",{type:"button",className:"w-full chip-pressable inline-flex items-center justify-center gap-1 px-4 py-2 rounded-lg text-sm border",onClick:()=>tu(null),children:u?"キャンセル":"Cancel"})]})]})]}),(0,n.jsx)("div",{ref:E,"aria-hidden":!0,style:{position:"fixed",left:0,top:0,zIndex:9999,opacity:1e-4,pointerEvents:"none",width:800,height:600,background:"#ffffff",color:"#000000",padding:24,borderRadius:12,border:"2px solid #cbd5e1",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:(()=>{let e=tV||((null==tw?void 0:tw.trim())?tw:tI),t=ey?"".concat(l.T_[ey.tonic]," ").concat(ey.mode):"-",a=_.join(" "),s=ev?(0,c.hg)(ev.type):"-",o=(()=>{var e;let t=ev?ev.root:void 0,a=ev&&"number"==typeof t?(0,c.p3)(t,ev.type).map(e=>l.T_[e]):[],s=eR?ek:"degrees",o=(()=>{let e=null==ev?void 0:ev.type;return e&&(e.toLowerCase().includes("aeolian")||e.toLowerCase().startsWith("min"))?"min":"maj"})();return(0,n.jsx)("div",{style:{marginTop:8,background:"#ffffff",border:"2px solid #cbd5e1",borderRadius:"8px",padding:"12px",width:"100%"},children:(0,n.jsx)(i.Z,{overlay:{viewMode:"sounding",capo:0,notes:a,chordNotes:null!=eS?eS:void 0,showScaleGhost:!!eS,display:s,scaleRootPc:"number"==typeof t?t:0,scaleType:null!==(e=null==ev?void 0:ev.type)&&void 0!==e?e:"Ionian",context:{chordRootPc:"number"==typeof t?t:0,quality:o}},onRequestForms:()=>{}})})})();return(0,n.jsxs)("div",{style:{background:"#ffffff",color:"#000000",fontFamily:"ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif",width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:"12px",padding:"8px"},children:[(0,n.jsx)("div",{style:{fontWeight:700,fontSize:24,color:"#000000",lineHeight:1.3},children:e}),(0,n.jsxs)("div",{style:{fontSize:18,color:"#000000",fontWeight:600},children:["Key: ",(0,n.jsx)("span",{style:{color:"#1e40af"},children:t})]}),(0,n.jsxs)("div",{style:{fontSize:16,color:"#000000",fontWeight:500},children:["Progression: ",(0,n.jsx)("span",{style:{color:"#1e40af"},children:a||"-"})]}),(0,n.jsxs)("div",{style:{fontSize:16,color:"#000000",fontWeight:500},children:["Scale: ",(0,n.jsx)("span",{style:{color:"#1e40af"},children:s})]}),(0,n.jsx)("div",{style:{flex:1,background:"#ffffff",border:"2px solid #cbd5e1",borderRadius:"8px",padding:"12px",overflow:"hidden"},children:o})]})})()}),eg.length>0?(0,n.jsxs)("div",{className:"space-y-4",children:[eg.length>0&&_.length<8&&(0,n.jsxs)("div",{className:"text-xs px-3 py-2 rounded-lg bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200",children:["⚠️ 精度向上のため、8コード以上の入力を推奨します（現在: ",_.length,"コード）"]}),(0,n.jsx)(b,{children:u?"キー":"Key"}),(0,n.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,n.jsx)("div",{className:"chip-row mb-2",role:"tablist","aria-label":"Key candidates",children:eg.map((e,t)=>{let a=ey&&ey.tonic===e.tonic&&ey.mode===e.mode,s="Major"===e.mode?l.T_[e.tonic]:"".concat(l.T_[e.tonic],"m"),o=e.reasons.join("\n");return(0,n.jsxs)("button",{role:"tab","aria-selected":a,className:["chip","chip--key",a?"chip--active":""].join(" "),title:"Why this key\n".concat(o),onClick:()=>ef({tonic:e.tonic,mode:e.mode}),"data-roving":"item",children:[s," ",Math.round(e.confidence),"%"]},"".concat(s,"-").concat(t))})})}),(0,n.jsxs)("div",{className:"result-block",children:[(0,n.jsx)(b,{children:u?"スケール":"Scale"}),(0,n.jsx)("div",{className:"chip-row mb-2",role:"tablist","aria-label":"Scale candidates",children:eb.map((e,t)=>{let a=(0,c.cm)(e.type),s=(null==ev?void 0:ev.type)===a&&(null==ev?void 0:ev.root)===e.root,o=eD(e.type),r=(0,j.qi)(o),i=window.location.pathname.startsWith("/ja/"),d="".concat(l.T_[e.root]," ").concat(r?(0,j.ED)(r,i?"ja":"en"):(0,c.hg)(a));return(0,n.jsxs)("div",{className:"relative inline-block",children:[(0,n.jsx)("button",{role:"tab","aria-selected":s,className:["chip","chip--key",s?"chip--active":"","flex items-center gap-2"].join(" "),onClick:t=>{t.stopPropagation(),ej(e),(0,q.j)("scale_pick",{page:"find-key",scale:e.type,key:l.T_[e.root]})},"data-roving":"item",children:(0,n.jsxs)("span",{children:[d," ",Math.round(e.score),"%"]})}),r&&(0,n.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,n.jsx)(v.Z,{title:(()=>{let e=window.location.pathname.startsWith("/ja/");return(0,j.ED)(r,e?"ja":"en")})(),placement:"top",trigger:(0,n.jsx)("button",{type:"button",className:"w-6 h-6 rounded-full bg-amber-50/90 hover:bg-amber-100 ring-1 ring-amber-300/60 shadow-sm flex items-center justify-center","aria-label":"Scale info",children:(0,n.jsx)("svg",{className:"w-4 h-4 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 0 1 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"})})}),children:(0,n.jsx)(w.Z,{scaleId:o})})})]},"".concat(d,"-").concat(t))})})]})]}):(0,n.jsx)("div",{className:"text-sm opacity-70",children:u?"分析をクリック":"Click Analyze to see results."})]}),(0,n.jsxs)("section",{className:"ot-card",children:[(0,n.jsx)(f,{children:u?"ツール":"Tools"}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"result-block",children:[(0,n.jsx)(b,{right:(0,n.jsxs)("div",{ref:h,className:"flex items-center gap-2 bg-transparent shadow-none fretboard-toggle","aria-label":"Fretboard notation",role:"tablist",children:[(0,n.jsx)("button",{role:"tab","aria-selected":"degrees"===ek,tabIndex:"degrees"===ek?0:-1,className:["chip","chip--key","degrees"===ek?"chip--active":""].join(" "),onClick:()=>eI("degrees"),"data-roving":"item",children:u?"度数":"Degrees"}),(0,n.jsx)("button",{role:"tab","aria-selected":"names"===ek,tabIndex:eR&&"names"===ek?0:-1,"aria-disabled":!eR,className:["chip","chip--key","names"===ek?"chip--active":"",eR?"":"chip--disabled"].join(" "),onClick:()=>{eR&&eI("names")},"data-roving":"item",children:u?"音名":"Names"})]}),children:u?"フレットボード":"Fretboard"}),(0,n.jsx)("div",{className:"fret-wrap",children:(0,n.jsx)("div",{className:"fret-inner",children:ev?(()=>{let e=ev.root,t=(0,c.p3)(e,ev.type).map(e=>l.T_[e]),a=eR?ek:"degrees",s=(()=>{let e=null==ev?void 0:ev.type;return e&&(e.toLowerCase().includes("aeolian")||e.toLowerCase().startsWith("min"))?"min":"maj"})();return(0,n.jsx)(i.Z,{overlay:{viewMode:"sounding",capo:0,notes:t,chordNotes:null!=eS?eS:void 0,showScaleGhost:!!eS,display:a,scaleRootPc:e,scaleType:ev.type,context:{chordRootPc:e,quality:s}},onRequestForms:(t,a)=>{var n;eM({at:t,rootPc:null!==(n=a.rootPc)&&void 0!==n?n:e,quality:a.quality})},formShape:eP})})():(0,n.jsx)("div",{className:"text-center text-sm opacity-50 py-8",children:u?"分析をクリックしてフレットボードを表示":"Click Analyze to see fretboard"})})})]}),(0,n.jsxs)("section",{className:"result-block space-y-2",children:[(0,n.jsx)(b,{children:(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:u?"ダイアトニック":"Diatonic"}),(0,n.jsxs)(v.Z,{className:"ml-1",title:"Diatonic chords",linkHref:"/resources/glossary",linkLabel:"Glossary",children:[(0,n.jsx)("p",{className:"text-sm",children:"Chords built only from the key’s scale tones (I–ii–iii–IV–V–vi–vii\xb0)."}),(0,n.jsxs)("ul",{className:"mt-2 list-disc pl-5 space-y-1 text-sm",children:[(0,n.jsx)("li",{children:"Stable sound: everything stays inside the key."}),(0,n.jsx)("li",{children:"Use: begin inside → add color with a borrowed chord (iv, bVII, bVI)."}),(0,n.jsx)("li",{children:"Try: ii–V–I or IV–V–I for clear motion."})]}),(0,n.jsx)("h4",{className:"mt-3 font-medium",children:"Shaped vs. Sounding (Capo)"}),(0,n.jsxs)("ul",{className:"mt-1 list-disc pl-5 space-y-1 text-sm",children:[(0,n.jsx)("li",{children:"Shaped: labels show the shapes you fret after capo."}),(0,n.jsx)("li",{children:"Sounding: labels show the actual pitch you hear."})]})]})]})}),(0,n.jsx)(C.Z,{selectedId:eN,onSelectId:e=>eC(e),onPick:async e=>{let{id:t,pcs:a,isRightClick:n}=e;if(n){var s,o;let e=x._.getState().selectedKey,a=x._.getState().selectedScale;if(!e||!a)return;let n=a.type,r=null!==(s=c.vb[n])&&void 0!==s?s:[];if(7!==r.length){let e=(0,c.nZ)(n);e&&(r=null!==(o=c.vb[e])&&void 0!==o?o:[])}if(7!==r.length)return;let i=(0,d.Z)({tonicPc:e.tonic,scaleIntervals:r})[parseInt(t.replace("open-",""))];if(!i)return;let l=(0,d.Xs)({rootPc:i.rootPc,quality:i.quality}),u=[...A];u[B]=l,D(u),B<11&&J(B+1),(0,q.j)("diatonic_pick",{page:"find-key",action:"right_click_add"});return}if(eN===t){eV(null),eC(null),eA();return}eV(a.map(e=>l.T_[e])),eC(t),eA(),(0,q.j)("diatonic_pick",{page:"find-key"});try{await P.h.resume();let e=a.map(e=>60+e%12);P.h.playChord(e,"lightStrum",260)}catch(e){}}})]}),eR&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b,{children:u?"度数進行":"Roman"}),(0,n.jsx)("div",{ref:tH,className:"rounded-md border px-3 py-2","aria-live":"polite","data-testid":"roman-row",children:(0,n.jsx)("div",{className:"flex-1 overflow-x-auto whitespace-nowrap text-lg md:text-xl tracking-wide",children:0===eh.length?(0,n.jsx)("span",{children:"-"}):eh.map((e,t)=>(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)("span",{"data-idx":t,className:tL&&t>=tL.start&&t<=tL.end?"roman-mark":void 0,children:String(e||"").toUpperCase()}),t<eh.length-1?(0,n.jsx)("span",{"aria-hidden":!0,className:"mx-1",children:"–"}):null]},"rom-".concat(t)))})})]}),tF.length>0&&(0,n.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs opacity-70",children:u?"パターン":"Patterns"}),(()=>{var e;let t=tF[0],a={"doo-wop":"dooWop",axis:"axis",canon:"canon","ii-V-I":"twoFiveOne",turnaround:"turnaround",andalusian:"andalusian",authentic:"authentic",plagal:"plagal",deceptive:"deceptive"},s=a[t.id]?{label:V[e=a[t.id]],summary:T[e]}:null,o=(null==s?void 0:s.label)||t.name.replace(/\(([^)]+)\)/g,(e,t)=>{let a=t.replace(/[ivx]+/g,e=>e.toUpperCase());return"(".concat(a,")")}).replace(/\(I–vi–IV–V\)/,"(I–VI–IV–V)"),r=(null==s?void 0:s.summary)||t.summary||t.name;return tL&&tL.start===t.start&&(tL.end,t.end),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{type:"button",className:"text-sm leading-tight font-medium hover:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400/50 rounded",title:r,onClick:()=>{tW(e=>e&&e.start===t.start&&e.end===t.end?null:{start:Math.max(0,t.start),end:Math.max(t.start,Math.min(eh.length-1,t.end))}),requestAnimationFrame(()=>{let e=tH.current;if(!e)return;let a=e.querySelector('[data-idx="'.concat(t.start,'"]'));a&&(e.scrollLeft=Math.max(0,a.offsetLeft-12))})},children:o},"".concat(t.id,"-0")),(0,n.jsx)(v.Z,{ariaLabel:"".concat(o," – info"),text:"".concat(o,"\n\n").concat(r)})]})})()]}),(tJ.length>0||tY)&&(0,n.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs opacity-70",children:u?"カデンツ":"Cadence"}),(()=>{var e,t,a,s,o,r,i;let l=null!==(e=tJ[0])&&void 0!==e?e:tY,c=null!==(t=null==l?void 0:l.type)&&void 0!==t?t:l,d=null!==(a=null==l?void 0:l.tail)&&void 0!==a?a:null==l?void 0:l.tailRoman,u=c?"perfect"===c?"Perfect (".concat(null!==(s=null==d?void 0:d.from)&&void 0!==s?s:"V"," → ").concat(null!==(o=null==d?void 0:d.to)&&void 0!==o?o:"I",")"):"deceptive"===c?"Deceptive (".concat(null!==(r=null==d?void 0:d.from)&&void 0!==r?r:"V"," → ").concat(null!==(i=null==d?void 0:d.to)&&void 0!==i?i:"vi",")"):"Half (".concat((null==d?void 0:d.from)?"".concat(d.from," → "):"… → ","V)"):"";return(0,n.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-sm leading-tight",children:[(0,n.jsx)("span",{className:"font-medium",children:u}),(0,n.jsx)(v.Z,{text:c?"perfect"===c?"Resolves to the Tonic: V → I. Feels fully resolved.":"deceptive"===c?"Surprises by avoiding I: V → vi (or similar).":"Phrase ends on the Dominant: … → V. Feels unresolved.":"No cadence detected."})]})})()]})]})]}),(0,n.jsx)("section",{className:"ot-card","aria-label":"Ad",children:(0,n.jsx)(o.default,{page:"chord_progression",format:"horizontal"})}),tg&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",style:{backdropFilter:"blur(4px)"},children:(0,n.jsxs)("div",{ref:tb,className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl p-6 max-w-md w-full mx-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:u?"プリセットを読み込み":"Load Preset"}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"text-xs opacity-70 mb-1 block",children:u?"キー":"Key"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].map(e=>(0,n.jsx)("button",{className:"chip ".concat(tx===e?"chip--active":""),onClick:()=>tf(e),children:e},e))})]}),(0,n.jsxs)("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:[(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-V-vi-IV",["Ⅰ","Ⅴ","Ⅵm","Ⅳ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅴ–Ⅵm–Ⅳ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Pop progression"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("ii-V-I",["Ⅱm","Ⅴ","Ⅰ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅱm–Ⅴ–Ⅰ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Jazz turnaround"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("12-bar-blues",["Ⅰ","Ⅰ","Ⅰ","Ⅰ","Ⅳ","Ⅳ","Ⅰ","Ⅰ","Ⅴ","Ⅳ","Ⅰ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"12-bar Blues"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Classic blues form (all 12 slots)"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-II",["Ⅰ","Ⅱ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅱ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Simple two-chord progression"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-bVII-IV",["Ⅰ","♭Ⅶ","Ⅳ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅶ–Ⅳ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Rock progression"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("vi-IV-I-V",["Ⅵm","Ⅳ","Ⅰ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅳ–Ⅰ–Ⅴ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Emotional / Ballad (I-V-vi-IVの逆回転)"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-vi-IV-V",["Ⅰ","Ⅵm","Ⅳ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅵm–Ⅳ–Ⅴ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"50's progression / Doo-wop"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-IV-V",["Ⅰ","Ⅳ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅳ–Ⅴ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Three-chord song / Rock classic"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("vi-ii-V-I",["Ⅵm","Ⅱm","Ⅴ","Ⅰ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅱm–Ⅴ–Ⅰ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Circle progression / Jazz standard"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-bVII-bVI-bVII",["Ⅰ","♭Ⅶ","♭Ⅵ","♭Ⅶ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅶ–♭Ⅵ–♭Ⅶ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Mixolydian vamp / Rock anthem"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-IVm-I-V",["Ⅰ","Ⅳm","Ⅰ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅳm–Ⅰ–Ⅴ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Borrowed chord / Minor IV"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("vi-IV-I-III",["Ⅵm","Ⅳ","Ⅰ","Ⅲ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅳ–Ⅰ–Ⅲ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Andalusian cadence / Spanish feel"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-bIII-bVII-IV",["Ⅰ","♭Ⅲ","♭Ⅶ","Ⅳ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅲ–♭Ⅶ–Ⅳ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Modal interchange / Epic progression"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-iii-IV-V",["Ⅰ","Ⅲm","Ⅳ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅲm–Ⅳ–Ⅴ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Classic progression / Beatles style"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-V-vi-iii-IV-I-IV-V",["Ⅰ","Ⅴ","Ⅵm","Ⅲm","Ⅳ","Ⅰ","Ⅳ","Ⅴ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅴ–Ⅵm–Ⅲm–Ⅳ–Ⅰ–Ⅳ–Ⅴ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Pachelbel's Canon / Wedding classic"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-bVI-bVII-I",["Ⅰ","♭Ⅵ","♭Ⅶ","Ⅰ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅵ–♭Ⅶ–Ⅰ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Power ballad / 80s rock"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("vi-V-IV-III",["Ⅵm","Ⅴ","Ⅳ","Ⅲ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅴ–Ⅳ–Ⅲ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Descending progression / Melancholic"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-IV-bVII-IV",["Ⅰ","Ⅳ","♭Ⅶ","Ⅳ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅳ–♭Ⅶ–Ⅳ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Folk/Country vamp"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-bVII-IV-I",["Ⅰ","♭Ⅶ","Ⅳ","Ⅰ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅶ–Ⅳ–Ⅰ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Stadium anthem / Closing progression"})]}),(0,n.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>tZ("I-iii-vi-IV",["Ⅰ","Ⅲm","Ⅵm","Ⅳ"],tx),children:[(0,n.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅲm–Ⅵm–Ⅳ"}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:"Smooth descent / R&B style"})]})]}),(0,n.jsx)("button",{className:"mt-4 w-full px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>ty(!1),children:u?"キャンセル":"Cancel"})]})}),tN&&(0,n.jsx)(G,{message:tN.message,type:tN.type,ctaText:tN.ctaText,ctaHref:tN.ctaHref,ctaPlace:tN.ctaPlace,onClose:()=>tC(null)})]})}},8041:function(e,t,a){a.d(t,{p:function(){return r}});var n=a(6463);let s={header:"Get iOS App",sticky:{title:"Get Pro features on iOS",subtitle:"MIDI • Sections • Unlimited",button:"Get App"},footer:{title:"Get the full experience on iOS",button:"Download on App Store",features:"• Pro features: MIDI export, Section editing, Unlimited sketches"},toast:{limitWarn:"8+ chords recommended for better accuracy. Want unlimited? Get iOS Pro!",limitBlock:"12 chord limit reached (Web Lite). Upgrade to iOS Pro for unlimited!",sketchLimit:"3 sketch limit reached! Delete a sketch or upgrade to iOS Pro for unlimited sketches.",pngExport:"PNG exported! Want MIDI export? Get iOS Pro for full DAW integration!",ctaButton:"Get Pro"}},o={header:"iOS版を入手",sticky:{title:"iOSでPro機能を使う",subtitle:"MIDI・セクション編集・無制限保存",button:"アプリを入手"},footer:{title:"iOSで全機能を体験",button:"App Storeで入手",features:"• Pro機能：MIDI書き出し・セクション編集・無制限保存"},toast:{limitWarn:"精度向上のため8コード以上を推奨。無制限はiOS Proへ",limitBlock:"（Web Lite）12コードの上限に達しました。iOS Proなら無制限です。",sketchLimit:"スケッチは3件までです。削除するか、iOS Proで無制限に。",pngExport:"PNGを書き出しました。MIDI書き出しはiOS Proで—DAWと完全連携。",ctaButton:"Pro版へ"}};function r(){return((0,n.usePathname)()||"/").startsWith("/ja")?o:s}},1792:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(2265),s=a(7152);function o(){return{trackClick:(0,n.useCallback)((e,t)=>{(0,s.Ie)(e,{page:window.location.pathname,...t})},[])}}}}]);
"use strict";exports.id=2623,exports.ids=[2623],exports.modules={3345:(e,t,n)=>{n.d(t,{default:()=>r});var o=n(326),a=n(7577);n(3683);var i=n(7639);function r({page:e,slot:t="XXXXXXXXXX",format:n="auto",style:r={}}){let{isPro:s}=(0,i.Z)(),[l,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(!1);return s?null:o.jsx("div",{style:{minHeight:110,...r},"aria-label":"Advertisement",className:"ad-container",children:l?o.jsx("ins",{className:"adsbygoogle",style:{display:"block",...r},"data-ad-client":"ca-pub-9662479821167655","data-ad-slot":t,"data-ad-format":n,"data-full-width-responsive":"true"}):null})}},2784:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(326),a=n(7577),i=n.n(a),r=n(2534),s=n(920),l=n(3934),c=n(6178);let d=n(7419).Mw;function m({onPick:e,selectedId:t,onSelectId:n}){let m=(0,r._)(e=>e.selectedKey),u=(0,r._)(e=>e.selectedScale),h=(0,l.H_)(u?.type??"Ionian"),f="px-2 py-1 text-center border rounded-[var(--chip-br)]",b=(0,a.useRef)(null),p=(0,a.useRef)(!1),y=(0,a.useCallback)((t,o,a)=>{p.current=!1,b.current=setTimeout(()=>{if(p.current=!0,window.confirm(`Add "${o}" to progression?`)){let o=`open-${t}`;n?.(o),e?.({id:o,row:"open",degree:t,pcs:a,capo:0,isRightClick:!0})}},500)},[e,n]),g=(0,a.useCallback)(()=>{b.current&&(clearTimeout(b.current),b.current=null)},[]),v=i().useMemo(()=>{if(!m||!u)return Array(7).fill({sym:"—",pcs:[]});let e=u.type,t=l.vb[e]??[];if(7!==t.length){let n=(0,l.nZ)(e);n&&(t=l.vb[n]??[])}return 7!==t.length?Array(7).fill({sym:"—",pcs:[]}):(0,s.Z)({tonicPc:m.tonic,scaleIntervals:t}).map(e=>({sym:(0,s.Xs)({rootPc:e.rootPc,quality:e.quality}),pcs:e.pcs}))},[m,u]),x=i().useMemo(()=>{if(!m||!u)return[];let e="Major"===m.mode||"Minor"===m.mode?m.mode:"major"===m.mode?"Major":"Minor";return(0,c.Uv)({tonic:m.tonic,mode:e},{type:u.type},3,{includeOpen:!0}).filter(e=>0!==e.capo).sort((e,t)=>e.capo-t.capo).slice(0,2).map(e=>{let t=e.playAs,n=/m$/.test(t)?t.replace(/m$/,""):t,o=d.indexOf(n),a=u.type,i=l.vb[a]??[];if(7!==i.length){let e=(0,l.nZ)(a);e&&(i=l.vb[e]??[])}let r=7===i.length?(0,s.Z)({tonicPc:o,scaleIntervals:i}):[],c=(r.length?r:Array(7).fill(null)).map(e=>e?(0,s.Xs)({rootPc:e.rootPc,quality:e.quality}):"—"),m=(r.length?r:Array(7).fill(null)).map(e=>e?e.pcs:[]);return{capo:e.capo,label:`Capo ${e.capo}`,cells:c,cellsPcs:m,tooltip:`Play as ${t}${e.reasons&&e.reasons.length?" \xb7 "+e.reasons.join(" \xb7 "):""}`}})},[m,u]),M=h.map(e=>e.replaceAll("b","♭").replaceAll("#","♯"));return o.jsx("div",{className:"overflow-x-auto capo-compact capo-compact--tight","aria-live":"polite","aria-labelledby":"diatonic-title",children:(0,o.jsxs)("table",{className:"w-full border-separate rounded-xl border text-sm md:text-[0.95rem]",style:{borderSpacing:"6px"},children:[(0,o.jsxs)("colgroup",{children:[o.jsx("col",{className:"w-12 sm:w-14 md:w-18"}),o.jsx("col",{span:7})]}),o.jsx("thead",{children:(0,o.jsxs)("tr",{children:[o.jsx("th",{scope:"col",className:"px-1 py-0 text-center text-sm font-medium border-none bg-transparent rounded-none"}),M.map((e,t)=>o.jsx("th",{scope:"col",className:"px-1 py-0 text-center text-sm font-medium border-none bg-transparent rounded-none",children:e},`hdr-${t}`))]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{"data-row":"open",children:[o.jsx("th",{scope:"row",className:"px-1 py-0 text-center text-xs font-normal border-none bg-transparent rounded-none text-foreground/70",title:"Open (no capo)",children:"Open"}),v.map((a,i)=>o.jsx("td",{className:[f,"bg-emerald-50 border-emerald-200 text-emerald-900 dark:bg-emerald-800/25 dark:border-emerald-700 dark:text-emerald-100",e?"cursor-pointer select-none tapfx":"",t===`open-${i}`?"ring-2 ring-emerald-400/60 dia-cell--active":"dia-cell--idle"].join(" "),onClick:t=>{if(2===t.button)return;if(p.current){p.current=!1;return}let o=`open-${i}`;n?.(o),e?.({id:o,row:"open",degree:i,pcs:a.pcs,capo:0})},onContextMenu:t=>{if(t.preventDefault(),t.stopPropagation(),window.confirm(`Add "${a.sym}" to progression?`)){let t=`open-${i}`;n?.(t),e?.({id:t,row:"open",degree:i,pcs:a.pcs,capo:0,isRightClick:!0})}},onTouchStart:()=>y(i,a.sym,a.pcs),onTouchEnd:g,onTouchCancel:g,role:e?"button":void 0,"aria-label":e?`Open ${a.sym}`:void 0,"aria-pressed":t===`open-${i}`,children:a.sym},`open-${i}`))]}),x.map(e=>(0,o.jsxs)("tr",{children:[o.jsx("th",{scope:"row",className:"px-1 py-0 text-center text-xs font-normal border-none bg-transparent rounded-none text-foreground/70",title:e.tooltip,children:e.label}),e.cells.map((n,a)=>o.jsx("td",{className:[f,"border-neutral-300 dark:border-neutral-700","opacity-65 cursor-default pointer-events-none",t===`capo${e.capo}-${a}`?"dia-cell--active":"dia-cell--idle"].join(" "),role:"button",tabIndex:-1,"aria-disabled":"true","aria-label":`${e.label} ${n}`,children:n},`capo-${e.capo}-${a}`))]},`capo-${e.capo}`))]})]})})}},2331:(e,t,n)=>{n.d(t,{Z:()=>h});var o=n(326),a=n(7577),i=n.n(a),r=n(1621),s=n(3934),l=n(8936);let c=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],d="hsl(210 10% 72% / .70)",m=(e,t)=>{let n=t?24:26;return{width:n,height:n,borderRadius:n,background:e,color:"#0b0b0b",fontWeight:700,fontSize:t?13:14,display:"flex",alignItems:"center",justifyContent:"center",transform:"translate(-50%, -50%)",textShadow:"0 0 1px rgba(0,0,0,.55)",WebkitTextStroke:"0.3px rgba(255,255,255,.35)",userSelect:"none"}};function u(e,t,n,o,a){if(!o)return"hsl(210 6% 38% / .30)";if(e)return n?"hsl(0 85% 55% / .95)":d;if(a)return"hsl(355 80% 60% / .95)";if(!t)return d;let i=t.replace(/\s/g,"");return i.includes("3")?"hsl(205 90% 56% / .90)":i.includes("5")?"hsl(150 65% 45% / .90)":i.includes("7")?"hsl(48 95% 55% / .92)":d}function h({strings:e=["E","B","G","D","A","E"],frets:t=15,dotPositions:n=[3,5,7,9,12,15],overlay:d=null,onRequestForms:h,formShape:f=null}){let y=(0,a.useRef)(null),[g,v]=(0,a.useState)(!1),[x,M]=(0,a.useState)(null),j=d??null,w=e=>`48px repeat(${e}, minmax(28px, 1fr))`;return(0,a.useRef)(null),(0,o.jsxs)("div",{className:"rounded-lg border p-3 overflow-x-auto ot-fretboard ot-fb-compact",children:[o.jsx("div",{className:"min-w-[640px]",children:(0,o.jsxs)("div",{ref:y,className:"relative",style:{height:32+28*e.length+16},children:[o.jsx("div",{className:"pointer-events-none absolute top-1 grid text-[12px] md:text-sm text-foreground/80",style:{gridTemplateColumns:w(t),height:32,left:44,right:0},children:Array.from({length:t+1}).map((e,t)=>[0,1,3,5,7,9,12,15].includes(t)?o.jsx("div",{className:"flex items-start justify-center",children:o.jsx("span",{className:"inline-block px-1 rounded bg-background/80",children:t})},t):o.jsx("div",{},t))}),o.jsx("div",{className:"absolute select-none",style:{left:0,top:32,width:44,height:28*e.length,display:"grid",gridTemplateRows:`repeat(${e.length}, 28px)`},"aria-hidden":"true",children:e.map((e,t)=>o.jsx("div",{className:"flex items-center justify-center text-xs md:text-sm leading-none text-muted-foreground",children:e},`lbl-${t}`))}),(0,o.jsxs)("div",{className:"absolute right-0 bottom-0 grid",style:{top:32,left:44,width:"calc(100% - 44px)",gridTemplateColumns:w(t),gridTemplateRows:`repeat(${e.length}, 28px)`},children:[e.map((n,a)=>(0,o.jsxs)(i().Fragment,{children:[o.jsx("div",{className:"relative",children:function({overlay:e,strings:t,rowIdx:n,isMobile:a}){if(!e)return null;let i=e.chordNotes??e.notes??[],d=(i?.length??0)>0?b(i[0]??"C"):0,h=new Set((i||[]).map(e=>b(e??"C"))),f=b(t[n]??"E"),y=[64,59,55,50,45,40],g=y[Math.min(n,y.length-1)]??64,v=e.scaleRootPc,x=e.scaleType,M=(()=>{if("number"!=typeof v||!x)return!0;let t=(f-v+120)%12;return(0,s.Rq)(v,e.scaleType).map(e=>(e-v+120)%12).includes(t)})(),j=(i?.length??0)>0,w=(e.showScaleGhost??!0)&&j&&M&&!h.has(f),I=h.has(f),A=!j&&M;if(!w&&!I&&!A)return null;let E="number"==typeof v?(f-v+120)%12:0,C=[0,4,7,10,11].includes(E)&&M,k=M&&"number"==typeof v&&x?(0,s.Ue)(f,v,e.scaleType)??null:null,P=u(!1,k,C,M,0===E),R="degrees"===e.display?(0,s.Jw)(f,d,e.scaleType)??k??p(f,d):c[f],$=(()=>{let t=r.l7.find(t=>t.id===e.scaleType);return(t?.degrees?.length??0)>7})(),S=`string ${n+1}, fret 0, ${"1"===R?"root":R}`;return(0,o.jsxs)("div",{className:"absolute inset-0",children:[w&&o.jsx("div",{className:`absolute left-1/2 top-1/2 fret-dot--ghost${$?" ghost--dense":""}`,style:{color:"hsl(210 12% 58% / .60)"},"aria-hidden":!0}),A&&o.jsx("button",{type:"button",onClick:async()=>{await l.h.resume(),l.h.playNote(g)},style:m(P,a),className:"absolute left-1/2 top-1/2 fret-dot fret-dot--main","aria-label":S,children:R}),I&&o.jsx("button",{type:"button",onClick:async()=>{await l.h.resume(),l.h.playNote(g)},style:m(P,a),className:"absolute left-1/2 top-1/2 fret-dot fret-dot--main fret-dot--chord","aria-label":S,children:R})]})}({overlay:j,strings:e,rowIdx:a,isMobile:g})},`open-${a}`),Array.from({length:t}).map((t,n)=>o.jsx("div",{className:`relative ${0===n?"border-l border-transparent":"border-l border-black/10 dark:border-white/10"} ${x&&x.r===a&&x.c===n?"fb-pressed":""} cursor-pointer select-none`,onClick:async()=>{let e=[64,59,55,50,45,40],t=e[Math.min(a,e.length-1)]??64;M(e=>({r:a,c:n,ver:(e?.ver??0)+1}));let o=(x?.ver??0)+1;window.setTimeout(()=>{M(e=>e&&e.r===a&&e.c===n&&e.ver===o?null:e)},180);try{await l.h.resume(),l.h.playNote(t+(n+1),240)}catch{}},children:function({overlay:e,strings:t,rowIdx:n,colIdx:a,isMobile:i}){if(!e)return null;let d=e.chordNotes??e.notes??[],h=(d?.length??0)>0?b(d[0]??"C"):0,f=new Set((d||[]).map(e=>b(e??"C"))),y=b(t[n]??"E"),g=a+1,v=(y+g)%12,x=[64,59,55,50,45,40],M=(x[Math.min(n,x.length-1)]??64)+g,j=e.scaleRootPc,w=e.scaleType,I=(()=>{if("number"!=typeof j||!w)return!0;let t=(v-j+120)%12;return(0,s.Rq)(j,e.scaleType).map(e=>(e-j+120)%12).includes(t)})(),A=(d?.length??0)>0,E=(e.showScaleGhost??!0)&&A&&I&&!f.has(v),C=f.has(v),k=!A&&I;if(!E&&!C&&!k)return null;let P="number"==typeof j?(v-j+120)%12:0,R=f.has(v)||[0,4,7,10,11].includes(P),$=I&&"number"==typeof j&&w?(0,s.Ue)(v,j,e.scaleType)??null:null,S=u(!1,$,R,I,0===P),V="degrees"===e.display,T="number"==typeof j?j:h,N=V?(0,s.Jw)(v,T,e.scaleType)??$??p(v,T):c[v],D=(()=>{let t=r.l7.find(t=>t.id===e.scaleType);return(t?.degrees?.length??0)>7})(),L=`string ${n+1}, fret ${a+1}, ${"1"===N?"root":N}`;return(0,o.jsxs)("div",{className:"absolute inset-0","aria-live":"polite",children:[E&&o.jsx("div",{className:`absolute left-1/2 top-1/2 fret-dot--ghost${D?" ghost--dense":""}`,style:{color:function(e,t=.85){try{if(e.includes("/"))return e.replace(/\/(.*?)\)/,`/ ${t})`);if(e.endsWith(")"))return e.replace(/\)$/,` / ${t})`)}catch{}return e}(S)},"aria-hidden":!0}),k&&o.jsx("button",{type:"button",onClick:async()=>{await l.h.resume(),l.h.playNote(M)},style:m(S,i),className:"absolute left-1/2 top-1/2 fret-dot fret-dot--main","aria-label":L,children:N}),C&&o.jsx("button",{type:"button",onClick:async()=>{await l.h.resume(),l.h.playNote(M)},style:m(S,i),className:"absolute left-1/2 top-1/2 fret-dot fret-dot--main fret-dot--chord","aria-label":L,children:N})]})}({overlay:j,strings:e,rowIdx:a,colIdx:n,isMobile:g})},`c-${a}-${n}`))]},`row-${a}`)),o.jsx("div",{"aria-hidden":!0,className:"absolute pointer-events-none z-[20] bg-black/60 dark:bg-white/70",style:{left:46.5,top:0,bottom:0,width:3,borderRadius:2}})]})]})}),f&&function({formShape:e,LEFT_GUTTER:t,TOP_BAR_H:n,SPACE_W:a,ROW_H:i}){return e.dots.map((e,r)=>{let s="1"===e.deg?"root":e.deg.replace(/b/g,"flat ").replace(/#/g,"sharp "),l=`string ${e.string}, fret ${e.fret}, ${s}`,c=`calc(${t}px + ${e.fret*a}px)`,d=`calc(${n}px + ${(e.string-.5)*i}px)`;return o.jsx("div",{className:"absolute",role:"img","aria-label":l,style:{left:c,top:d,transform:"translate(-50%, -50%)"},children:o.jsx("span",{className:"fret-dot--form","aria-hidden":!0})},`form-${r}`)})}({formShape:f,LEFT_GUTTER:44,TOP_BAR_H:32,SPACE_W:28,ROW_H:28})]})}let f={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},b=e=>f[e]??0;function p(e,t){return["1","b2","2","b3","3","4","#4","5","b6","6","b7","7"][(e-t+12)%12]}},8602:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(326),a=n(4666);function i({scaleId:e}){let t=(0,a.qi)(e);if(!t)return null;let n=t.comments.en;return(0,o.jsxs)("div",{className:"space-y-1.5",children:[(0,o.jsxs)("div",{children:[o.jsx("div",{className:"font-semibold text-amber-600 text-sm mb-1",children:"Degrees"}),o.jsx("div",{className:"text-zinc-800 text-sm",children:t.degrees.join(" - ")})]}),(0,o.jsxs)("div",{children:[o.jsx("div",{className:"font-semibold text-amber-600 text-sm mb-1",children:"Vibe"}),o.jsx("div",{className:"text-zinc-800 text-sm",children:n.vibe})]}),(0,o.jsxs)("div",{children:[o.jsx("div",{className:"font-semibold text-amber-600 text-sm mb-1",children:"Usage"}),o.jsx("div",{className:"text-zinc-800 text-sm",children:n.use})]}),(0,o.jsxs)("div",{children:[o.jsx("div",{className:"font-semibold text-amber-600 text-sm mb-1",children:"Try"}),o.jsx("div",{className:"text-zinc-800 text-sm",children:n.try})]}),(0,o.jsxs)("div",{children:[o.jsx("div",{className:"font-semibold text-amber-600 text-sm mb-1",children:"Theory"}),o.jsx("div",{className:"text-zinc-800 text-sm",children:n.theory})]})]})}},6961:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(326),a=n(7577),i=n(962);function r({text:e,title:t,children:n,className:r="",linkHref:s,linkLabel:l="Learn more",ariaLabel:c="More info",icon:d="info",placement:m="bottom",trigger:u}){let[h,f]=(0,a.useState)(!1),b=(0,a.useRef)(null),p=(0,a.useRef)(null),[y,g]=(0,a.useState)({left:0,top:0,maxW:320}),v=(0,a.useCallback)(e=>{p.current=e},[]),x=u?(0,a.cloneElement)(u,{ref:v,onClick:e=>{e.stopPropagation(),f(e=>!e)},"aria-label":c}):o.jsx("button",{ref:p,onClick:e=>{e.stopPropagation(),f(e=>!e)},className:"info-dot","aria-label":c,children:"graduation"===d?o.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"})}):"i"});return(0,o.jsxs)("div",{ref:b,className:`relative inline-flex items-center ${r}`,children:[x,h&&(0,i.createPortal)((0,o.jsxs)("div",{role:"dialog",className:"info-card",style:{position:"fixed",zIndex:60,left:`${y.left}px`,top:`${y.top}px`,maxWidth:`${y.maxW}px`,transform:"top"===m?"translateY(-100%) translateY(-8px)":"none"},onClick:e=>e.stopPropagation(),children:[t&&o.jsx("div",{className:"font-medium mb-1",children:t}),n||(e??"").split("\n").map((e,t)=>o.jsx("div",{children:e},t)),s&&o.jsx("div",{className:"mt-2 text-right",children:o.jsx("a",{href:s,className:"underline text-[12px] opacity-80",children:l})})]}),document.body)]})}},3079:(e,t,n)=>{function o(e,t={}){let{itemSelector:n='[role="tab"],[data-roving="item"]',orientation:o="horizontal",includeHomeEnd:a=!0}=t}n.d(t,{H:()=>o}),n(7577)},6178:(e,t,n)=>{n.d(t,{Uv:()=>s});let o={C:[3,3,3,1,3,3,0],G:[3,3,1,3,3,3,0],D:[3,3,1,3,3,1,0],A:[3,1,1,3,2,1,0],E:[3,1,0,3,1,1,0]},a={Am:[3,0,3,3,3,1,3],Em:[3,0,3,3,1,3,3],Dm:[3,0,1,0,3,0,3]};function i(e){return e<=5?1:e<=7?.92:e<=9?.82:.7}let r={0:"C",1:"C#",2:"D",3:"Eb",4:"E",5:"F",6:"F#",7:"G",8:"Ab",9:"A",10:"Bb",11:"B"};function s(e,t,n=3,s={}){let l=s.includeOpen??!0,c=function(e){let t=e.toLowerCase();for(let e of["Major","Ionian","Lydian","Mixolydian","Major Pentatonic"])if(t.includes(e.toLowerCase()))return"majorish";return"minorish"}(t.type),d=[];for(let t=0;t<=11;t++){if(!l&&0===t)continue;let n=r[((e.tonic-t)%12+12)%12];if("majorish"===c){let e={C:"C",G:"G",D:"D",A:"A",E:"E"}[n];if(!e)continue;let a=o[e].reduce((e,t)=>e+t,0),r=o[e][0]>=2&&o[e][3]>=2&&o[e][4]>=2?2:0,s=(a+r)*i(t);d.push({capo:t,playAs:e,score:s,reasons:[`I–IV–V ${r?"◎":"○"}`,`open ${a}/16`,0===t?"open":`capo ${t}`]})}else{let e={A:"Am",E:"Em",D:"Dm"}[n];if(!e)continue;let o=a[e].reduce((e,t)=>e+t,0),r=a[e][0]>=2&&a[e][3]>=2?2:0,s=(o+r)*i(t);d.push({capo:t,playAs:e,score:s,reasons:[`i–iv ${r?"◎":"○"}`,`open ${o}/16`,0===t?"open":`capo ${t}`]})}}return d.sort((e,t)=>t.score-e.score).slice(0,n)}},4552:(e,t,n)=>{n.d(t,{I:()=>u,w:()=>function e(t,n={}){let u;let h=t.map(e=>e.trim()).filter(Boolean).map(c).filter(e=>!!e),f=function(e,t){let n=Array(e).fill(1),o=t.sections||[],a={...i,...t.weights?.section??{}},s=t.weights?.songHead??r.songHead,l=t.weights?.songTail??r.songTail,c=t.weights?.sectionEdge??r.sectionEdge;for(let t of o){let o=t.repeat??1,i=(t.weightMul??a[t.name]??1)*Math.sqrt(o);for(let o=t.start;o<=t.end&&o<e;o++)n[o]*=i;t.start<e&&(n[t.start]*=c),t.end<e&&(n[t.end]*=c)}e>0&&(n[0]*=s),e>1&&(n[e-1]*=l);let d=n.reduce((e,t)=>e+t,0)||1;return n.map(e=>e/d)}(h.length,n),b=[];for(let e of a)for(let t of["major","minor"]){let{score:n,reasons:a}=function(e,t,n){let a=d(t),i=[],r=n||e.map((t,n)=>0===n?1.2:n===e.length-1?1.3:1),s=r.reduce((e,t)=>e+t,0),c=0;e.forEach((e,n)=>{let s=r[n];(function(e,t){let n=e.root+("maj"===e.triad?"":"min"===e.triad?"m":"dim");return t.includes(n)})(e,a)?c+=1*s:function(e,t){let n=m(t.tonic),o=m(n);return e.root===o&&("maj"===e.triad||e.isDominantLike)}(e,t)?(c+=.9*s,i.push(`Secondary dominant tolerated: ${e.raw}`)):function(e,t){if("major"!==t.quality)return!1;let n=o.sr.majorKey(t.tonic).scale||[],a=n[3],i=n[6],r=a?l(a):"",s=i?l(l(o.jC.transpose(i,"-1m"))):"",c=e.root===r&&"min"===e.triad,d=e.root===s&&"maj"===e.triad;return!!(c||d)}(e,t)?(c+=.8*s,i.push(`Borrowed chord tolerated: ${e.raw}`)):c+=.5*s});let u=Math.round(c/s*100);return i.unshift(`${a.length} diatonic chords in ${t.tonic} ${t.quality}`),{score:u,reasons:i}}(h,{tonic:e,quality:t},f);b.push({key:{tonic:e,quality:t},confidence:n,reasons:a})}b.sort((e,t)=>t.confidence-e.confidence);let p=b.slice(0,5),y=function(e,t){let n=[s.major,s.naturalMinor,s.majorPent,s.minorPent,s.blues,s.dorian,s.mixolydian,s.lydian,s.harmonicMinor,s.melodicMinor],a=new Set(t.map(e=>e.root)),i=e.tonic,r=n.map(e=>{let t="major"===e.id?"Major":"naturalMinor"===e.id?"Natural Minor":"majorPent"===e.id?"Major Pentatonic":"minorPent"===e.id?"Minor Pentatonic":"blues"===e.id?"Blues":"dorian"===e.id?"Dorian":"mixolydian"===e.id?"Mixolydian":"lydian"===e.id?"Lydian":"harmonicMinor"===e.id?"Harmonic Minor":"Melodic Minor",n=new Set((o.Ci.get(`${i} ${t}`).notes||[]).map(l));return{scale:e,score:Array.from(a).filter(e=>n.has(e)).length/Math.max(1,a.size)}});return r.sort((e,t)=>t.score-e.score),r.slice(0,5)}(p[0].key,h);return n.sections&&n.sections.length>0&&(u=n.sections.map(n=>{let o=e(t.slice(n.start,Math.min(n.end+1,t.length)),{weights:{songHead:1,songTail:1}});return{section:n,best:o.keyCandidates[0],ranking:o.keyCandidates}})),{keyCandidates:p,recommendedScales:y,perSection:u}}});var o=n(2776);let a=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],i={Intro:.8,Verse:1,PreChorus:1.2,Chorus:1.6,PostChorus:1.3,Bridge:.9,Solo:1,Interlude:.8,Outro:.9,Breakdown:.9,Custom:1},r={songHead:1.2,songTail:1.3,sectionEdge:1.1},s={major:{id:"major",name:"Major Scale",tier:"free"},naturalMinor:{id:"naturalMinor",name:"Natural Minor Scale",tier:"free"},majorPent:{id:"majorPent",name:"Major Pentatonic",tier:"free"},minorPent:{id:"minorPent",name:"Minor Pentatonic",tier:"free"},blues:{id:"blues",name:"Blues Scale",tier:"free"},dorian:{id:"dorian",name:"Dorian Mode",tier:"pro"},mixolydian:{id:"mixolydian",name:"Mixolydian Mode",tier:"pro"},lydian:{id:"lydian",name:"Lydian Mode",tier:"pro"},harmonicMinor:{id:"harmonicMinor",name:"Harmonic Minor",tier:"pro"},melodicMinor:{id:"melodicMinor",name:"Melodic Minor",tier:"pro"}};function l(e){return o.jC.pitchClass(e)||e}function c(e){if(!e)return null;let[t]=e.split("/"),n=t.match(/^([A-Ga-g])([#b]?)(.*)$/);if(!n)return null;let o=l((n[1]+n[2]).toUpperCase()),a=(n[3]||"").toLowerCase(),i="maj";return/(m7b5|ø|dim)/.test(a)?i="dim":/maj/.test(a)?i="maj":/(^|[^a-z])m(?!aj)/.test(a)?i="min":(/sus|aug/.test(a),i="maj"),{raw:e,root:o,triad:i,isDominantLike:/(^|[^a-z])7(?![a-z0-9])/.test(a)||/7/.test(a)}}function d(e){if("major"===e.quality)return[...o.sr.majorKey(e.tonic).chords||[]];let t=o.sr.minorKey(e.tonic);return[...t.natural?.chords||[]]}function m(e){return l(o.jC.transpose(e,"5P"))}function u(e){return{chords:d({tonic:e.tonic,quality:e.quality})}}},2586:(e,t,n)=>{n.d(t,{h:()=>a});var o=n(7419);function a(e,t=o.y3){let n=function(e){let t=e.match(/^([A-G](?:#|b)?)(.*)$/);if(!t)return null;let n=t[1],a=(t[2]||"").toLowerCase(),i=(0,o.r)(n);if(i<0)return null;let r=function(e,t){let n;if(/(^|[^a-z])m(?!aj)/.test(e))n=[0,3,7];else{if(/dim|°/.test(e))return[0,3,6];if(/aug|\+/.test(e))return[0,4,8];n=[0,4,7]}return/maj7|M7/.test(t)?[...n,11]:/7/.test(e)?[...n,10]:/6/.test(e)?[...n.slice(0,3),9]:/sus4/.test(e)?[0,5,7]:/sus2/.test(e)?[0,2,7]:/9/.test(e)?[...n,10,14]:n}(a,e);return{rootPc:i,quality:a,intervals:r}}(e);if(!n)return null;let a=t+n.rootPc;return n.intervals.map(e=>a+e)}},7419:(e,t,n)=>{n.d(t,{Jt:()=>i,Mw:()=>o,Wo:()=>r,r:()=>s,y3:()=>a});let o=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],a=60;function i(e){return(e%12+12)%12}function r(e){return o[i(e)]}function s(e){let t=o.indexOf(e);return t>=0?t:-1}},1621:(e,t,n)=>{n.d(t,{l7:()=>o});let o=[{id:"Ionian",display:{en:"Major Scale"},group:"Diatonic",degrees:["1","2","3","4","5","6","7"],info:{oneLiner:"Major scale; bright and stable.",examples:[{title:"Let It Be",artist:"The Beatles"},{title:"Do-Re-Mi",artist:"Richard Rodgers"}]}},{id:"Dorian",display:{en:"Dorian Scale"},group:"Diatonic",degrees:["1","2","b3","4","5","6","b7"],info:{oneLiner:"Minor with a natural 6th; cool, modal colour.",examples:[{title:"So What",artist:"Miles Davis"}]}},{id:"Phrygian",display:{en:"Phrygian Scale"},group:"Diatonic",degrees:["1","b2","b3","4","5","b6","b7"],info:{oneLiner:"Dark, Spanish/Arabic flavour with flat 2."}},{id:"Lydian",display:{en:"Lydian Scale"},group:"Diatonic",degrees:["1","2","3","#4","5","6","7"],info:{oneLiner:"Dreamy major with raised 4th (♯4).",examples:[{title:"The Simpsons Theme",artist:"Danny Elfman"}]}},{id:"Mixolydian",display:{en:"Mixolydian Scale"},group:"Diatonic",degrees:["1","2","3","4","5","6","b7"],info:{oneLiner:"Major with flat 7; dominant, bluesy feel.",examples:[{title:"Sweet Home Alabama",artist:"Lynyrd Skynyrd"}]}},{id:"Aeolian",display:{en:"Natural Minor Scale"},group:"Diatonic",degrees:["1","2","b3","4","5","b6","b7"],info:{oneLiner:"Natural minor; sad or moody colour.",examples:[{title:"House of the Rising Sun",artist:"Traditional"}]}},{id:"Locrian",display:{en:"Locrian Scale"},group:"Diatonic",degrees:["1","b2","b3","4","b5","b6","b7"],info:{oneLiner:"Diminished 5th; unstable, rarely used as a key."}},{id:"MajorPentatonic",display:{en:"Major Pentatonic"},group:"Pentatonic",degrees:["1","2","3","5","6"],info:{oneLiner:"Five-note, open and melodic; fits many chords.",examples:[{title:"My Girl",artist:"The Temptations"}]}},{id:"MinorPentatonic",display:{en:"Minor Pentatonic"},group:"Pentatonic",degrees:["1","b3","4","5","b7"],info:{oneLiner:"Five-note minor staple for rock/blues solos.",examples:[{title:"Purple Haze",artist:"Jimi Hendrix"}]}},{id:"Blues",display:{en:"Blues Scale (minor)"},group:"Pentatonic",degrees:["1","b3","4","b5","5","b7"],info:{oneLiner:"Minor pentatonic plus blue note (♭5).",examples:[{title:"Smoke on the Water",artist:"Deep Purple"}]}},{id:"HarmonicMinor",display:{en:"Harmonic Minor"},group:"Minor",degrees:["1","2","b3","4","5","b6","7"],info:{oneLiner:"Minor with raised 7th; exotic dominant pull.",examples:[{title:"Misirlou",artist:"Traditional"}]}},{id:"MelodicMinor",display:{en:"Melodic Minor Scale"},group:"Minor",degrees:["1","2","b3","4","5","6","7"],info:{oneLiner:"Jazz minor (ascending); smooth minor/major blend."}},{id:"DiminishedWholeHalf",display:{en:"Diminished Scale (Whole–Half)"},group:"Other",degrees:["1","2","b3","4","b5","b6","6","7"],info:{oneLiner:"Symmetric 8-note (whole–half) scale; over dim7."}},{id:"DiminishedHalfWhole",display:{en:"Diminished Scale (Half–Whole)"},group:"Other",degrees:["1","b2","b3","3","#4","5","6","b7"],info:{oneLiner:"Symmetric 8-note (half–whole); over 7♭9 chords."}}]},3934:(e,t,n)=>{n.d(t,{H_:()=>f,Jw:()=>d,Rq:()=>i,Ue:()=>c,cm:()=>r,hg:()=>s,nZ:()=>m,p3:()=>p,vb:()=>a});var o=n(1621);let a={Ionian:[0,2,4,5,7,9,11],Dorian:[0,2,3,5,7,9,10],Phrygian:[0,1,3,5,7,8,10],Lydian:[0,2,4,6,7,9,11],Mixolydian:[0,2,4,5,7,9,10],Aeolian:[0,2,3,5,7,8,10],Locrian:[0,1,3,5,6,8,10],HarmonicMinor:[0,2,3,5,7,8,11],MelodicMinor:[0,2,3,5,7,9,11],MajorPentatonic:[0,2,4,7,9],MinorPentatonic:[0,3,5,7,10],Blues:[0,3,5,6,7,10],DiminishedWholeHalf:[0,2,3,5,6,8,9,11],DiminishedHalfWhole:[0,1,3,4,6,7,9,10]};function i(e,t){try{return p(e,t)}catch{}let n=a[t];if(!n||0===n.length)throw Error(`Unknown scale id: ${String(t)}`);return n.map(t=>(e+t+120)%12)}function r(e){let t={Major:"Ionian",Minor:"Aeolian"},n=String(e);return t[n]??t[n[0].toUpperCase()+n.slice(1)]??e}function s(e){let t={Major:"Ionian",Minor:"Aeolian"}[e]??e,n={Ionian:"Major Scale",Dorian:"Dorian",Phrygian:"Phrygian",Lydian:"Lydian",Mixolydian:"Mixolydian",Aeolian:"Natural Minor",Locrian:"Locrian",HarmonicMinor:"Harmonic Minor",MelodicMinor:"Melodic Minor",MajorPentatonic:"Major Pentatonic",MinorPentatonic:"Minor Pentatonic"}[t];if(n)return n;let a=o.l7.find(e=>e.id===t);return(a?.display.en||String(t)).replace(/\s*\(.*\)$/,"")}let l={Ionian:["1","2","3","4","5","6","7"],Dorian:["1","2","♭3","4","5","6","♭7"],Phrygian:["1","♭2","♭3","4","5","♭6","♭7"],Lydian:["1","2","3","♯4","5","6","7"],Mixolydian:["1","2","3","4","5","6","♭7"],Aeolian:["1","2","♭3","4","5","♭6","♭7"],Locrian:["1","♭2","♭3","4","♭5","♭6","♭7"],HarmonicMinor:["1","2","♭3","4","5","♭6","7"],MelodicMinor:["1","2","♭3","4","5","6","7"],MajorPentatonic:["1","2","3","5","6"],MinorPentatonic:["1","♭3","4","5","♭7"],Blues:["1","♭3","4","♭5","5","♭7"]};function c(e,t,n){let i=o.l7.find(e=>e.id===n),r=((i?i.degrees.map(e=>b[e]):void 0)??a[n]??[]).indexOf((e-t+120)%12);if(-1===r)return null;let s=i?.degrees??l[n]??void 0;return s?s[r]??null:null}function d(e,t,n){let i=o.l7.find(e=>e.id===n),r=((i?i.degrees.map(e=>b[e]):void 0)??a[n]??[]).indexOf((e-t+120)%12);if(-1===r)return null;let s=i?.degrees??l[n]??void 0;return s?function(e){let t=e.replace(/\s+/g,"").replace(/bb/g,"♭♭").replace(/b/g,"♭").replace(/##/g,"♯♯").replace(/#/g,"♯"),n=t.match(/^(♭|♯|♭♭|♯♯)?(\d)$/);if(!n)return t;let o=n[1]??"",a=n[2];return`${o}${({1:"R",2:"II",3:"III",4:"IV",5:"V",6:"VI",7:"VII"})[a]??a}`}(s[r]??""):null}function m(e){switch(e){case"MajorPentatonic":return"Ionian";case"MinorPentatonic":return"Aeolian";default:return null}}let u=[0,2,4,5,7,9,11],h=["I","II","III","IV","V","VI","VII"];function f(e){let t=a[e];return t&&7===t.length?t.map((e,t)=>{let n=h[t],o=e-u[t];return 0===o?n:o>0?"#".repeat(o)+n:"b".repeat(-o)+n}):[...h]}let b={1:0,b2:1,2:2,b3:3,3:4,4:5,"#4":6,b5:6,5:7,"#5":8,b6:8,6:9,bb7:9,b7:10,7:11};function p(e,t){let n=o.l7.find(e=>e.id===t);if(!n)throw Error(`Scale not found in catalog: ${String(t)}`);return n.degrees.map(t=>(e+b[t]+120)%12)}},4666:(e,t,n)=>{n.d(t,{ED:()=>s,f6:()=>i,qi:()=>a,tG:()=>r,zk:()=>l});let o=[{id:"major",categoryEn:"Basic",categoryJa:"基本",scaleEn:"Major Scale",scaleJa:"メジャースケール",aliasEn:["Ionian"],degrees:["R","2","3","4","5","6","7"],intervals:[0,2,4,5,7,9,11],tones:7,heptatonic:!0,comments:{en:{vibe:"Bright, positive, and full of happiness. The quintessential sound, perfect for beginnings or conveying a core message.",use:"The most important scale, forming the foundation of all music from J-POP and rock to country and nursery rhymes.",try:"Use it in the chorus to deliver a direct, positive emotion to the listener. When in doubt, start with this scale.",theory:"Composed of R-2-3-4-5-6-7. It harmonizes perfectly over Imaj7 and IVmaj7 chords."},ja:{vibe:"明るくポジティブ、幸福感に満ちた王道の響き。物語の始まりや、最も伝えたいメッセージを乗せるのに最適です。",use:"J-POP、ロック、カントリー、童謡など、あらゆる音楽の基礎を成す最も重要なスケールです。",try:"曲のサビで使うと、リスナーに最もストレートにポジティブな感情を届けられます。迷ったらまずはこのスケールから始めましょう。",theory:"構成音はR-2-3-4-5-6-7。ダイアトニックコードのImaj7、IVmaj7の上で完璧に調和します。"}}},{id:"naturalMinor",categoryEn:"Basic",categoryJa:"基本",scaleEn:"Natural Minor",scaleJa:"ナチュラルマイナースケール",aliasEn:["Aeolian"],degrees:["R","2","b3","4","5","b6","b7"],intervals:[0,2,3,5,7,8,10],tones:7,heptatonic:!0,comments:{en:{vibe:"Melancholy, sentimental, and poignant. Perfect for expressing not just joy, but also sorrow and introspection.",use:"Essential for deep songs like ballads, rock, and R&B. Its contrast with major scales creates drama.",try:"Use it to start a verse quietly, to cool down after a chorus, or to accompany emotional lyrics.",theory:"Composed of R-2-b3-4-5-b6-b7. It's the 6th mode of the major scale (Aeolian) and pairs perfectly with Im7 and IVm7 chords."},ja:{vibe:"物憂げで感傷的、切ない響き。喜びだけでなく、哀愁や内省的な感情を表現するのに最適です。",use:"バラード、ロック、R&Bなど、深みのある楽曲には欠かせません。メジャーとの対比が曲にドラマを生みます。",try:"Aメロで静かに始めたい時や、サビ後のクールダウン、感情的な歌詞に乗せて使ってみましょう。",theory:"構成音はR-2-b3-4-5-b6-b7。メジャースケールの6番目のモード(Aeolian)で、Im7、IVm7コードと相性抜群です。"}}},{id:"dorian",categoryEn:"Modes",categoryJa:"モード",scaleEn:"Dorian Scale",scaleJa:"ドリアンスケール",degrees:["R","2","b3","4","5","6","b7"],intervals:[0,2,3,5,7,9,10],tones:7,heptatonic:!0,comments:{en:{vibe:"Cool and stylish, sounding slightly bright for a minor scale. Its urban, floating quality is a staple in R&B and fusion.",use:'A go-to for funk rhythm guitar and jazz improvisation. Santana\'s "Oye Como Va" is a famous example.',try:"In a minor key song, change the IV chord to major (IV7). Using this scale over it will instantly create a Dorian world.",theory:"Composed of R-2-b3-4-5-6-b7. It's a brighter minor scale where the b6 of natural minor is raised to a major 6th. Often used over IIm7."},ja:{vibe:"マイナーなのに少し明るい、クールでおしゃれな響き。R&Bやフュージョンで多用される、都会的な浮遊感が魅力です。",use:'ファンクのカッティングギターや、ジャズのインプロヴィゼーションで定番。サンタナの"Oye Como Va"が有名です。',try:"マイナーキーの曲で、IVのコードをメジャー(IV7)に変えてみましょう。その上でこのスケールを使うと、一気にドリアンの世界観になります。",theory:"構成音はR-2-b3-4-5-6-b7。ナチュラルマイナーのb6が6になった、明るい響きのマイナースケールです。IIm7でよく使われます。"}}},{id:"phrygian",categoryEn:"Modes",categoryJa:"モード",scaleEn:"Phrygian Scale",scaleJa:"フリジアンスケール",degrees:["R","b2","b3","4","5","b6","b7"],intervals:[0,1,3,5,7,8,10],tones:7,heptatonic:!0,comments:{en:{vibe:"Passionate, Spanish, and exotic. Used to create mystery or heighten tension.",use:"Its unique character shines in Flamenco music and the heavy riffs of heavy metal.",try:"Use the major chord a half step above the root (the bII chord). For example, over E Phrygian, using an F major chord will instantly create a Spanish sound.",theory:"Composed of R-b2-b3-4-5-b6-b7. A very distinctive scale where the 2nd degree of natural minor is lowered to a b2."},ja:{vibe:"情熱的でスパニッシュ、エキゾチックな雰囲気が特徴。ミステリアスな場面や、緊張感を高めたい時に使います。",use:"フラメンコ音楽や、ヘヴィメタルの重いリフでその独特の世界観が活かされます。",try:"ルートのすぐ半音上のメジャーコード(bII)を使ってみましょう。例えばE Phrygianなら、Fコードを使うと一気にスパニッシュな響きになります。",theory:"構成音はR-b2-b3-4-5-b6-b7。ナチュラルマイナーの2がb2になった、非常に個性的なスケールです。"}}},{id:"lydian",categoryEn:"Modes",categoryJa:"モード",scaleEn:"Lydian Scale",scaleJa:"リディアンスケール",degrees:["R","2","3","#4","5","6","7"],intervals:[0,2,4,6,7,9,11],tones:7,heptatonic:!0,comments:{en:{vibe:"A grand, dreamlike sound that adds a floating quality to the major scale. Evokes magic, space, and fantasy.",use:"Often used in film and game scores to depict fantastical scenes or epic nature. Steve Vai is a frequent user.",try:"Try using this scale over the IVmaj7 chord in a major key. Its dreamy effect will be maximized.",theory:"Composed of R-2-3-#4-5-6-7. It's the major scale with a #4. This #4 note is the secret to its floating quality."},ja:{vibe:"メジャースケールに浮遊感を加えた、壮大で夢のような響き。魔法や宇宙を思わせる、幻想的なサウンドです。",use:"映画音楽やゲーム音楽で、幻想的なシーンや壮大な自然を描写するのによく使われます。スティーブ・ヴァイも多用します。",try:"メジャーキーのIVmaj7コードの上で、このスケールを試してみましょう。ドリーミーな効果が最大限に発揮されます。",theory:"構成音はR-2-3-#4-5-6-7。メジャースケールの4が#4になったスケール。この#4の音が浮遊感の秘密です。"}}},{id:"mixolydian",categoryEn:"Modes",categoryJa:"モード",scaleEn:"Mixolydian Scale",scaleJa:"ミクソリディアンスケール",degrees:["R","2","3","4","5","6","b7"],intervals:[0,2,4,5,7,9,10],tones:7,heptatonic:!0,comments:{en:{vibe:"A cheerful and funky scale that combines brightness with a bluesy feel. A laid-back, upbeat sound.",use:"Essential for groovy music like blues, funk, country, and rock 'n' roll. The Beatles used it extensively.",try:"It fits perfectly over a dominant 7th chord (V7). Also, try it over the I7 and IV7 chords in a blues progression.",theory:"Composed of R-2-3-4-5-6-b7. It's the major scale with a b7, making it the fundamental scale for V7 chords."},ja:{vibe:"明るさとブルース感が同居した、陽気でファンキーなスケール。少しルーズで、ご機嫌な響きです。",use:"ブルース、ファンク、カントリー、ロックンロールなど、ノリの良い音楽に欠かせません。ビートルズも多用しました。",try:"ドミナントセブンスコード(V7)に完璧にフィットします。ブルース進行のI7、IV7の上でも使ってみましょう。",theory:"構成音はR-2-3-4-5-6-b7。メジャースケールの7がb7になったスケールで、V7コードの基本となります。"}}},{id:"locrian",categoryEn:"Modes",categoryJa:"モード",scaleEn:"Locrian Scale",scaleJa:"ロクリアンスケール",degrees:["R","b2","b3","4","b5","b6","b7"],intervals:[0,1,3,5,6,8,10],tones:7,heptatonic:!0,comments:{en:{vibe:"The darkest, most unstable mode, with a tension that refuses to resolve. An unsettling sound, like a mystery or horror film.",use:"While it exists in theory, it's rarely used as the main scale for a song. It appears in dissonant heavy metal riffs or for fleeting moments of tension in jazz.",try:"Use this scale sparingly over a IIm7b5 chord in a minor key. It will make the transition to the following V7 more thrilling.",theory:"Composed of R-b2-b3-4-b5-b6-b7. The 7th mode of the major scale. It's highly unstable due to the tritone between the root and the b5."},ja:{vibe:"最も暗く不安定で、解決しない緊張感を持つ響き。ミステリーやホラー映画のような、落ち着かないサウンドです。",use:"理論上は存在するものの、楽曲の主役として使われることは稀。ヘヴィメタルの dissonant なリフや、ジャズで一瞬の緊張感を出すために使われます。",try:"マイナーキーの IIm7b5 コードの上で、このスケールを部分的に使ってみましょう。次の V7 への移行を、よりスリリングに演出できます。",theory:"構成音は R-b2-b3-4-b5-b6-b7。メジャースケールの7番目のモード。ルートからb5がトライトーンを形成するため、非常に不安定です。"}}},{id:"majPent",categoryEn:"Pentatonic & Blues",categoryJa:"ペンタ＆ブルース",scaleEn:"Major Pentatonic",scaleJa:"メジャーペンタトニック",degrees:["R","2","3","5","6"],intervals:[0,2,4,7,9],tones:5,heptatonic:!1,romanException:!0,comments:{en:{vibe:"A bright and somewhat nostalgic sound, reminiscent of Japanese melodies. You can't hit a wrong note, allowing anyone to create pleasant phrases.",use:"Very widely used, from J-Pop vocal melodies and folk songs to country music guitar solos.",try:"Over a major chord in a bright song, just play these five notes without overthinking. You'll naturally create a catchy melody.",theory:"Composed of R-2-3-5-6. It's the major scale with the unstable 4th and 7th degrees removed, resulting in a very stable scale."},ja:{vibe:"明るく、どこか懐かしい日本のメロディ。音を外す心配がなく、誰が弾いても心地よいフレーズが作れます。",use:"J-POPの歌メロ、童謡や民謡、カントリーミュージックのギターソロなど、非常に幅広く使われます。",try:"明るい曲のメジャーコードの上で、何も考えずにこの5音を弾いてみましょう。自然とキャッチーなメロディが生まれます。",theory:"構成音はR-2-3-5-6。メジャースケールから不安定な4度と7度を抜いた、安定感抜群の音階です。"}}},{id:"minPent",categoryEn:"Pentatonic & Blues",categoryJa:"ペンタ＆ブルース",scaleEn:"Minor Pentatonic",scaleJa:"マイナーペンタトニック",degrees:["R","b3","4","5","b7"],intervals:[0,3,5,7,10],tones:5,heptatonic:!1,romanException:!0,comments:{en:{vibe:"The soul of rock and blues. A slightly wild and emotional sound. The first step into improvisation starts here.",use:"Most rock guitar solos are based on this scale. It's also a star player in blues, pop, and funk.",try:"Over a minor or seventh chord, play these five notes in any order. That alone will create a bluesy solo.",theory:"Composed of R-b3-4-5-b7. It's the natural minor scale with the unstable 2nd and b6th degrees removed."},ja:{vibe:"ロックやブルースの魂。少しワイルドで、感情的な響き。アドリブの第一歩はここからです。",use:"ロックのギターソロは、ほとんどがこのスケールがベース。ブルース、ポップス、ファンクでも大活躍します。",try:"マイナーコードやセブンスコードの上で、この5音を自由な順番で弾いてみましょう。それだけでブルージーなソロになります。",theory:"構成音はR-b3-4-5-b7。ナチュラルマイナーから不安定な2度とb6度を抜いた音階です。"}}},{id:"bluesMinor",categoryEn:"Pentatonic & Blues",categoryJa:"ペンタ＆ブルース",scaleEn:"Blues Scale (minor)",scaleJa:"ブルーススケール（マイナー）",degrees:["R","b3","4","b5","5","b7"],intervals:[0,3,5,6,7,10],tones:6,heptatonic:!1,comments:{en:{vibe:'The sound of the blues itself, adding a "blue note" to the minor pentatonic for a sultry, soulful feel. Perfect for creating "crying" phrases.',use:"Used in many genres with roots in Black music, such as blues, rock, jazz, and funk.",try:"Over dominant seventh chords (I7, IV7, V7), use the b5 blue note effectively. It will create emotionally resonant phrases.",theory:"Composed of R-b3-4-b5-5-b7. It's a six-note scale formed by adding a b5 to the minor pentatonic."},ja:{vibe:"マイナーペンタに「ブルーノート」という妖しい響きを加えた、ブルースそのもの。泣きのフレーズが作れます。",use:"ブルース、ロック、ジャズ、ファンクなど、黒人音楽にルーツを持つ多くのジャンルで使われます。",try:"ドミナントセブンスコード(I7, IV7, V7)の上で、b5のブルーノートを効果的に使ってみましょう。感情に訴えるフレーズが生まれます。",theory:"構成音はR-b3-4-b5-5-b7。マイナーペンタにb5の音を追加した6音階です。"}}},{id:"harmonicMinor",categoryEn:"Minor family",categoryJa:"マイナー系",scaleEn:"Harmonic Minor",scaleJa:"ハーモニックマイナー",degrees:["R","2","b3","4","5","b6","7"],intervals:[0,2,3,5,7,8,11],tones:7,heptatonic:!0,comments:{en:{vibe:"Adds a dramatic, passionate tension, reminiscent of classical music, to the melancholy of a minor scale.",use:"A highly distinctive sound frequently used in classical, heavy metal, tango, and gypsy jazz.",try:"Use this scale over the dominant chord (V7) in a minor key to instantly create a passionate and powerful progression.",theory:"Composed of R-2-b3-4-5-b6-7. The key feature is the major 7th, which is a half step higher than in natural minor. It fits perfectly over a V7(b9) chord."},ja:{vibe:"マイナーの哀愁に、クラシック音楽のようなドラマチックで情熱的な緊張感を加えた響きです。",use:"クラシック、ヘヴィメタル、タンゴ、ジプシージャズで多用される、非常に特徴的なサウンドです。",try:"マイナーキーのドミナントコード(V7)の上でこのスケールを使うと、一気に情熱的で力強い展開を作れます。",theory:"構成音はR-2-b3-4-5-b6-7。7度の音がナチュラルマイナーより半音高いのが特徴で、V7(b9)コードにフィットします。"}}},{id:"melodicMinor",categoryEn:"Minor family",categoryJa:"マイナー系",scaleEn:"Melodic Minor",scaleJa:"メロディックマイナー",degrees:["R","2","b3","4","5","6","7"],intervals:[0,2,3,5,7,9,11],tones:7,heptatonic:!0,comments:{en:{vibe:"A smooth and sophisticated sound, despite being minor. It creates particularly beautiful ascending melody lines.",use:"Essential knowledge for jazz improvisation. Also frequently used in modern R&B and fusion.",try:"Use it over the tonic minor chord (Im). It will create an Im(maj7) sound, which is urban and has a floating quality.",theory:"Composed of R-2-b3-4-5-6-7. It's the natural minor scale with a raised 6th and 7th. In jazz, it's often used in this form for both ascending and descending lines."},ja:{vibe:"マイナーでありながら、滑らかで洗練された響き。特に上昇するメロディラインが美しいスケールです。",use:"ジャズのインプロヴィゼーションでは必須の知識。現代的なR&Bやフュージョンでも多用されます。",try:"マイナーキーのトニックコード(Im)の上で使ってみましょう。Im(maj7)という、都会的で浮遊感のある響きを生み出します。",theory:"構成音はR-2-b3-4-5-6-7。ナチュラルマイナーの6度と7度を半音上げた形。ジャズでは下降時もこのまま使うことが多いです。"}}},{id:"dimWholeHalf",categoryEn:"Symmetrical",categoryJa:"対称系",scaleEn:"Diminished Scale (Whole–Half)",scaleJa:"ディミニッシュド（全–半）",degrees:["R","2","b3","4","b5","b6","6","7"],intervals:[0,2,3,5,6,8,9,11],tones:8,heptatonic:!1,comments:{en:{vibe:"A thrilling, mechanical sound with a regular pattern. An intellectual, cool tension, like a puzzle or a spy movie.",use:"The go-to scale for improvising over diminished 7th (dim7) chords in jazz and fusion.",try:"Use it over a passing dim7 chord that connects two other chords. Its regular pattern makes it easy to create fast phrases.",theory:"Composed of R-2-b3-4-b5-b6-6-7. An eight-note (octatonic) scale with an alternating pattern of whole (W) and half (H) steps."},ja:{vibe:"規則正しく音が並ぶ、スリリングで機械的な響き。パズルやスパイ映画のような、知的でクールな緊張感です。",use:"ジャズやフュージョンで、ディミニッシュセブンスコード(dim7)の上でアドリブをする際の定番スケールです。",try:"コードとコードを繋ぐ経過的なdim7コードの上で使ってみましょう。規則的なので、速いフレーズも作りやすいです。",theory:"構成音はR-2-b3-4-b5-b6-6-7。全音(W)と半音(H)が交互に並ぶ8音階(Octatonic)です。"}}},{id:"dimHalfWhole",categoryEn:"Symmetrical",categoryJa:"対称系",scaleEn:"Diminished Scale (Half–Whole)",scaleJa:"ディミニッシュド（半–全）",degrees:["R","b2","b3","3","#4/b5","5","6","b7"],intervals:[0,1,3,4,6,8,9,10],tones:8,heptatonic:!1,comments:{en:{vibe:"Also symmetrical and tense, but sounds more bluesy and funky than its WH counterpart. A cool sound with a hint of heat.",use:"Used over dominant 7th chords in jazz, fusion, and funk. An alternative source of tension to the Altered scale.",try:'Use it over a V7(b9) chord. You can create tense phrases that feel a little more "inside" and cooler than the Altered scale.',theory:"Composed of R-b2-#2-3-#4-5-6-b7. An eight-note (octatonic) scale with an alternating pattern of half (H) and whole (W) steps."},ja:{vibe:"こちらも対称的で緊張感がありますが、WHよりもブルージーでファンキーな響き。クールな中に少し熱さを感じさせます。",use:"ジャズ、フュージョン、ファンクで、ドミナントセブンスコードの上で使われます。Alteredとは違う緊張感の選択肢になります。",try:"V7(b9)コードの上で使ってみましょう。Alteredスケールよりも少しだけ「インサイド」な、クールな緊張感のフレーズが作れます。",theory:"構成音はR-b2-#2-3-#4-5-6-b7。半音(H)と全音(W)が交互に並ぶ8音階(Octatonic)です。"}}},{id:"lydianb7",categoryEn:"Advanced",categoryJa:"高度",scaleEn:"Lydian b7",scaleJa:"リディアン♭7（リディアンドミナント）",aliasEn:["Lydian Dominant"],degrees:["R","2","3","#4","5","6","b7"],intervals:[0,2,4,6,7,9,10],tones:7,heptatonic:!0,comments:{en:{vibe:"A modern, intelligent sound that merges the floating quality of Lydian with the bluesiness of Mixolydian. Like a gifted but quirky student.",use:"A highly sophisticated sound frequently used in modern jazz and fusion, famously by guitarists like Scott Henderson.",try:"Use it over dominant chords that aren't the main V7, such as a IV7 or a bVII7, to create a non-resolving, floating dominant sound.",theory:"Composed of R-2-3-#4-5-6-b7. The 4th mode of the melodic minor scale. Also known as the Lydian Dominant scale."},ja:{vibe:"Lydianの浮遊感とMixolydianのブルース感が融合した、現代的で知的な響き。少しひねくれた優等生のようです。",use:"モダンジャズやフュージョンで多用される、非常に洗練されたサウンド。ギタリストのスコット・ヘンダーソンなどが有名です。",try:"V7以外のドミナントコード、例えばIV7やbVII7の上で使ってみましょう。解決しない、浮遊したままのドミナントサウンドを作れます。",theory:"構成音はR-2-3-#4-5-6-b7。メロディックマイナーの4番目のモード。Lydian Dominantとも呼ばれます。"}}},{id:"mixolydianb6",categoryEn:"Advanced",categoryJa:"高度",scaleEn:"Mixolydian b6",scaleJa:"ミクソリディアン♭6",degrees:["R","2","3","4","5","b6","b7"],intervals:[0,2,4,5,7,8,10],tones:7,heptatonic:!0,comments:{en:{vibe:"A scale that adds a drop of minor-key sorrow to the bluesy Mixolydian. A poignant sound, like a sunset.",use:'Used in blues, jazz, and soul to add depth and a unique "cry" to melodies.',try:"Use it over the V7 chord in a major key blues. The b6 (or b13) note will add a gut-wrenching melancholy to your phrases.",theory:"Composed of R-2-3-4-5-b6-b7. The 5th mode of the melodic minor scale. It fits perfectly over a 7(b13) chord."},ja:{vibe:"ブルージーなMixolydianに、マイナーキーのような哀愁を一滴加えた音階。夕暮れのような、切ない響きです。",use:"ブルースやジャズ、ソウルで、メロディに深みと独特の「泣き」を与えたい時に使われます。",try:"メジャーキーのブルースで、V7コードの上で使ってみましょう。b6(=b13)の音が、フレーズにグッとくる哀愁を加えます。",theory:"構成音はR-2-3-4-5-b6-b7。メロディックマイナーの5番目のモード。7(b13)コードに完璧にフィットします。"}}},{id:"phrygDominant",categoryEn:"Advanced",categoryJa:"高度",scaleEn:"Phrygian Dominant",scaleJa:"フリジアンドミナント",aliasEn:["Spanish Phrygian"],degrees:["R","b2","3","4","5","b6","b7"],intervals:[0,1,4,5,7,8,10],tones:7,heptatonic:!0,comments:{en:{vibe:"Passionate and exotic. A highly dramatic sound reminiscent of Spanish flamenco or a Middle Eastern desert.",use:"Heavily used in gypsy jazz, flamenco, and neoclassical metal. Its strong character instantly grabs the listener's ear.",try:"Play this scale over the dominant chord (V7) in a minor key. For example, using it over an E7 in the key of A minor creates an instant passionate vibe.",theory:"Composed of R-b2-3-4-5-b6-b7. The 5th mode of the harmonic minor scale. It fits perfectly over a V7(b9, b13) chord."},ja:{vibe:"情熱的でエキゾチック。スペインのフラメンコや、中東の砂漠を思わせる、非常にドラマチックな響きです。",use:"ジプシージャズ、フラメンコ、ネオクラシカルメタルで多用されます。聴き手の耳を惹きつける強烈な個性を持っています。",try:"マイナーキーのドミナントコード(V7)の上でこのスケールを弾いてみましょう。AmキーのE7上で弾くと、一気に情熱的な雰囲気になります。",theory:"構成音はR-b2-3-4-5-b6-b7。ハーモニックマイナースケールの5番目のモード。V7(b9, b13)コードに完璧にフィットします。"}}},{id:"altered",categoryEn:"Advanced",categoryJa:"高度",scaleEn:"Altered",scaleJa:"オルタード（スーパー・ロクリアン）",aliasEn:["Super‑Locrian"],degrees:["R","b2","#2","3","b5","b6","b7"],intervals:[0,1,3,4,6,8,10],tones:7,heptatonic:!0,comments:{en:{vibe:'The ultimate tension. A chaotic, thrilling sound, as if a chord is about to break apart. The epitome of an "outside" sound.',use:"The ultimate weapon used over dominant 7th chords in jazz to maximize tension before resolution.",try:"Use it over the V7 in a II-V-I progression. Even the wildest phrases will sound correct when you resolve to the Imaj7.",theory:"Composed of R-b2-b3-3-b5-#5-b7. The 7th mode of the melodic minor scale. It corresponds perfectly with a V7alt chord."},ja:{vibe:"究極の緊張感。コードが崩壊する寸前のような、カオスでスリリングな響き。「アウトサイド」なサウンドの代表格です。",use:"ジャズのドミナントセブンスコード上で、解決前の緊張感を最大にするために使われる最終兵器です。",try:"ジャズのII-V-I進行で、V7の上で使ってみましょう。めちゃくちゃなフレーズを弾いても、次のImaj7に解決すれば全てが正解に聞こえます。",theory:"構成音はR-b2-b3-3-b5-#5-b7。メロディックマイナーの7番目のモード。V7altコードに完全対応します。"}}},{id:"wholeTone",categoryEn:"Advanced",categoryJa:"高度",scaleEn:"Whole‑Tone Scale",scaleJa:"ホールトーンスケール",degrees:["R","2","3","#4","#5","b7"],intervals:[0,2,4,6,8,10],tones:6,heptatonic:!1,comments:{en:{vibe:"A strange, floating sound, like drifting in a dream. An ambiguous and fantastical world with no sense of landing.",use:"Used in impressionistic classical music (like Debussy), flashback scenes in movies, and jazz solos to create a floating effect.",try:"Use it over an augmented (aug) or 7(#5) chord. When used like a sound effect, it can effectively signal a scene change.",theory:"Composed of R-2-3-#4-#5-b7. A six-note symmetrical scale where all intervals are whole tones."},ja:{vibe:"夢の中を漂うような、フワフワした不思議な響き。どこにも着地しない、曖昧で幻想的な世界観です。",use:"ドビュッシーなどの印象派クラシックや、映画の回想シーン、ジャズのソロで浮遊感を出すために使われます。",try:"オーギュメントコード(aug)や7(#5)コードの上で使ってみましょう。効果音のように使うと、場面転換を効果的に演出できます。",theory:"構成音はR-2-3-#4-#5-b7。全ての音程が全音(Whole Tone)で構成された6音階。対称的なスケールです。"}}}];function a(e){return o.find(t=>t.id===e)}function i(e){return o.filter(t=>t.categoryEn===e)}function r(){return Array.from(new Set(o.map(e=>e.categoryEn)))}function s(e,t="en"){return"ja"===t?e.scaleJa:e.scaleEn}function l(e,t="en"){return"ja"===t&&({Basic:"基本",Modes:"モード","Pentatonic & Blues":"ペンタ＆ブルース","Minor family":"マイナー系",Symmetrical:"対称系",Advanced:"高度"})[e]||e}},3894:(e,t,n)=>{n.d(t,{EZ:()=>u,Hl:()=>s,O9:()=>b,Sb:()=>h,T_:()=>o.Mw,jN:()=>c});var o=n(7419);let a={ionian:[0,2,4,5,7,9,11],aeolian:[0,2,3,5,7,8,10]},i={maj:"M",major:"M","":"M",maj7:"M7",M7:"M7",Δ:"M7",Δ7:"M7",maj9:"M9",M9:"M9",Δ9:"M9",maj11:"M11",M11:"M11",maj13:"M13",M13:"M13",min:"m",mi:"m","-":"m",min7:"m7",mi7:"m7","-7":"m7",min9:"m9",mi9:"m9",min11:"m11",mi11:"m11",min13:"m13",mi13:"m13",mM7:"mMaj7",mMaj7:"mMaj7",minMaj7:"mMaj7",dim:"dim","\xb0":"dim",o:"dim",dim7:"dim7","\xb07":"dim7",o7:"dim7",m7b5:"m7b5","m7♭5":"m7b5",ø:"m7b5",ø7:"m7b5",aug:"aug","+":"aug",aug7:"7#5","7#5":"7#5","7+5":"7#5","7♯5":"7#5",sus2:"sus2",sus4:"sus4",sus:"sus4","7sus4":"7sus4","7sus":"7sus4",6:"6",m6:"m6",min6:"m6","6/9":"6/9",69:"6/9","7b5":"7b5","7♭5":"7b5","7-5":"7b5","7b9":"7b9","7♭9":"7b9","7-9":"7b9","7#9":"7#9","7♯9":"7#9","7+9":"7#9","7b13":"7b13","7♭13":"7b13","7#11":"7#11","7♯11":"7#11","7(9)":"9","7(11)":"11","7(13)":"13","m7(9)":"m9","m7(11)":"m11","M7(9)":"M9","M7(13)":"M13","7alt":"7alt","7altered":"7alt"},r={M:[0,4,7],m:[0,3,7],aug:[0,4,8],dim:[0,3,6],sus2:[0,2,7],sus4:[0,5,7],6:[0,4,7,9],m6:[0,3,7,9],"6/9":[0,4,7,9,14],7:[0,4,7,10],M7:[0,4,7,11],m7:[0,3,7,10],dim7:[0,3,6,9],m7b5:[0,3,6,10],mMaj7:[0,3,7,11],9:[0,4,7,10,14],M9:[0,4,7,11,14],m9:[0,3,7,10,14],add9:[0,4,7,14],madd9:[0,3,7,14],11:[0,4,7,10,14,17],M11:[0,4,7,11,14,17],m11:[0,3,7,10,14,17],13:[0,4,7,10,14,21],M13:[0,4,7,11,14,21],m13:[0,3,7,10,14,21],"7sus4":[0,5,7,10],"7b5":[0,4,6,10],"7#5":[0,4,8,10],"7b9":[0,4,7,10,13],"7#9":[0,4,7,10,15],"7#11":[0,4,7,10,18],"7b13":[0,4,7,10,20],"7alt":[0,4,7,10,13,15,18]},s=e=>{let t=o.Mw.indexOf(e);if(t>=0)return t;let n={Db:"C#",Gb:"F#",Ab:"G#",Bb:"A#",Eb:"D#",Cb:"B",Fb:"E"}[e]??e;return o.Mw.indexOf(n)},l=(e,t)=>(e+t+12)%12;function c(e){var t;let n=e.split("/"),o=n[0].match(/^([A-G](#|b)?)(.*)$/);if(!o)throw Error("bad chord: "+e);let a=s(o[1]),c=i[t=(o[3]||"").trim()||"M"]??t,d=(r[c]??r.M).map(e=>l(a,e%12));return{root:a,qual:c,bass:n[1]?s(n[1]):void 0,tones:d}}let d={0:["M","M7"],2:["m","m7"],4:["m","m7"],5:["M","M7"],7:["M","7"],9:["m","m7"],11:["dim","m7b5"]},m={0:["m","m7"],2:["dim","m7b5"],3:["M","M7"],5:["m","m7"],7:["m","7","M","7"],8:["M","M7"],10:["M","7"]};function u(e){let t=e.map(c),n=[];for(let e=0;e<12;e++)n.push({root:e,mode:"Major"},{root:e,mode:"Minor"});let i=3*t.length+3;return n.map(({root:e,mode:n})=>{let r="Major"===n?d:m,s=0;t.forEach((o,i)=>{let l=(o.root-e+12)%12,c=r[l];if(c)c.includes(o.qual)?s+=3:s+=2;else{let t="Major"===n?a.ionian:a.aeolian;o.tones.every(n=>t.includes((n-e+12)%12))&&(s+=1)}i>0&&((t[i-1].root-e+12)%12-l+12)%12==7&&(s+=1)});let l=(t[0].root-e+12)%12;"Major"===n&&(0===l||9===l)&&(s+=2),"Minor"===n&&(0===l||3===l)&&(s+=2);let c=Math.round(s/Math.max(i,1)*100),u=`${o.Mw[e]} ${n}`;return{keyRoot:e,mode:n,label:u,score:s,pct:c}}).sort((e,t)=>t.score-e.score)}function h(e){return u(e).slice(0,5).map(t=>{let n=function(e,t){if(e.length<2)return null;let n=c(e[e.length-1]),o=c(e[e.length-2]),a=(n.root-t.tonic+12)%12,i=(o.root-t.tonic+12)%12;return 7===i&&0===a?"perfect":7===i&&9===a?"deceptive":7===a?"half":null}(e,{tonic:t.keyRoot,mode:t.mode}),o=[];return"perfect"===n&&o.push("Cadence: V→I"),"deceptive"===n&&o.push("Cadence: V→vi"),"half"===n&&o.push("Cadence: …→V"),o.unshift(`diatonic fit ${t.pct}%`),{tonic:t.keyRoot,mode:t.mode,confidence:t.pct,reasons:o}})}let f={Ⅰ:{offset:0},ⅰ:{offset:0},Ⅱ:{offset:2},ⅱ:{offset:2},"♭Ⅱ":{offset:1},"♭ⅱ":{offset:1},Ⅲ:{offset:4},ⅲ:{offset:4},"♭Ⅲ":{offset:3},"♭ⅲ":{offset:3},Ⅳ:{offset:5},ⅳ:{offset:5},"♯Ⅳ":{offset:6},"♯ⅳ":{offset:6},Ⅴ:{offset:7},ⅴ:{offset:7},"♭Ⅵ":{offset:8},"♭ⅵ":{offset:8},Ⅵ:{offset:9},ⅵ:{offset:9},"♭Ⅶ":{offset:10},"♭ⅶ":{offset:10},Ⅶ:{offset:11},ⅶ:{offset:11}};function b(e,t,n){var o;let{deg:a,explicitQual:i}=function(e){for(let[t,{offset:n}]of Object.entries(f))if(e.startsWith(t))return{deg:n,explicitQual:e.slice(t.length).trim()||null};return console.warn(`Unknown Roman numeral: ${e}`),{deg:0,explicitQual:null}}(e),r=null!==i?i:function(e,t){let n=("Major"===t?d:m)[e];return n&&0!==n.length?n[0]:""}(a,n),s=(o=(t+a)%12,void 0===t?["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"][o]:[7,2,9,4,11,6,1].includes(t)?["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][o]:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"][o]);return`${s}${r}`}},920:(e,t,n)=>{function o({tonicPc:e,scaleIntervals:t}){let n=t.map(t=>(e+t+120)%12),o=[];for(let e=0;e<7;e++){let t=e%7,a=n[t],i=n[(t+2)%7],r=n[(t+4)%7],s=function(e,t,n){let o=(t-e+12)%12,a=(n-e+12)%12;return 4===o&&7===a?"maj":3===o&&7===a?"min":3===o&&6===a?"dim":4===o&&8===a?"aug":6===a?"dim":8===a?"aug":o<4?"min":"maj"}(a,i,r);o.push({degree:e+1,rootPc:a,pcs:[a,i,r],quality:s})}return o}n.d(t,{Qy:()=>i,Xs:()=>s,Z:()=>o});let a=["I","II","III","IV","V","VI","VII"];function i(e,t,n){let o=a[e-1];return"upper"===(n?.case??"upper")?"dim"===t?o+"\xb0":"aug"===t?o+"+":o:"min"===t?o.toLowerCase():"dim"===t?o.toLowerCase()+"\xb0":"aug"===t?o+"+":o}let r=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"];function s(e){let t=r[e.rootPc%12];return"maj"===e.quality?t:"min"===e.quality?t+"m":"dim"===e.quality?t+"dim":t+"+"}},2534:(e,t,n)=>{n.d(t,{_:()=>h});var o=n(8408),a=n(3894),i=n(3934);let r=["Ionian","Lydian","Mixolydian","MajorPentatonic"],s=["Aeolian","Dorian","Phrygian","HarmonicMinor","MelodicMinor","MinorPentatonic"];function l(e,t){let n="Major"===t.mode?r:s,o=Array.from(new Set(e.flatMap(e=>{let t=(0,a.jN)(e),n=t.qual.includes("m")?3:4,o=t.qual.includes("7")?t.qual.includes("M7")?11:10:null,i=[t.root%12,(t.root+n)%12,(t.root+7)%12];return null!==o&&i.push((t.root+o)%12),i}))),l=e.some(e=>/7\b/.test(e));return n.map(e=>{let n=(0,i.Rq)(t.root,e),a=o.filter(e=>n.includes(e)).length/Math.max(1,o.length),r=0;"Major"===t.mode&&"Ionian"===e&&(r+=.02),"Minor"===t.mode&&"Aeolian"===e&&(r+=.02),l&&("HarmonicMinor"===e||"MelodicMinor"===e)&&(r+=.03);let s=Math.min(1,a+r);return{root:t.root,type:e,score:Math.round(100*s)}}).sort((e,t)=>t.score-e.score)}let c=["I","II","III","IV","V","VI","VII"];function d(e,t,n){return e.map(e=>(function(e,t,n){let{root:o,qual:r}=(0,a.jN)(e),s=(0,i.nZ)(n)??n,l=(0,i.Ue)(o,t,s),d=l?.startsWith("♭")?"♭":l?.startsWith("#")?"♯":"";if(!l){let e=(0,i.Rq)(t,s),n=(o+12-1)%12,a=(o+1)%12,r=e.indexOf(n),c=e.indexOf(a);-1!==r?(l=(0,i.Ue)(n,t,s),d="♭"):-1!==c&&(l=(0,i.Ue)(a,t,s),d="♯")}let m=function(e){if(!e)return"I";let t=Number(e.replace(/[♭#]/g,""));return c[isFinite(t)?Math.max(1,Math.min(7,t))-1:0]}(l),u=/dim|o/.test(r)?"\xb0":"",h=/7/.test(r)?"7":"";return`${d}${m}${u}${h}`})(e,t,n))}var m=n(920),u=n(6178);let h=(0,o.U)((e,t)=>({keyCandidates:[],capo:null,viewMode:"sounding",scaleCandidates:[],selectedScale:null,romanTokens:[],romanText:"",diatonic:null,recommendedCapos:[],analyze:t=>{e(e=>{let n=(0,a.Sb)(t),o=n[0],r=e.selectedKey&&n.find(t=>t.tonic===e.selectedKey.tonic&&t.mode===e.selectedKey.mode),s=r&&o&&4>Math.abs((r.confidence||0)-(o.confidence||0))&&e.selectedKey?e.selectedKey:o?{tonic:o.tonic,mode:o.mode}:void 0,c=s?l(t,{root:s.tonic,mode:s.mode}):[],h=c[0]??null,f=s&&h?d(t,s.tonic,h.type):[],b=(()=>{if(!s||!h)return null;let e=s.tonic,t=h.type,n=i.vb[t]??[];if(n.length<7){let e=(0,i.nZ)(t);e&&(t=e,n=i.vb[e]??[])}if(!n.length)return null;let o=(0,m.Z)({tonicPc:e,scaleIntervals:n}),a=o.map(e=>(0,m.Qy)(e.degree,e.quality,{case:"upper"}));return{triads:o,romans:a}})(),p=s&&h?(0,u.Uv)({tonic:s.tonic,mode:s.mode},{type:h.type},3,{includeOpen:!1}):[];return{keyCandidates:n,selectedKey:s,scaleCandidates:c,selectedScale:h,lastProg:t,romanTokens:f,romanText:f.join(" – "),diatonic:b,recommendedCapos:p}})},selectKey:t=>e(e=>{let n=e.lastProg??[],o=l(n,{root:t.tonic,mode:t.mode}),a=o[0]??null,r=a?d(n,t.tonic,a.type):[],s=(()=>{if(!a)return null;let e=a.type,n=i.vb[e]??[];if(n.length<7){let t=(0,i.nZ)(e);t&&(e=t,n=i.vb[t]??[])}if(!n.length)return null;let o=(0,m.Z)({tonicPc:t.tonic,scaleIntervals:n}),r=o.map(e=>(0,m.Qy)(e.degree,e.quality,{case:"upper"}));return{triads:o,romans:r}})(),c=a?(0,u.Uv)({tonic:t.tonic,mode:t.mode},{type:a.type},3,{includeOpen:!1}):[];return{selectedKey:t,scaleCandidates:o,selectedScale:a,romanTokens:r,romanText:r.join(" – "),diatonic:s,recommendedCapos:c}}),selectScale:t=>e(e=>{let n=e.lastProg??[],o=e.selectedKey,a=n.length&&o?d(n,o.tonic,t.type):[],r=(()=>{if(!o)return null;let e=t.type,n=i.vb[e]??[];if(n.length<7){let t=(0,i.nZ)(e);t&&(e=t,n=i.vb[t]??[])}if(!n.length)return null;let a=(0,m.Z)({tonicPc:o.tonic,scaleIntervals:n}),r=a.map(e=>(0,m.Qy)(e.degree,e.quality,{case:"upper"}));return{triads:a,romans:r}})(),s=o?(0,u.Uv)({tonic:o.tonic,mode:o.mode},{type:t.type},3,{includeOpen:!1}):[];return{selectedScale:t,romanTokens:a,romanText:a.join(" – "),diatonic:r,recommendedCapos:s}}),chooseCapo:t=>e({capo:{capo:t.capo,shapedKey:t.shapedKey}}),setViewMode:t=>e({viewMode:t}),reset:()=>e({keyCandidates:[],selectedKey:void 0,analysis:void 0,capo:null,viewMode:"sounding",scaleCandidates:[],selectedScale:null,lastProg:[]})}))}};
module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},61724,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js"))},23124,(e,t,r)=>{},26794,e=>{"use strict";e.s(["handler",()=>q,"patchFetch",()=>T,"routeModule",()=>S,"serverHooks",()=>H,"workAsyncStorage",()=>k,"workUnitAsyncStorage",()=>j],26794);var t=e.i(47909),r=e.i(74017),n=e.i(96250),a=e.i(59756),o=e.i(61916),s=e.i(69741),i=e.i(16795),l=e.i(87718),u=e.i(95169),d=e.i(47587),c=e.i(66012),p=e.i(70101),m=e.i(26937),h=e.i(10372),x=e.i(93695);e.i(52474);var y=e.i(220);e.s(["POST",()=>O,"runtime",()=>v],61312);var f=e.i(89171);let v="nodejs",R=Number(process.env.CONF_THRESHOLD_LOW??.58),g=Number(process.env.CONF_THRESHOLD_HIGH??.85),N=Number(process.env.CONF_LEN_GAIN??.03),b=Number(process.env.CONF_SNR_GAIN??.03),E=Number(process.env.CONF_SNR_PENALTY??.08),w=[0,2,4,5,7,9,11],_=[0,2,3,5,7,8,10];function C(e,t){return e.map(e=>(e+t)%12)}function A(e,t={}){try{fetch("/api/telemetry",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({event:e,...t})}).catch(()=>{})}catch{}}async function O(e){try{let t=await e.json(),r=function(e){if(!Array.isArray(e)||12!==e.length)return null;let t=e.map(e=>Number.isFinite(e)?Math.max(0,Number(e)):NaN);if(t.some(e=>!Number.isFinite(e)))return null;let r=t.reduce((e,t)=>e+t,0);if(r<=0)return null;let n=t.map(e=>e/r);return n.some(e=>!Number.isFinite(e))?null:n}(t?.pcp12);if(!r)return A("audio_analyze_err",{code:"pcp12_invalid",status:400}),f.NextResponse.json({error:"pcp12_invalid"},{status:400});let n=function(e){let t=t=>t.reduce((t,r)=>t+e[r],0);return[...Array.from({length:12},(e,r)=>({keyPc:r,mode:"major",score:t(C(w,r))})),...Array.from({length:12},(e,r)=>({keyPc:r,mode:"minor",score:t(C(_,r))}))].sort((e,t)=>t.score-e.score).slice(0,3)}(r),{conf:a,level:o,candidates:s}=function(e,t){let r=e[0]?.score??0,n=e[1]?.score??0,a=r+n+(e[2]?.score??0);if(!Number.isFinite(a)||a<=0)return{conf:0,level:"low",candidates:e.map(e=>({keyPc:e.keyPc,mode:e.mode,confidence:0}))};let o=r/a;"number"==typeof t?.lengthSec&&t.lengthSec>=6&&t.lengthSec<=14&&(o+=N),"number"==typeof t?.snrHint&&(t.snrHint>18?o+=b:t.snrHint<8&&(o-=E));let s=(o=Math.max(0,Math.min(1,Number.isFinite(o)?o:0)))<R?"low":o>=g?"high":"mid";return{conf:o,level:s,candidates:e.map(e=>({keyPc:e.keyPc,mode:e.mode,confidence:a>0?e.score/a:0}))}}(n,{lengthSec:t?.lengthSec,snrHint:t?.snrHint});A("audio_analyze_ok",{n:r.length}),A("audio_analyze_conf",{level:o,conf:a});let i={keyCandidates:s,conf:a,pcp12:r,...a<R?{advice:function(e,t){let r=[];return r.push("Low signal quality. Try recording again in a quieter room for 4â€“12s. Record at least ~4 seconds."),"number"==typeof e&&e<8&&r.push("Avoid background noise and bring the instrument closer to the mic."),r.join(" ")}(t?.snrHint,t?.lengthSec)}:{}};return f.NextResponse.json(i,{status:200})}catch(e){return A("audio_analyze_err",{code:"analyze_failed",status:500}),f.NextResponse.json({error:"analyze_failed"},{status:500})}}var P=e.i(61312);let S=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/analyze/route",pathname:"/api/analyze",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/analyze/route.ts",nextConfigOutput:"",userland:P}),{workAsyncStorage:k,workUnitAsyncStorage:j,serverHooks:H}=S;function T(){return(0,n.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:j})}async function q(e,t,n){var f;let v="/api/analyze/route";v=v.replace(/\/index$/,"")||"/";let R=await S.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:g,params:N,nextConfig:b,isDraftMode:E,prerenderManifest:w,routerServerContext:_,isOnDemandRevalidate:C,revalidateOnlyGenerated:A,resolvedPathname:O}=R,P=(0,s.normalizeAppPath)(v),k=!!(w.dynamicRoutes[P]||w.routes[O]);if(k&&!E){let e=!!w.routes[O],t=w.dynamicRoutes[P];if(t&&!1===t.fallback&&!e)throw new x.NoFallbackError}let j=null;!k||S.isDev||E||(j="/index"===(j=O)?"/":j);let H=!0===S.isDev||!k,T=k&&!H,q=e.method||"GET",F=(0,o.getTracer)(),I=F.getActiveScopeSpan(),M={params:N,prerenderManifest:w,renderOpts:{experimental:{cacheComponents:!!b.experimental.cacheComponents,authInterrupts:!!b.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(f=b.experimental)?void 0:f.cacheLife,isRevalidate:T,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>S.onRequestError(e,t,n,_)},sharedContext:{buildId:g}},U=new i.NodeNextRequest(e),D=new i.NodeNextResponse(t),z=l.NextRequestAdapter.fromNodeNextRequest(U,(0,l.signalFromNodeResponse)(t));try{let s=async r=>S.handle(z,M).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=F.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=n.get("next.route");if(a){let e=`${q} ${a}`;r.setAttributes({"next.route":a,"http.route":a,"next.span_name":e}),r.updateName(e)}else r.updateName(`${q} ${e.url}`)}),i=async o=>{var i,l;let u=async({previousCacheEntry:r})=>{try{if(!(0,a.getRequestMeta)(e,"minimalMode")&&C&&A&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(o);e.fetchMetrics=M.renderOpts.fetchMetrics;let l=M.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=M.renderOpts.collectedTags;if(!k)return await (0,c.sendResponse)(U,D,i,M.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,p.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[h.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,n=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await S.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:T,isOnDemandRevalidate:C})},_),t}},x=await S.handleResponse({req:e,nextConfig:b,cacheKey:j,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:w,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:A,responseGenerator:u,waitUntil:n.waitUntil});if(!k)return null;if((null==x||null==(i=x.value)?void 0:i.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==x||null==(l=x.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,a.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",C?"REVALIDATED":x.isMiss?"MISS":x.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,p.fromNodeOutgoingHttpHeaders)(x.value.headers);return(0,a.getRequestMeta)(e,"minimalMode")&&k||f.delete(h.NEXT_CACHE_TAGS_HEADER),!x.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,m.getCacheControlHeader)(x.cacheControl)),await (0,c.sendResponse)(U,D,new Response(x.value.body,{headers:f,status:x.value.status||200})),null};I?await i(I):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${q} ${e.url}`,kind:o.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},i))}catch(t){if(I||t instanceof x.NoFallbackError||await S.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:T,isOnDemandRevalidate:C})}),k)throw t;return await (0,c.sendResponse)(U,D,new Response(null,{status:500})),null}}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__be30f1fe._.js.map
{"version":3,"sources":["turbopack:///[project]/src/components/AdSlot.client.tsx","turbopack:///[project]/src/components/ui/InfoDot.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { track } from \"@/lib/telemetry\";\nimport { usePro } from \"@/components/ProProvider\";\n\ninterface AdSlotProps {\n  page: string;\n  slot?: string; // AdSense広告スロットID（オプション）\n  format?: \"auto\" | \"rectangle\" | \"horizontal\" | \"vertical\";\n  style?: React.CSSProperties;\n}\n\nexport default function AdSlot({ \n  page, \n  slot = \"XXXXXXXXXX\", // デフォルトの広告スロットID\n  format = \"auto\",\n  style = {}\n}: AdSlotProps) {\n  const { isPro } = usePro();\n  const [mounted, setMounted] = useState(false);\n  const [adLoaded, setAdLoaded] = useState(false);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  useEffect(() => {\n    if (!mounted || isPro) return;\n\n    // AdSenseの広告をロード\n    try {\n      // @ts-ignore\n      if (window.adsbygoogle && !adLoaded) {\n        // @ts-ignore\n        (window.adsbygoogle = window.adsbygoogle || []).push({});\n        setAdLoaded(true);\n        track(\"ad_shown\", { page });\n      }\n    } catch (error) {\n      console.error(\"AdSense load error:\", error);\n    }\n  }, [mounted, isPro, page, adLoaded]);\n\n  if (isPro) {\n    return null;\n  }\n\n  return (\n    <div \n      style={{ minHeight: 110, ...style }} \n      aria-label=\"Advertisement\"\n      className=\"ad-container\"\n    >\n      {mounted ? (\n        <ins\n          className=\"adsbygoogle\"\n          style={{ display: \"block\", ...style }}\n          data-ad-client=\"ca-pub-9662479821167655\"\n          data-ad-slot={slot}\n          data-ad-format={format}\n          data-full-width-responsive=\"true\"\n        />\n      ) : null}\n    </div>\n  );\n}\n","\"use client\";\nimport { useEffect, useRef, useState, useLayoutEffect, type ReactNode } from \"react\";\nimport { createPortal } from \"react-dom\";\n\ntype Props = {\n  text?: string;                    // plain text (optional when using children)\n  title?: string;                   // optional title in the card\n  children?: ReactNode;             // custom body content\n  className?: string;\n  linkHref?: string;\n  linkLabel?: string;\n  ariaLabel?: string;\n  icon?: 'info' | 'graduation';    // icon type\n};\n\nexport default function InfoDot({\n  text,\n  title,\n  children,\n  className = \"\",\n  linkHref,\n  linkLabel = \"Learn more\",\n  ariaLabel = \"More info\",\n  icon = 'info',\n}: Props) {\n  const [open, setOpen] = useState(false);\n  const ref = useRef<HTMLDivElement>(null);\n  const btnRef = useRef<HTMLButtonElement>(null);\n  const [coords, setCoords] = useState<{left:number; top:number; maxW:number}>({left:0, top:0, maxW:320});\n  useEffect(() => {\n    const onDoc = (e: MouseEvent) => {\n      if (ref.current && !ref.current.contains(e.target as Node)) setOpen(false);\n    };\n    const onEsc = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") setOpen(false);\n    };\n    document.addEventListener(\"click\", onDoc);\n    document.addEventListener(\"keydown\", onEsc);\n    return () => {\n      document.removeEventListener(\"click\", onDoc);\n      document.removeEventListener(\"keydown\", onEsc);\n    };\n  }, []);\n  useLayoutEffect(() => {\n    if (!open) return;\n    const update = () => {\n      if (!btnRef.current) return;\n      const r = btnRef.current.getBoundingClientRect();\n      const maxW = Math.min(Math.floor(window.innerWidth * 0.9), 360);\n      const left = Math.min(window.innerWidth - 8 - maxW, Math.max(8, Math.round(r.right - maxW)));\n      const top = Math.min(window.innerHeight - 8 - 120, Math.round(r.bottom + 6));\n      setCoords({ left, top, maxW });\n    };\n    update();\n    window.addEventListener(\"resize\", update);\n    window.addEventListener(\"scroll\", update, true);\n    return () => {\n      window.removeEventListener(\"resize\", update);\n      window.removeEventListener(\"scroll\", update, true);\n    };\n  }, [open]);\n\n  return (\n    <div ref={ref} className={`relative inline-flex items-center ${className}`}>\n      <button ref={btnRef} type=\"button\" className=\"info-dot\" aria-label={ariaLabel} onClick={() => setOpen((o) => !o)}>\n        {icon === 'graduation' ? (\n          <svg className=\"w-3 h-3\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z\"/>\n          </svg>\n        ) : (\n          'i'\n        )}\n      </button>\n      {open && createPortal(\n        (\n          <div\n            role=\"dialog\"\n            className=\"info-card\"\n            style={{\n              position: \"fixed\",\n              zIndex: 60,\n              left: `${coords.left}px`,\n              top: `${coords.top}px`,\n              maxWidth: `${coords.maxW}px`,\n            }}\n          >\n            {title && <div className=\"font-medium mb-1\">{title}</div>}\n            {children ? (\n              children\n            ) : (\n              (text ?? \"\").split(\"\\n\").map((line, i) => <div key={i}>{line}</div>)\n            )}\n            {linkHref && (\n              <div className=\"mt-2 text-right\">\n                <a href={linkHref} className=\"underline text-[12px] opacity-80\">\n                  {linkLabel}\n                </a>\n              </div>\n            )}\n          </div>\n        ),\n        document.body\n      )}\n    </div>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}
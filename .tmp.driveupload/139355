module.exports=[13332,a=>{"use strict";a.s(["default",()=>aY],13332);var b=a.i(87924),c=a.i(72131),d=a.i(34747),e=a.i(21482),f=a.i(14511),g=a.i(13512),h=a.i(1731),h=h,i=a.i(58078),j=a.i(32653),k=a.i(46617),h=h;let l={0:0,2:1,4:2,5:3,7:4,9:5,11:6},m={0:0,2:1,3:2,5:3,7:4,8:5,10:6},n=["I","ii","iii","IV","V","vi","vii°"],o=["i","ii°","III","iv","v","VI","VII"];function p(a){return/maj7|M7/.test(a)}function q(a,b,c,d={}){let{showQuality:e=!0,accidentalsForNonDiatonic:f=!1}=d;if(!a||!b)return"";let i=(0,g.noteToPc)(b),j=a.split("/")[0].match(/^([A-G](?:#|b)?)(.*)$/i);if(!j)return a;let k=function(a){let b=(0,g.noteToPc)(a);return h.PC_NAMES[b]??a}(j[1].toUpperCase()),r=j[2]||"",s=((0,g.noteToPc)(k)-i+12)%12,t="major"===c?n:o,u=("major"===c?l:m)[s];if(void 0!==u){let a=d.uppercase?["I","II","III","IV","V","VI","VII"][u]:t[u];return(d.uppercase&&("major"===c&&6===u||"minor"===c&&1===u)&&(a+="°"),e)?p(r)?a+"M7":!(p(r)||/m7b5|ø|dim7/.test(r))&&(/(\b|[^a-zA-Z])7(?![b#0-9])/i.test(r)||/\bm7\b/i.test(r))?a+"7":a:a}if(f){let a="major"===c?[0,2,4,5,7,9,11]:[0,2,3,5,7,8,10];for(let b=0;b<a.length;b++){let c=a[b];if((c+1)%12===s)return"#"+t[b];if((c+11)%12===s)return"b"+t[b]}}return`(${k})`}var r=a.i(6164),s=a.i(55147);function t({children:a,className:c="",right:d,as:e="h2"}){return(0,b.jsxs)("div",{className:`mb-2 flex items-center gap-2 ${c}`,children:[(0,b.jsx)(e,{className:"text-xl md:text-2xl font-semibold tracking-tight text-foreground",children:a}),d?(0,b.jsx)("div",{className:"ml-auto",children:d}):null]})}function u({children:a,className:c="",right:d,as:e="h3"}){return(0,b.jsxs)("div",{className:`mb-1.5 flex items-center gap-2 ${c}`,children:[(0,b.jsx)(e,{className:"text-sm md:text-base font-semibold tracking-wide text-foreground",children:a}),d?(0,b.jsx)("div",{className:"ml-auto text-xs md:text-sm text-muted-foreground",children:d}):null]})}var v=a.i(10516);let w=["6","m6","9","m9","11","M11","13","M13","7b5","7#5","7b9","7#9","7#11","7b13","7alt","dim7","m7b5","sus2","add9","add11","add13","6/9","aug","mM7","/bass"];var x=a.i(67010),y=a.i(79735);let z=[{id:"doo-wop",name:"Doo‑Wop (I–vi–IV–V)",mode:"major",seq:["I","vi","IV","V"],summary:"50s/60s loop: I→vi→IV→V back to I."},{id:"axis",name:"Axis (I–V–vi–IV)",mode:"major",seq:["I","V","vi","IV"],summary:"Modern pop four‑chords loop."},{id:"canon",name:"Pachelbel's Canon",mode:"major",seq:["I","V","vi","iii","IV","I","IV","V"],variants:[["I","V","vi","IV"]],summary:"Pachelbel‑style ground; long loop back to I."},{id:"ii-V-I",name:"ii–V–I",mode:"any",seq:["ii","V","I"],summary:"The classic resolution run‑up."},{id:"turnaround",name:"Turnaround (I–vi–ii–V)",mode:"any",seq:["I","vi","ii","V"],summary:"Quick loop returning to the top."},{id:"andalusian",name:"Andalusian (i–VII–VI–V)",mode:"minor",seq:["i","VII","VI","V"],summary:"Classic minor descent; flamenco/Latin flavor."},{id:"authentic",name:"Authentic cadence (V–I)",mode:"any",seq:["V","I"],summary:"Perfect cadence V→I."},{id:"plagal",name:"Plagal cadence (IV–I)",mode:"any",seq:["IV","I"],summary:"Gentle IV→I resolution."},{id:"deceptive",name:"Deceptive cadence (V–vi)",mode:"major",seq:["V","vi"],summary:"Deceptive V→vi keeps motion going."}],A={dooWop:"Doo‑Wop (I–VI–IV–V)",axis:"Axis (I–V–vi–IV)",canon:"Canon (I–V–vi–iii–IV–I–IV–V)",twoFiveOne:"ii–V–I",turnaround:"Turnaround",andalusian:"Andalusian cadence",authentic:"Perfect cadence (V → I)",plagal:"Plagal cadence (IV → I)",deceptive:"Deceptive cadence (V → vi)"},B={dooWop:"’50s progression. Nostalgic loop: tonic → relative minor → subdominant → dominant. Try adding 7ths for color.",axis:"Modern pop staple. A catchy loop that feels forward yet stable. Swap to ii–V at the end for a stronger landing.",canon:"Pachelbel‑style ground. Persistent bass motion with rotating functions; great for variations and melodies.",twoFiveOne:"The classic run‑up then land. Link by guide tones (3rd↔7th). Works anywhere you want a clear resolution.",turnaround:"Short cycle that brings you back to the top (e.g., I–VI7–ii7–V7). Use at phrase ends or between sections.",andalusian:"Descending minor flavor (e.g., i–♭VII–♭VI–V). Adds drama; land clearly on the target chord.",authentic:"Strong homecoming: dominant pulls into tonic. Extend V with 7/9/13; keep the landing clean on I.",plagal:"Gentler IV → I resolution. Use to soften endings or after a bright Lydian moment.",deceptive:"Twist the expectation: V → vi instead of I. Keeps energy moving; return to I later for closure."};function C(a){return(a||"").toString().trim().toUpperCase().replace(/MAJ7|M7|7|MAJ|MIN|MI|DIM|AUG|SUS\d?|ADD\d+|Ø|O/g,"").replace(/\(|\)/g,"").replace(/[^IVB#]+/g,"").replace(/B/g,"B")}var D=a.i(47473);let E="ot_sketches",F=()=>JSON.parse(localStorage.getItem(E)||"[]"),G=a=>{let b=F().filter(b=>b.id!==a.id);return(b.unshift(a),b.length>3)?(localStorage.setItem(E,JSON.stringify(b.slice(0,3))),{ok:!1,reason:"limit_exceeded"}):(localStorage.setItem(E,JSON.stringify(b)),{ok:!0})},H=async a=>({ok:!0});var I=a.i(58037),J=a.i(20226);let K=()=>Math.random().toString(36).substr(2,9),L=(0,J.create)((a,b)=>({sketches:[],currentSketch:null,isLoading:!1,error:null,loadSketches:()=>{a({isLoading:!0,error:null});try{let b=F();a({sketches:b,isLoading:!1})}catch(b){a({error:"Failed to load sketches",isLoading:!1})}},saveSketch:async b=>{let c={...b,id:K(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(G(c).ok)return a({sketches:F(),currentSketch:c}),{ok:!0};try{await H(c);let b=F();return a({sketches:b,currentSketch:c}),{ok:!0}}catch(a){return{ok:!1,reason:"cloud_save_failed"}}},loadSketch:c=>{let d=b().sketches.find(a=>a.id===c);d&&a({currentSketch:d})},deleteSketch:c=>{let d=b().sketches.filter(a=>a.id!==c);localStorage.setItem("ot_sketches",JSON.stringify(d)),a({sketches:d}),b().currentSketch?.id===c&&a({currentSketch:null})},duplicateSketch:c=>{let d=b().sketches.find(a=>a.id===c);if(d){let b={...d,id:K(),name:`${d.name} Copy`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};G(b).ok&&a({sketches:F(),currentSketch:b})}},renameSketch:(c,d)=>{let e=b().sketches.map(a=>a.id===c?{...a,name:d,updatedAt:new Date().toISOString()}:a);localStorage.setItem("ot_sketches",JSON.stringify(e)),a({sketches:e}),b().currentSketch?.id===c&&a({currentSketch:{...b().currentSketch,name:d,updatedAt:new Date().toISOString()}})},startAutoSave:c=>setTimeout(()=>{let d=b();if(d.currentSketch?.id===c.id){let b={...c,updatedAt:new Date().toISOString()};G(b).ok&&a({sketches:F(),currentSketch:b})}},3e3),stopAutoSave:()=>{}})),M=(()=>{let a=0;return()=>(a+=1,`u${`0000${(1679616*Math.random()|0).toString(36)}`.slice(-4)}${a}`)})();function N(a){let b=[];for(let c=0,d=a.length;c<d;c++)b.push(a[c]);return b}let O=null;function P(a={}){return O||(O=a.includeStyleProperties?a.includeStyleProperties:N(window.getComputedStyle(document.documentElement)))}function Q(a,b){let c=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b);return c?parseFloat(c.replace("px","")):0}function R(a,b={}){return{width:b.width||function(a){let b=Q(a,"border-left-width"),c=Q(a,"border-right-width");return a.clientWidth+b+c}(a),height:b.height||function(a){let b=Q(a,"border-top-width"),c=Q(a,"border-bottom-width");return a.clientHeight+b+c}(a)}}function S(a){return new Promise((b,c)=>{let d=new Image;d.onload=()=>{d.decode().then(()=>{requestAnimationFrame(()=>b(d))})},d.onerror=c,d.crossOrigin="anonymous",d.decoding="async",d.src=a})}async function T(a){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(a)).then(encodeURIComponent).then(a=>`data:image/svg+xml;charset=utf-8,${a}`)}async function U(a,b,c){let d="http://www.w3.org/2000/svg",e=document.createElementNS(d,"svg"),f=document.createElementNS(d,"foreignObject");return e.setAttribute("width",`${b}`),e.setAttribute("height",`${c}`),e.setAttribute("viewBox",`0 0 ${b} ${c}`),f.setAttribute("width","100%"),f.setAttribute("height","100%"),f.setAttribute("x","0"),f.setAttribute("y","0"),f.setAttribute("externalResourcesRequired","true"),e.appendChild(f),f.appendChild(a),T(e)}let V=(a,b)=>{if(a instanceof b)return!0;let c=Object.getPrototypeOf(a);return null!==c&&(c.constructor.name===b.name||V(c,b))};function W(a,b,c,d){let e=window.getComputedStyle(a,c),f=e.getPropertyValue("content");if(""===f||"none"===f)return;let g=M();try{b.className=`${b.className} ${g}`}catch(a){return}let h=document.createElement("style");h.appendChild(function(a,b,c,d){let e=`.${a}:${b}`,f=c.cssText?function(a){let b=a.getPropertyValue("content");return`${a.cssText} content: '${b.replace(/'|"/g,"")}';`}(c):P(d).map(a=>{let b=c.getPropertyValue(a),d=c.getPropertyPriority(a);return`${a}: ${b}${d?" !important":""};`}).join(" ");return document.createTextNode(`${e}{${f}}`)}(g,c,e,d)),b.appendChild(h)}let X="application/font-woff",Y="image/jpeg",Z={woff:X,woff2:X,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Y,jpeg:Y,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function $(a){return Z[(function(a){let b=/\.([^./]*?)$/g.exec(a);return b?b[1]:""})(a).toLowerCase()]||""}function _(a){return -1!==a.search(/^(data:)/)}function aa(a,b){return`data:${b};base64,${a}`}async function ab(a,b,c){let d=await fetch(a,b);if(404===d.status)throw Error(`Resource "${d.url}" not found`);let e=await d.blob();return new Promise((a,b)=>{let f=new FileReader;f.onerror=b,f.onloadend=()=>{try{a(c({res:d,result:f.result}))}catch(a){b(a)}},f.readAsDataURL(e)})}let ac={};async function ad(a,b,c){var d,e,f;let g,h,i=(d=a,e=b,f=c.includeQueryParams,h=d.replace(/\?.*/,""),f&&(h=d),/ttf|otf|eot|woff2?/i.test(h)&&(h=h.replace(/.*\//,"")),e?`[${e}]${h}`:h);if(null!=ac[i])return ac[i];c.cacheBust&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());try{let d=await ab(a,c.fetchRequestInit,({res:a,result:c})=>(b||(b=a.headers.get("Content-Type")||""),c.split(/,/)[1]));g=aa(d,b)}catch(d){g=c.imagePlaceholder||"";let b=`Failed to fetch resource: ${a}`;d&&(b="string"==typeof d?d:d.message),b&&console.warn(b)}return ac[i]=g,g}async function ae(a){let b=a.toDataURL();return"data:,"===b?a.cloneNode(!1):S(b)}async function af(a,b){if(a.currentSrc){let b=document.createElement("canvas"),c=b.getContext("2d");return b.width=a.clientWidth,b.height=a.clientHeight,null==c||c.drawImage(a,0,0,b.width,b.height),S(b.toDataURL())}let c=a.poster,d=$(c);return S(await ad(c,d,b))}async function ag(a,b){var c;try{if(null==(c=null==a?void 0:a.contentDocument)?void 0:c.body)return await al(a.contentDocument.body,b,!0)}catch(a){}return a.cloneNode(!1)}async function ah(a,b){return V(a,HTMLCanvasElement)?ae(a):V(a,HTMLVideoElement)?af(a,b):V(a,HTMLIFrameElement)?ag(a,b):a.cloneNode(ai(a))}let ai=a=>null!=a.tagName&&"SVG"===a.tagName.toUpperCase();async function aj(a,b,c){var d,e;if(ai(b))return b;let f=[];return 0===(f=null!=a.tagName&&"SLOT"===a.tagName.toUpperCase()&&a.assignedNodes?N(a.assignedNodes()):V(a,HTMLIFrameElement)&&(null==(d=a.contentDocument)?void 0:d.body)?N(a.contentDocument.body.childNodes):N((null!=(e=a.shadowRoot)?e:a).childNodes)).length||V(a,HTMLVideoElement)||await f.reduce((a,d)=>a.then(()=>al(d,c)).then(a=>{a&&b.appendChild(a)}),Promise.resolve()),b}async function ak(a,b){let c=a.querySelectorAll?a.querySelectorAll("use"):[];if(0===c.length)return a;let d={};for(let e=0;e<c.length;e++){let f=c[e].getAttribute("xlink:href");if(f){let c=a.querySelector(f),e=document.querySelector(f);c||!e||d[f]||(d[f]=await al(e,b,!0))}}let e=Object.values(d);if(e.length){let b="http://www.w3.org/1999/xhtml",c=document.createElementNS(b,"svg");c.setAttribute("xmlns",b),c.style.position="absolute",c.style.width="0",c.style.height="0",c.style.overflow="hidden",c.style.display="none";let d=document.createElementNS(b,"defs");c.appendChild(d);for(let a=0;a<e.length;a++)d.appendChild(e[a]);a.appendChild(c)}return a}async function al(a,b,c){return c||!b.filter||b.filter(a)?Promise.resolve(a).then(a=>ah(a,b)).then(c=>aj(a,c,b)).then(c=>(function(a,b,c){if(V(b,Element)&&(!function(a,b,c){let d=b.style;if(!d)return;let e=window.getComputedStyle(a);e.cssText?(d.cssText=e.cssText,d.transformOrigin=e.transformOrigin):P(c).forEach(c=>{let f=e.getPropertyValue(c);if("font-size"===c&&f.endsWith("px")){let a=Math.floor(parseFloat(f.substring(0,f.length-2)))-.1;f=`${a}px`}V(a,HTMLIFrameElement)&&"display"===c&&"inline"===f&&(f="block"),"d"===c&&b.getAttribute("d")&&(f=`path(${b.getAttribute("d")})`),d.setProperty(c,f,e.getPropertyPriority(c))})}(a,b,c),W(a,b,":before",c),W(a,b,":after",c),V(a,HTMLTextAreaElement)&&(b.innerHTML=a.value),V(a,HTMLInputElement)&&b.setAttribute("value",a.value),V(a,HTMLSelectElement))){let c=Array.from(b.children).find(b=>a.value===b.getAttribute("value"));c&&c.setAttribute("selected","")}return b})(a,c,b)).then(a=>ak(a,b)):null}let am=/url\((['"]?)([^'"]+?)\1\)/g,an=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ao=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;async function ap(a,b,c,d,e){try{let f,g=c?function(a,b){if(a.match(/^[a-z]+:\/\//i))return a;if(a.match(/^\/\//))return window.location.protocol+a;if(a.match(/^[a-z]+:/i))return a;let c=document.implementation.createHTMLDocument(),d=c.createElement("base"),e=c.createElement("a");return c.head.appendChild(d),c.body.appendChild(e),b&&(d.href=b),e.href=a,e.href}(b,c):b,h=$(b);if(e){let a=await e(g);f=aa(a,h)}else f=await ad(g,h,d);return a.replace(function(a){let b=a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return RegExp(`(url\\(['"]?)(${b})(['"]?\\))`,"g")}(b),`$1${f}$3`)}catch(a){}return a}function aq(a){return -1!==a.search(am)}async function ar(a,b,c){if(!aq(a))return a;let d=function(a,{preferredFontFormat:b}){return b?a.replace(ao,a=>{for(;;){let[c,,d]=an.exec(a)||[];if(!d)return"";if(d===b)return`src: ${c};`}}):a}(a,c);return(function(a){let b=[];return a.replace(am,(a,c,d)=>(b.push(d),a)),b.filter(a=>!_(a))})(d).reduce((a,d)=>a.then(a=>ap(a,d,b,c)),Promise.resolve(d))}async function as(a,b,c){var d;let e=null==(d=b.style)?void 0:d.getPropertyValue(a);if(e){let d=await ar(e,null,c);return b.style.setProperty(a,d,b.style.getPropertyPriority(a)),!0}return!1}async function at(a,b){await as("background",a,b)||await as("background-image",a,b),await as("mask",a,b)||await as("-webkit-mask",a,b)||await as("mask-image",a,b)||await as("-webkit-mask-image",a,b)}async function au(a,b){let c=V(a,HTMLImageElement);if(!(c&&!_(a.src))&&!(V(a,SVGImageElement)&&!_(a.href.baseVal)))return;let d=c?a.src:a.href.baseVal,e=await ad(d,$(d),b);await new Promise((d,f)=>{a.onload=d,a.onerror=b.onImageErrorHandler?(...a)=>{try{d(b.onImageErrorHandler(...a))}catch(a){f(a)}}:f,a.decode&&(a.decode=d),"lazy"===a.loading&&(a.loading="eager"),c?(a.srcset="",a.src=e):a.href.baseVal=e})}async function av(a,b){let c=N(a.childNodes).map(a=>aw(a,b));await Promise.all(c).then(()=>a)}async function aw(a,b){V(a,Element)&&(await at(a,b),await au(a,b),await av(a,b))}let ax={};async function ay(a){let b=ax[a];if(null!=b)return b;let c=await fetch(a);return b={url:a,cssText:await c.text()},ax[a]=b,b}async function az(a,b){let c=a.cssText,d=/url\(["']?([^"')]+)["']?\)/g;return Promise.all((c.match(/url\([^)]+\)/g)||[]).map(async e=>{let f=e.replace(d,"$1");return f.startsWith("https://")||(f=new URL(f,a.url).href),ab(f,b.fetchRequestInit,({result:a})=>(c=c.replace(e,`url(${a})`),[e,a]))})).then(()=>c)}function aA(a){if(null==a)return[];let b=[],c=a.replace(/(\/\*[\s\S]*?\*\/)/gi,""),d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let a=d.exec(c);if(null===a)break;b.push(a[0])}c=c.replace(d,"");let e=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,f=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let a=e.exec(c);if(null===a){if(null===(a=f.exec(c)))break;e.lastIndex=f.lastIndex}else f.lastIndex=e.lastIndex;b.push(a[0])}return b}async function aB(a,b){let c=[],d=[];return a.forEach(c=>{if("cssRules"in c)try{N(c.cssRules||[]).forEach((a,e)=>{if(a.type===CSSRule.IMPORT_RULE){let f=e+1,g=a.href,h=ay(g).then(a=>az(a,b)).then(a=>aA(a).forEach(a=>{try{c.insertRule(a,a.startsWith("@import")?f+=1:c.cssRules.length)}catch(b){console.error("Error inserting rule from remote css",{rule:a,error:b})}})).catch(a=>{console.error("Error loading remote css",a.toString())});d.push(h)}})}catch(f){let e=a.find(a=>null==a.href)||document.styleSheets[0];null!=c.href&&d.push(ay(c.href).then(a=>az(a,b)).then(a=>aA(a).forEach(a=>{e.insertRule(a,e.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",f)}}),Promise.all(d).then(()=>(a.forEach(a=>{if("cssRules"in a)try{N(a.cssRules||[]).forEach(a=>{c.push(a)})}catch(b){console.error(`Error while reading CSS rules from ${a.href}`,b)}}),c))}async function aC(a,b){if(null==a.ownerDocument)throw Error("Provided element is not within a Document");let c=N(a.ownerDocument.styleSheets);return(await aB(c,b)).filter(a=>a.type===CSSRule.FONT_FACE_RULE).filter(a=>aq(a.style.getPropertyValue("src")))}function aD(a){return a.trim().replace(/["']/g,"")}async function aE(a,b){let c=await aC(a,b),d=function(a){let b=new Set;return!function a(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(a=>{b.add(aD(a))}),Array.from(c.children).forEach(b=>{b instanceof HTMLElement&&a(b)})}(a),b}(a);return(await Promise.all(c.filter(a=>d.has(aD(a.style.fontFamily))).map(a=>{let c=a.parentStyleSheet?a.parentStyleSheet.href:null;return ar(a.cssText,c,b)}))).join("\n")}async function aF(a,b){let c=null!=b.fontEmbedCSS?b.fontEmbedCSS:b.skipFonts?null:await aE(a,b);if(c){let b=document.createElement("style"),d=document.createTextNode(c);b.appendChild(d),a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)}}async function aG(a,b={}){let{width:c,height:d}=R(a,b),e=await al(a,b,!0);return await aF(e,b),await aw(e,b),!function(a,b){let{style:c}=a;b.backgroundColor&&(c.backgroundColor=b.backgroundColor),b.width&&(c.width=`${b.width}px`),b.height&&(c.height=`${b.height}px`);let d=b.style;null!=d&&Object.keys(d).forEach(a=>{c[a]=d[a]})}(e,b),await U(e,c,d)}async function aH(a,b={}){let{width:c,height:d}=R(a,b),e=await aG(a,b),f=await S(e),g=document.createElement("canvas"),h=g.getContext("2d"),i=b.pixelRatio||function(){let a,b;try{b=process}catch(a){}let c=b&&b.env?b.env.devicePixelRatio:null;return c&&Number.isNaN(a=parseInt(c,10))&&(a=1),a||window.devicePixelRatio||1}(),j=b.canvasWidth||c,k=b.canvasHeight||d;return g.width=j*i,g.height=k*i,!b.skipAutoScale&&(g.width>16384||g.height>16384)&&(g.width>16384&&g.height>16384?g.width>g.height?(g.height*=16384/g.width,g.width=16384):(g.width*=16384/g.height,g.height=16384):g.width>16384?(g.height*=16384/g.width,g.width=16384):(g.width*=16384/g.height,g.height=16384)),g.style.width=`${j}`,g.style.height=`${k}`,b.backgroundColor&&(h.fillStyle=b.backgroundColor,h.fillRect(0,0,g.width,g.height)),h.drawImage(f,0,0,g.width,g.height),g}async function aI(a,b={}){return(await aH(a,b)).toDataURL()}let aJ=!1;async function aK(a,b="auto"){if(!aJ){aJ=!0;try{let c=a.style.opacity,d=a.style.visibility;a.style.opacity="1",a.style.visibility="visible";let e=a.querySelectorAll("*"),f=[];e.forEach(a=>{let b=a.style.color,c=a.style.fill,d=a.style.background;if(f.push({elem:a,color:b,fill:c,bg:d}),a.style.color="#000000",("text"===a.tagName||"tspan"===a.tagName)&&(a.style.fill="#000000"),"SPAN"===a.tagName&&a.className.includes("inline-block")){let b=a.textContent?.trim();b&&/^\d+$/.test(b)&&(a.style.background="#f3f4f6",a.style.color="#000000")}}),await new Promise(a=>setTimeout(a,150)),a.dataset.export=b;let g=await aI(a,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0});a.style.opacity=c,a.style.visibility=d,f.forEach(({elem:a,color:b,fill:c,bg:d})=>{a.style.color=b,a.style.fill=c,a.style.background=d});let h=document.createElement("a");h.href=g,h.download="ot-progression.png",h.click(),I.track("export_png",{page:"chord_progression",ok:!0})}catch(a){I.track("export_png",{page:"chord_progression",ok:!1,err:String(a)})}finally{a.removeAttribute("data-export"),aJ=!1}}}var aL=a.i(61478),aM=a.i(90944);let aN={info:"bg-blue-600",success:"bg-green-600",warning:"bg-orange-600"};function aO({message:a,type:d="info",ctaText:e,ctaHref:f,ctaPlace:g,onClose:h,duration:i=5e3}){let{trackClick:j}=(0,aM.useCtaTracking)();(0,c.useEffect)(()=>{if(i>0){let a=setTimeout(h,i);return()=>clearTimeout(a)}},[i,h]);let k=(0,c.useCallback)(()=>{g&&j(g)},[g,j]),l=aN[d];return(0,b.jsx)("div",{className:"fixed bottom-20 sm:bottom-6 left-1/2 -translate-x-1/2 z-50 animate-slide-up max-w-md w-full mx-4",role:"alert","aria-live":"polite",children:(0,b.jsxs)("div",{className:`${l} text-white rounded-lg shadow-2xl p-4 flex items-center justify-between gap-3`,children:[(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsx)("p",{className:"text-sm font-medium",children:a})}),e&&f&&(0,b.jsx)("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-white/20 hover:bg-white/30 rounded transition-colors",onClick:k,children:e}),(0,b.jsx)("button",{onClick:h,className:"flex-shrink-0 w-6 h-6 flex items-center justify-center hover:bg-white/20 rounded transition-colors","aria-label":"Close notification",children:"✕"})]})})}var aP=a.i(65404),aQ=a.i(50944);let aR={plan:"free",notationStyle:"english"},aS=new Set(["7b9","7#9","7#11","7b13","7alt","13","M13","m13"]),aT=[{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"Major",commentJa:"明るく、ハッピーな響きの基本となるコード。",commentEn:"The fundamental chord for a bright and happy sound."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"m (minor)",commentJa:"少し切なく、落ち着いた響きの基本となるコード。",commentEn:"The fundamental chord for a slightly sad and calm sound."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"7",commentJa:"次のコードへ進みたくなるような、少し不安定でおしゃれな響き。",commentEn:"A slightly unstable and stylish sound that creates a sense of resolution to the next chord."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"maj7",commentJa:"明るく、洗練された都会的な響き。",commentEn:"A bright, sophisticated, and urban sound."},{tier:"Free",categoryJa:"基本",categoryEn:"Basics",quality:"m7",commentJa:"切なさの中に、おしゃれな雰囲気が加わった響き。",commentEn:"A sound that adds a stylish atmosphere to sadness."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"sus4",commentJa:"メジャーでもマイナーでもない、解決を待つ浮遊感のある響き。",commentEn:"A sound with a floating feel, neither major nor minor, awaiting resolution."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"sus2",commentJa:"sus4よりも、より明るく爽やかな浮遊感を持つ響き。",commentEn:"A sound with a brighter and fresher floating feel than sus4."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"add9",commentJa:"通常のコードにキラキラした透明感を加える、現代ポップスの定番。",commentEn:"The go-to chord in modern pop, adding a sparkling transparency to a basic chord."},{tier:"Free",categoryJa:"基本の飾り付け",categoryEn:"Essential Colors",quality:"dim",commentJa:"不気味で緊張感のある響き。コードとコードを繋ぐ時に便利。",commentEn:"A spooky and tense sound, useful for connecting one chord to another."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"M9 (maj9)",commentJa:"ポップス、R&Bの王道おしゃれサウンド。",commentEn:"The quintessential stylish sound for Pop and R&B."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"6",commentJa:"maj7より少しレトロで温かい響き。",commentEn:"A slightly more retro and warmer sound than maj7."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"6/9",commentJa:"ジャズやフュージョンで多用される、明るく豊かな響き。",commentEn:"A bright and rich sound frequently used in Jazz and Fusion."},{tier:"Pro",categoryJa:"✨ キラキラ・浮遊感",categoryEn:"Sparkle & Float",quality:"add#11",commentJa:"現代的でドリーミーな、まさに「浮遊感」のあるサウンド。",commentEn:'A modern, dreamy sound that truly gives a "floating" feel.'},{tier:"Pro",categoryJa:"🌃 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m9",commentJa:"m7をさらにスムーズで洗練させた響き。",commentEn:"An even smoother and more refined sound than m7."},{tier:"Pro",categoryJa:"🌃 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m11",commentJa:"Lo-fi Hip HopやR&Bで定番の、少しアンニュイなサウンド。",commentEn:"A standard sound in Lo-fi Hip Hop and R&B, with a slightly melancholic vibe."},{tier:"Pro",categoryJa:"🌃 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m7b5",commentJa:"マイナーキーのii-V-Iで必須。ジャズ、ボサノヴァへの入り口。",commentEn:"Essential for minor key ii-V-I progressions. Your gateway to Jazz and Bossa Nova."},{tier:"Pro",categoryJa:"🌃 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"mM7",commentJa:"映画音楽のような、ミステリアスでドラマチックな響き。",commentEn:"A mysterious and dramatic sound, reminiscent of a movie soundtrack."},{tier:"Pro",categoryJa:"🌃 おしゃれ・都会的",categoryEn:"Stylish & Urban",quality:"m6",commentJa:"ジャズや映画音楽で耳にする、少しレトロでミステリアスな響き。",commentEn:"A slightly retro and mysterious sound, often heard in jazz and film scores."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7sus4",commentJa:"V7の前に置くことで、解決感を劇的に高めるプロの技。",commentEn:"A pro technique that dramatically enhances the feeling of resolution when placed before a V7 chord."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"aug",commentJa:"不安定で、次のコードへ進む推進力が強い。",commentEn:"An unstable sound with a strong drive to move to the next chord."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"dim7",commentJa:"経過コードとして非常に便利。緊張感を一気に高める。",commentEn:"Very useful as a passing chord to instantly increase tension."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(#9)",commentJa:"ブルージーでロックな緊張感。",commentEn:"A bluesy and rock-oriented tension."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(b9)",commentJa:"ジャズで多用される強い緊張感。",commentEn:"A strong tension frequently used in Jazz."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(#5)",commentJa:"augと同じ。解決先を強く示す。",commentEn:"Same as augmented. Strongly indicates the point of resolution."},{tier:"Pro",categoryJa:"⚡️ 緊張感・スパイス",categoryEn:"Tension & Spice",quality:"7(b13)",commentJa:"複雑でムーディーな緊張感。",commentEn:"A complex and moody tension."}],aU=a=>{let b=aT.filter(b=>b.tier===a),c={};return b.forEach(a=>{c[a.categoryJa]||(c[a.categoryJa]=[]),c[a.categoryJa].push(a)}),c},aV=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],aW=()=>(0,b.jsx)("span",{className:"absolute -top-1 -right-1 text-[10px]",title:"Pro専用",children:"👑"});function aX({plan:a="free",onConfirm:d,onBlock:e,onPreview:f}){let g=(0,c.useMemo)(()=>({root:"C",family:"maj",seventh:"none",extMode:"add",ext:{},alt:{},sus:null,slash:null}),[]),[h,i]=(0,c.useState)(g),j={...aR,plan:a},[k,l]=(0,c.useState)(!1),{spec:m,warnings:n}=(0,c.useMemo)(()=>(function(a,b,c={}){let d=JSON.parse(JSON.stringify(a)),e=[];return"dom"===d.family&&(d.seventh="7"),"free"===b.plan&&("tension"===d.extMode&&(d.ext={nine:!1,eleven:!1,thirteen:!1}),d.alt={},d.slash&&(d.slash=null)),"add"===d.extMode?d.ext.nine=d.ext.eleven=d.ext.thirteen=!1:d.ext.add9=d.ext.add11=d.ext.add13=!1,d.ext.thirteen&&(d.ext.nine=!0),"sus2"===d.sus&&"sus4"===a.sus&&(d.sus="sus4"),"sus4"===d.sus&&"sus2"===a.sus&&(d.sus="sus2"),d.ext.eleven&&("maj"===d.family&&(c.autoCorrect11th?(d.ext.eleven=!1,d.alt?d.alt.sharpEleven=!0:d.alt={sharpEleven:!0},e.push("11 → #11 に自動調整しました（メジャーではavoid音のため）。")):e.push("メジャーでの11は3度と濁ります。#11（Lydian）を検討してください。")),"dom"===d.family&&(c.autoCorrect11th?(d.ext.eleven=!1,d.alt?d.alt.sharpEleven=!0:d.alt={sharpEleven:!0},e.push("11 → #11 に自動調整しました（ドミナントでは3度と衝突するため）。")):e.push("ドミナントでの11は3度と衝突します。#11 または sus4 を検討してください。"))),"dom"!==d.family&&(d.alt={}),"maj7"===d.seventh&&d.sus&&(e.push("maj7 with sus is uncommon; use sus4(maj7) in advanced mode."),d.sus=null),"tension"!==d.extMode||["7","maj7","m7"].includes(d.seventh)||(d.ext={nine:!1,eleven:!1,thirteen:!1}),{spec:d,warnings:e}})(h,j),[h,j]),o=(0,c.useMemo)(()=>(function(a,b){let c=[a.root],d="maj"===a.family?"":"min"===a.family?"m":"dom"===a.family?"":"sus"===a.family?"sus":"dim"===a.family?"dim":"aug"===a.family?"aug":"5";c.push(d);let e="maj7"===a.seventh?"compact"===b.notationStyle?"M7":"maj7":"7"===a.seventh?"7":"m7"===a.seventh?"m7":"6"===a.seventh?"6":"m7b5"===a.seventh?"m7b5":"dim7"===a.seventh?"dim7":"";if(c.push(e),"tension"===a.extMode)a.ext.thirteen?c.push("13"):a.ext.eleven?c.push("11"):a.ext.nine&&c.push("9");else{let b=[a.ext.add9&&"add9",a.ext.add11&&"add11",a.ext.add13&&"add13"].filter(Boolean);b.length&&c.push(`(${b.join(",")})`)}let f=[a.alt.b9&&"b9",a.alt.s9&&"#9",a.alt.s11&&"#11",a.alt.b13&&"b13"].filter(Boolean).join("");return c.push(f),a.sus&&c.push(a.sus),a.slash&&c.push(`/${a.slash}`),c.join("")})(m,j),[m,j]);(0,c.useEffect)(()=>{!k&&m.ext.eleven&&("maj"===m.family||"dom"===m.family)&&l(!0)},[m.ext.eleven,m.family,k]);let p=(0,c.useMemo)(()=>{console.log("🔍 ChordBuilder: Creating quality presets...");let b=aU("Free"),c=aU("Pro");console.log("🔍 Free qualities:",b),console.log("🔍 Pro qualities:",c),console.log("🔍 Total qualities in QUALITY_MASTER:",aT.length);let d=[];return Object.entries(b).forEach(([a,b])=>{b.forEach(b=>{let c="m (minor)"===b.quality?"m":"Major"===b.quality?"M":"maj7"===b.quality?"M7":b.quality;d.push({label:c,apply:()=>{let a=q(b.quality);a&&i(a)},comment:b.commentJa,category:a})})}),"pro"===a&&Object.entries(c).forEach(([a,b])=>{b.forEach(b=>{let c="M9 (maj9)"===b.quality?"M9":"m7b5"===b.quality?"m7b5":"mM7"===b.quality?"mM7":"m6"===b.quality?"m6":"7(#9)"===b.quality?"7(#9)":"7(b9)"===b.quality?"7(b9)":"7(#5)"===b.quality?"7(#5)":"7(b13)"===b.quality?"7(b13)":b.quality;d.push({label:c,apply:()=>{let a=q(b.quality);a&&i(a)},pro:!0,comment:b.commentJa,category:a})})}),d},[a]),q=a=>{let b={ext:{},alt:{},sus:null,slash:null};switch(a){case"Major":return{...b,root:"C",family:"maj",seventh:"none",extMode:"add"};case"m (minor)":return{...b,root:"C",family:"min",seventh:"none",extMode:"add"};case"7":return{...b,root:"C",family:"dom",seventh:"7",extMode:"tension"};case"maj7":return{...b,root:"C",family:"maj",seventh:"maj7",extMode:"add"};case"m7":return{...b,root:"C",family:"min",seventh:"m7",extMode:"add"};case"sus4":return{...b,root:"C",family:"sus",sus:"sus4",seventh:"none",extMode:"add"};case"sus2":return{...b,root:"C",family:"sus",sus:"sus2",seventh:"none",extMode:"add"};case"add9":return{...b,root:"C",family:"maj",seventh:"none",extMode:"add",ext:{add9:!0}};case"dim":return{...b,root:"C",family:"dim",seventh:"none",extMode:"add"};case"M9 (maj9)":return{...b,root:"C",family:"maj",seventh:"maj7",extMode:"add",ext:{add9:!0}};case"6":return{...b,root:"C",family:"maj",seventh:"6",extMode:"add"};case"6/9":return{...b,root:"C",family:"maj",seventh:"6",extMode:"add",ext:{add9:!0}};case"add#11":return{...b,root:"C",family:"maj",seventh:"none",extMode:"add",ext:{add11:!0},alt:{s11:!0}};case"m9":return{...b,root:"C",family:"min",seventh:"m7",extMode:"add",ext:{add9:!0}};case"m11":return{...b,root:"C",family:"min",seventh:"m7",extMode:"add",ext:{add9:!0,add11:!0}};case"m7b5":return{...b,root:"C",family:"min",seventh:"m7b5",extMode:"add"};case"mM7":return{...b,root:"C",family:"min",seventh:"maj7",extMode:"add"};case"m6":return{...b,root:"C",family:"min",seventh:"6",extMode:"add"};case"7sus4":return{...b,root:"C",family:"dom",seventh:"7",sus:"sus4",extMode:"tension"};case"aug":return{...b,root:"C",family:"aug",seventh:"none",extMode:"add"};case"dim7":return{...b,root:"C",family:"dim",seventh:"dim7",extMode:"add"};case"7(#9)":return{...b,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{sharp9:!0}};case"7(b9)":return{...b,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{flat9:!0}};case"7(#5)":return{...b,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{sharp5:!0}};case"7(b13)":return{...b,root:"C",family:"dom",seventh:"7",extMode:"tension",alt:{flat13:!0}};default:return null}},r=(c,d,f,g)=>(0,b.jsxs)("div",{className:"relative inline-block",children:[(0,b.jsx)("button",{className:`h-9 px-3 rounded border text-xs ${d?"bg-[var(--brand-primary)] text-white":""} ${g?.locked?"opacity-50":""}`,onClick:()=>{g?.disabled||g?.locked?g?.locked&&e?.("pro_quality",c):f()},title:g?.locked?"Proで解放":g?.comment,"aria-disabled":g?.disabled||g?.locked,onContextMenu:a=>{a.preventDefault(),g?.comment},children:c}),g?.showProBadge&&"free"===a&&(0,b.jsx)(aW,{})]},c);return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs opacity-70 mb-0.5",children:"ルート"}),(0,b.jsx)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:aV.map(a=>r(a,m.root===a,()=>i(b=>({...b,root:a}))))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-xs opacity-70 mb-0.5",children:["クイック (",p.length,"種類)"]}),(0,b.jsx)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:p.map(a=>(0,b.jsx)("div",{className:"relative",children:r(a.label,!1,a.apply,{locked:!!a.locked,showProBadge:!!a.pro,comment:a.comment})},a.label))})]}),"free"===a?(0,b.jsxs)("details",{children:[(0,b.jsx)("summary",{className:"cursor-pointer text-sm",children:"Advanced (Pro) 👑"}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:(0,b.jsx)("div",{className:"text-sm opacity-70 p-4 bg-gray-50 rounded-lg",children:"Pro版では、より高度なコード品質をご利用いただけます。"})})]}):(0,b.jsxs)("details",{children:[(0,b.jsx)("summary",{className:"cursor-pointer text-sm",children:"Advanced (Pro)"}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:Object.entries(aU("Pro")).map(([a,c])=>(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs opacity-70 mb-0.5",children:a}),(0,b.jsx)("div",{className:"flex gap-1 overflow-x-auto whitespace-nowrap py-0 -mx-2 px-2",children:c.map(a=>{let c="M9 (maj9)"===a.quality?"M9":"m7b5"===a.quality?"m7b5":"mM7"===a.quality?"mM7":"m6"===a.quality?"m6":"7(#9)"===a.quality?"7(#9)":"7(b9)"===a.quality?"7(b9)":"7(#5)"===a.quality?"7(#5)":"7(b13)"===a.quality?"7(b13)":a.quality;return(0,b.jsx)("div",{className:"relative",children:r(c,!1,()=>{let b=q(a.quality);b&&i(b)},{comment:a.commentJa})},a.quality)})})]},a))})]}),n.length>0&&(0,b.jsx)("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:n[0]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm",children:["Preview: ",o||"-"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{className:"rounded border px-2 py-1.5 text-xs hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>f?.(o),disabled:!o,children:"▶ Play"}),(0,b.jsx)("button",{className:"rounded border px-2 py-1.5 text-xs",onClick:()=>i(g),children:"Clear"}),(0,b.jsx)("button",{className:"rounded bg-[var(--brand-primary)] text-white px-3 py-2 text-xs hover:opacity-90",onClick:()=>{let b=!!m.slash,c="";m.ext.thirteen?c="13":m.alt.b9?c="7b9":m.alt.s9?c="7#9":m.alt.s11?c="7#11":m.alt.b13?c="7b13":m.alt.alt&&(c="7alt"),function(a,b){let{isPro:c,hasSlash:d}=b;return!!c||!d&&!aS.has(a)}(c,{isPro:"pro"===a,hasSlash:b})?d?.(o,m):b?e?.("pro_slash"):e?.("pro_quality",c)},children:"Add"})]})]})]})}function aY(){let a=(0,aP.useCtaMessages)(),l=(0,aQ.usePathname)().startsWith("/ja"),m=(0,c.useRef)(null);(0,e.useRovingTabs)(m,{orientation:"horizontal"});let n=(0,c.useRef)(null);(0,e.useRovingTabs)(n,{orientation:"horizontal"});let o=(0,c.useRef)(null);(0,e.useRovingTabs)(o,{orientation:"horizontal"});let p=(0,c.useRef)(null),E=(0,c.useRef)(null),[F,J]=(0,c.useState)(()=>{let a=Array(12).fill("");return a[0]="C",a[1]="Am",a[2]="F",a[3]="G",a}),K=(0,c.useMemo)(()=>F.reduce((a,b,c)=>(b&&a.push(c),a),[]),[F]),M=(0,c.useMemo)(()=>K.map(a=>F[a]),[K,F]),N=(0,c.useMemo)(()=>{let a=F.findIndex(a=>!a);return -1===a?11:a},[F]),[O,P]=(0,c.useState)(0);(0,c.useEffect)(()=>{P(N)},[N]),(0,c.useMemo)(()=>["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],[]),(0,c.useMemo)(()=>[{label:"M",value:""},{label:"M7",value:"maj7"},{label:"7",value:"7"},{label:"6",value:"6"},{label:"add9",value:"add9"},{label:"sus4",value:"sus4"},{label:"sus2",value:"sus2"},{label:"m",value:"m"},{label:"m7",value:"m7"},{label:"dim",value:"dim"},{label:"m7b5",value:"m7b5"},{label:"aug",value:"aug"}],[]);let[Q,R]=(0,c.useState)("C"),[S,T]=(0,c.useState)("M"),[U,V]=(0,c.useState)([]);(0,c.useMemo)(()=>[{label:"sus2",value:"sus2"},{label:"sus4",value:"sus4"},{label:"add9",value:"add9"},{label:"add11",value:"add11"},{label:"add13",value:"add13"}],[]);let[W,X]=(0,c.useState)([]),[Y,Z]=(0,c.useState)(""),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)([]),[ac,ad]=(0,c.useState)([]),[ae,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)([]),{keyCandidates:ai,selectedKey:aj,analyze:ak,selectKey:al,scaleCandidates:am,selectedScale:an,selectScale:ao,reset:ap}=(0,r.useAnalysisStore)(),[aq,ar]=(0,c.useState)("degrees"),[as,at]=(0,c.useState)(null),[au,av]=(0,c.useState)(null),[aw,ax]=(0,c.useState)(null),[ay,az]=(0,c.useState)(null),aA=(0,c.useCallback)(()=>{ax(null),az(null)},[]),aB=(0,c.useMemo)(()=>{let a=an?.type,b=a?i.SCALE_INTERVALS[a]:null;return!b||7===b.length},[an?.type]);(0,c.useEffect)(()=>{aB||"degrees"===aq||ar("degrees")},[aB]);let[aC,aD]=(0,c.useState)(null),aE=(0,c.useRef)(null),aF=(0,c.useRef)(null),aG=(0,c.useRef)(null),aH=(0,c.useRef)(null),[aI,aJ]=(0,c.useState)(null),aM=(0,c.useRef)(null);(0,c.useRef)(null);let[aN,aR]=(0,c.useState)(!1),[aS,aT]=(0,c.useState)(120),aU=(0,c.useRef)(null),[aV,aW]=(0,c.useState)(-1),aY=(0,c.useCallback)((a,b)=>{J(c=>{if(a===b)return c;let d=c.slice(),e=d[a];return d[a]=d[b],d[b]=e,d})},[]),[aZ,a$]=(0,c.useState)(null),a_=(0,c.useCallback)((a,b)=>{if(!F[b])return;a.stopPropagation();let c=a.touches[0];aM.current={index:b,startX:c.clientX,startY:c.clientY},aJ(b),a$(null)},[F]),a0=(0,c.useCallback)((a,b)=>{if(null===aM.current||null===aI)return;let c=a.touches[0],d=document.elementFromPoint(c.clientX,c.clientY);for(;d&&!d.hasAttribute("data-slot-index");)d=d.parentElement;if(d){let a=parseInt(d.getAttribute("data-slot-index")||"-1");a>=0&&a!==aI&&a$(a)}},[aI]),a1=(0,c.useCallback)(a=>{null!==aM.current&&null!==aI&&null!==aZ&&aI!==aZ&&aY(aI,aZ),aM.current=null,aJ(null),a$(null)},[aI,aZ,aY]),a2=(0,c.useRef)(!1),a3=(0,c.useCallback)(()=>{a2.current=!1,aU.current&&(clearInterval(aU.current),aU.current=null),aR(!1),aW(-1)},[]),a4=(0,c.useCallback)(async()=>{let a=F.map((a,b)=>({chord:a,index:b})).filter(a=>a.chord);if(0===a.length)return;a3(),await D.player.resume(),a2.current=!0,aR(!0),aW(0);let b=60/aS*1e3;for(let a=0;a<4;a++){if(!a2.current||(await new Promise(a=>setTimeout(a,b)),!a2.current))return;D.player.playNote(84,100)}let c=0,d=0,e=async()=>{if(!a2.current){aU.current&&(clearInterval(aU.current),aU.current=null);return}if(d%4==0){c>=a.length&&(c=0);let{chord:b,index:d}=a[c];aW(d),await bW(b),c++}else if(c>0&&c<=a.length){let{chord:b}=a[c-1];await bW(b)}d++};a2.current&&(await e(),a2.current&&(aU.current=setInterval(e,b),(0,I.track)("progression_play",{page:"chord_progression",bpm:aS,chordCount:a.length})))},[F,aS,a3]),a5=(0,c.useCallback)(()=>{aN?a3():a4()},[aN,a4,a3]);(0,c.useEffect)(()=>()=>{aU.current&&clearInterval(aU.current)},[]),(0,c.useEffect)(()=>{aN&&a3()},[F]);let a6=(0,c.useCallback)(a=>{J(b=>{let c=b.slice();return c[a]="",c})},[]),{isPro:a7}=(0,x.usePro)(),{sketch:a8,setSketch:a9}=(a=>{let[b,d]=(0,c.useState)(null),e=(0,c.useRef)(null);return(0,c.useEffect)(()=>{e.current&&window.clearTimeout(e.current),e.current=window.setTimeout(()=>{b&&(async()=>{let c=a?await H(b):G(b);c.ok||"limit_exceeded"!==c.reason?I.track("save_project",{page:"chord_progression"}):I.track("project_limit_warn",{page:"chord_progression"})})()},3e3)},[b]),{sketch:b,setSketch:d}})(a7),ba=(0,c.useRef)(null),{sketches:bb,loadSketches:bc,deleteSketch:bd,saveSketch:be}=L(),[bf,bg]=(0,c.useState)(!1),[bh,bi]=(0,c.useState)(null),bj=(0,c.useRef)(null),[bk,bl]=(0,c.useState)(""),[bm,bn]=(0,c.useState)(!1),[bo,bp]=(0,c.useState)("C"),bq=(0,c.useRef)(null);(0,c.useEffect)(()=>{bf&&bc()},[bf,bc]),(0,c.useEffect)(()=>{let a=a=>{if(!bf)return;let b=bj.current;b&&!b.contains(a.target)&&bg(!1)},b=a=>{"Escape"===a.key&&bg(!1)};return document.addEventListener("mousedown",a),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("keydown",b)}},[bf]),(0,c.useEffect)(()=>{if(!bm)return;let a=a=>{let b=bq.current;b&&!b.contains(a.target)&&bn(!1)},b=a=>{"Escape"===a.key&&bn(!1)};return document.addEventListener("mousedown",a),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("keydown",b)}},[bm]);let[br,bs]=(0,c.useState)(!1),[bt,bu]=(0,c.useState)(""),bv=(0,c.useMemo)(()=>M.length?M.join(" "):`Untitled ${new Date().toLocaleString()}`,[M]),[bw,bx]=(0,c.useState)(null),by=(0,c.useRef)(new Set);(0,c.useEffect)(()=>{let b=F.filter(a=>""!==a).length;9!==b||by.current.has("limit_warn")?12!==b||by.current.has("limit_block")||(bx({message:a.toast.limitBlock,type:"warning",ctaText:a.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"limit_toast"}),(0,I.trackToast)("limit_block",{page:"chord_progression",chordCount:b}),by.current.add("limit_block")):(bx({message:a.toast.limitWarn,type:"info",ctaText:a.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"limit_toast"}),(0,I.trackToast)("limit_warn",{page:"chord_progression",chordCount:b}),by.current.add("limit_warn"))},[F]);let[bz,bA]=(0,c.useState)(""),bB=async b=>{try{if(!E.current)return;bA(b.name||"Untitled Sketch"),await new Promise(a=>setTimeout(a,50));let c=E.current;c.style.opacity="1",c.style.visibility="visible",await new Promise(a=>setTimeout(a,200)),await aK(c,"auto"),c.style.opacity="0.0001",c.style.visibility="hidden",bA(""),(0,I.track)("export_png",{page:"chord_progression",source:"sketch",id:b.id}),by.current.has("png_export")||(bx({message:a.toast.pngExport,type:"success",ctaText:a.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"png_toast"}),by.current.add("png_export"))}catch(a){console.error("Export failed:",a),bA("")}},bC=async()=>{try{if(!a7){let b=JSON.parse(localStorage.getItem("ot_sketches")||"[]");if(console.log("[DEBUG] doSaveSketch - isPro:",a7,"existing sketches:",b.length),b.length>=3){console.log("[DEBUG] Blocking save - limit reached"),bs(!1),bu(""),bx({message:a.toast.sketchLimit,type:"warning",ctaText:a.toast.ctaButton,ctaHref:"/ios-coming-soon",ctaPlace:"limit_toast"}),(0,I.trackToast)("limit_block",{page:"chord_progression",context:"sketch_limit"});return}}console.log("[DEBUG] Proceeding with save");let b=aj?h.PC_NAMES[aj.tonic]:aC?aC.tonic:"C",c=an?.type||(aj?aj.mode:"Ionian"),d={name:(bt.trim()||bv).slice(0,48),schema:"sketch_v1",appVersion:"3.0.0",key:{tonic:b,scaleId:String(c)},capo:{fret:0,note:"Shaped"},progression:{items:M.map((a,b)=>({id:a,degree:"",quality:""}))},fretboardView:{mode:"names"===aq?"Names":"Degrees",guide:!!au}},e=await be(d);(0,I.track)("save_project",{page:"chord_progression",ok:e?.ok}),bs(!1),bu("")}catch{}},[bD,bE]=(0,c.useState)(!1),[bF,bG]=(0,c.useState)(!1),[bH,bI]=(0,c.useState)(!1),[bJ,bK]=(0,c.useTransition)(),[bL,bM]=(0,c.useState)([]),[bN,bO]=(0,c.useState)([]),[bP,bQ]=(0,c.useState)(null),bR=(0,c.useRef)(null),bS=(a,b,c)=>{let d=(0,g.noteToPc)(c);if(void 0===d||d<0||d>11)return;let e=b.map(a=>(0,g.romanToChordSymbol)(a,d,"Major"));J(a=>{let b=[...a],c=b.findIndex(a=>!a);return -1===c&&(c=0),e.forEach((a,d)=>{b[(c+d)%12]=a}),b}),P(a=>{let b=[...F];e.forEach((a,c)=>{let d=b.findIndex(a=>!a);if(-1===d)return 0;b[(d+c)%12]=a});let c=b.findIndex(a=>!a);return -1===c?0:c}),(0,I.track)("preset_inserted",{page:"chord_progression",preset:a}),bn(!1)};(0,c.useEffect)(()=>{let a=aj||aC;if(!a)return;let b="number"==typeof a.tonic?h.PC_NAMES[a.tonic]:a.tonic,c="Major"===a.mode||"Minor"===a.mode?"Major"===a.mode?"major":"minor":a.mode;ah(M.map(a=>q(a,b,c,{showQuality:!0,uppercase:!0})))},[aj,aC,M]),(0,c.useEffect)(()=>{if(!aC||0===ag.length)return void bM([]);aC.mode,bM(function(a,b){let c=a.map(C),d=[];for(let a of z)for(let b of[a.seq,...a.variants??[]].map(a=>a.map(C))){let e=b.length;for(let f=0;f+e<=c.length;f++){let g=!0;for(let a=0;a<e;a++)if(c[f+a]!==b[a]){g=!1;break}if(g){d.push({id:a.id,name:a.name,summary:a.tooltip,start:f,end:f+e});break}}}return d.sort((a,b)=>b.end-b.start-(a.end-a.start)),function(a){let b=[];for(let c of a)b.some(a=>!(c.end<=a.start||a.end<=c.start))||b.push(c);return b}(d)}(ag,0))},[ag,aC]),(0,c.useEffect)(()=>{if(!ag||0===ag.length)return void bO([]);let a=ag.map(a=>{let b=a.replace(/\s+/g,"").match(/^(b|#)?([ivIV]+)(?:[°ø].*)?/);if(!b)return a.toUpperCase();let c=b[1]??"",d=(b[2]??"").toUpperCase();return`${c}${d}`}),b=null;try{b=g.detectCadence(a)}catch{}let c=(Array.isArray(b)?b:b?[b]:[]).map(a=>"string"==typeof a?{type:a}:{type:a?.type??a,tail:a?.tailRoman??(a?.pair?{from:a.pair[0],to:a.pair[1]}:void 0)});if(a.length>=2){let b=a[a.length-1],d=a[0];c.some(a=>"perfect"===a.type)||"V"!==b||"I"!==d||c.push({type:"perfect",tail:{from:"V",to:"I"}}),c.some(a=>"deceptive"===a.type)||"V"!==b||"VI"!==d||c.push({type:"deceptive",tail:{from:"V",to:"vi"}})}bO(c)},[ag]);let bT=(0,c.useMemo)(()=>{if(!ag||0===ag.length)return null;let a=ag.map(a=>{let b=a.replace(/\s+/g,"").match(/^(b|#)?([ivIV]+)(?:[°ø].*)?/);if(!b)return a.toUpperCase();let c=b[1]??"",d=(b[2]??"").toUpperCase();return`${c}${d}`});if(a.length<2)return null;let b=a[0],c=a[a.length-1];return"V"===c&&"I"===b?{type:"perfect",tail:{from:"V",to:"I"}}:"V"===c&&"VI"===b?{type:"deceptive",tail:{from:"V",to:"vi"}}:"V"===c?{type:"half",tail:{from:void 0,to:"V"}}:null},[ag]);(0,c.useEffect)(()=>{let a=()=>{aE.current&&aF.current&&aG.current&&(aF.current.style.minHeight="0px")};requestAnimationFrame(a);let b=setTimeout(a,120),c=null,d=()=>{c&&clearTimeout(c),c=setTimeout(a,120)};window.addEventListener("resize",d),window.addEventListener("orientationchange",d),window.addEventListener("load",a);let e=null,f=null;if("undefined"!=typeof ResizeObserver&&aH.current){let b=null;(e=new ResizeObserver(()=>{b&&clearTimeout(b),b=setTimeout(a,100)})).observe(aH.current)}if("undefined"!=typeof ResizeObserver&&aG.current){let b=null;(f=new ResizeObserver(()=>{b&&clearTimeout(b),b=setTimeout(a,100)})).observe(aG.current)}return()=>{clearTimeout(b),c&&clearTimeout(c),window.removeEventListener("resize",d),window.removeEventListener("orientationchange",d),window.removeEventListener("load",a),e&&e.disconnect(),f&&f.disconnect()}},[]),(0,c.useEffect)(()=>{aF.current},[$,bD,M.length]),U.length&&U.join(" "),(0,c.useEffect)(()=>{try{let a=(ba.current||(ba.current=Math.random().toString(36).slice(2,10)),ba.current),b=M.length?M.join(" ").slice(0,48):`Untitled ${new Date().toLocaleString()}`,c=aj?h.PC_NAMES[aj.tonic]:aC?aC.tonic:"C",d=an?.type||(aj?aj.mode:"Ionian");a9({id:a,name:b,createdAt:a8?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString(),schema:"sketch_v1",appVersion:"3.0.0",key:{tonic:c,scaleId:String(d)},capo:{fret:0,note:"Shaped"},progression:{items:M.map((a,b)=>({id:`${b+1}-${a}`,degree:"",quality:""}))},fretboardView:{mode:"names"===aq?"Names":"Degrees",guide:!!au}})}catch{}},[F,aq,au,aj,aC,an]);let[bU,bV]=(0,c.useState)(!1);(0,c.useEffect)(()=>{try{let a="ontouchstart"in window||(navigator?.maxTouchPoints??0)>0;bV(!!a)}catch{bV(!1)}},[]);let bW=async a=>{try{await D.player.resume();let b=(0,aL.chordToMidi)(a);b&&b.length>0&&D.player.playChord(b,"lightStrum",300)}catch(b){console.error("Failed to play chord:",a,b)}};return(0,b.jsxs)("main",{ref:p,className:"ot-page ot-stack","data-page":"find-key",children:[(0,b.jsxs)("section",{id:"progression",className:"ot-card prog-compact",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 sm:gap-3 mb-1 sm:mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t,{className:"mb-0 text-left",children:"Build progression"}),(0,b.jsx)(s.default,{title:"Build Progression",text:l?"Choose Chordsからコードを選んでスロットに追加ボタンから追加してください。上部のプリセットからコード進行を選択して追加することもできます。":"Select chords from Choose Chords and add them using the slot add button. You can also select chord progressions from the presets at the top to add them."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 relative",children:[(0,b.jsxs)("button",{type:"button",className:"btn-ghost btn-reset chip-pressable text-sm px-3 py-1 inline-flex items-center gap-1",title:"Reset progression",onClick:()=>{J(Array(12).fill("")),P(0),ap(),ab([]),_(null),av(null),at(null),ar("degrees")},children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M12 5V2L7 7l5 5V9c2.76 0 5 2.24 5 5a5 5 0 1 1-5-5z"})}),(0,b.jsx)("span",{children:"Reset"})]}),(0,b.jsxs)("button",{type:"button",className:"chip-pressable inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs border",title:"Show sketches",onClick:()=>bg(a=>!a),"aria-expanded":bf,children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h12v2H3v-2z"})}),"Sketches"]}),bf&&(0,b.jsx)("div",{ref:bj,className:"fixed right-4 top-20 z-[10000] w-[320px] max-h-[70vh] overflow-auto rounded-md border bg-white dark:bg-neutral-900 shadow-2xl p-2 space-y-2",children:0===bb.length?(0,b.jsx)("div",{className:"text-xs opacity-70 p-2",children:"No sketches yet"}):bb.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 px-2 py-1 rounded hover:bg-black/5 dark:hover:bg-white/10",children:[(0,b.jsx)("button",{className:"text-left text-sm flex-1 truncate",title:`${a.name}`,onClick:()=>bi(a),children:a.name}),(0,b.jsx)("button",{className:"ot-btn-ghost text-xs",title:"Delete",onClick:b=>{b.stopPropagation(),bd(a.id),bc(),(0,I.track)("project_delete",{page:"chord_progression",id:a.id})},children:"🗑️"})]},a.id))}),(0,b.jsx)("div",{className:"w-4","aria-hidden":"true"}),(0,b.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",className:"chip-pressable text-sm px-3 py-1.5 inline-flex items-center gap-1.5 rounded-lg border",title:aN?"Stop playback":"Play progression",onClick:a5,disabled:0===M.length,style:{opacity:0===M.length?.5:1},children:aN?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("rect",{x:"5",y:"5",width:"14",height:"14",rx:"1"})}),(0,b.jsx)("span",{children:"Stop"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M8 5v14l11-7z"})}),(0,b.jsx)("span",{children:"Play"})]})}),(0,b.jsxs)("div",{className:"inline-flex items-center gap-1.5",children:[(0,b.jsx)("label",{htmlFor:"bpm-input",className:"text-xs opacity-70",children:"BPM:"}),(0,b.jsx)("input",{id:"bpm-input",type:"number",min:"40",max:"240",value:aS,onChange:a=>aT(Math.max(40,Math.min(240,parseInt(a.target.value)||120))),className:"w-16 px-2 py-1 text-sm rounded border bg-transparent",disabled:aN})]})]}),(0,b.jsxs)("select",{className:"chip","aria-label":"Instrument",defaultValue:"acoustic_guitar_steel",onChange:async a=>{let b=a.currentTarget.value;await D.player.setInstrument(b)},children:[(0,b.jsx)("option",{value:"acoustic_guitar_steel",children:"Acoustic Steel"}),(0,b.jsx)("option",{value:"acoustic_guitar_nylon",children:"Acoustic Nylon"}),(0,b.jsx)("option",{value:"electric_guitar_clean",children:"Electric Clean"}),(0,b.jsx)("option",{value:"distortion_guitar",children:"Distortion"}),(0,b.jsx)("option",{value:"overdriven_guitar",children:"Over Drive"}),(0,b.jsx)("option",{value:"electric_guitar_muted",children:"Muted"}),(0,b.jsx)("option",{value:"acoustic_grand_piano",children:"Piano"})]})]})]}),(0,b.jsx)("div",{className:"prog-slots mt-2 flex flex-wrap gap-1","aria-label":"Progression slots",children:Array.from({length:12}).map((a,c)=>{let d=!!F[c],e=c<8?0:(c-7)*.08,f=`rgba(16,185,129,${e.toFixed(2)})`,g=O===c,h=aV===c&&aN;return(0,b.jsxs)("div",{"data-slot-index":c,className:["inline-flex items-center justify-center rounded border text-xs select-none relative chip-pressable",d?"bg-black/5 dark:bg-white/10":"bg-transparent",g?"ring-2 ring-emerald-400/60":"",h?"ring-4 ring-blue-500/80 shadow-lg":"",aI===c?"opacity-50 scale-105":"",aZ===c?"ring-2 ring-blue-400":""].join(" "),style:{padding:"6px 10px",minWidth:72,minHeight:36,background:d?void 0:f,borderColor:"var(--line)",transition:"opacity 0.15s, transform 0.15s, box-shadow 0.15s",touchAction:d?"none":"auto"},onClick:()=>{d?bW(F[c]):P(c)},draggable:d,onDragStart:()=>aJ(c),onDragOver:a=>a.preventDefault(),onDrop:()=>{null!==aI&&(aY(aI,c),aJ(null))},onTouchStart:a=>a_(a,c),onTouchMove:a=>a0(a,c),onTouchEnd:a1,children:[(0,b.jsx)("span",{className:"absolute left-1 top-1 text-[10px] opacity-70 select-none pointer-events-none",children:String(c+1)}),d?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:F[c]}),(0,b.jsx)("button",{"aria-label":"Remove chord",className:"absolute -top-1 -right-1 w-4 h-4 rounded-full bg-black/50 text-white text-[10px] leading-4 hover:bg-black/70",onClick:a=>{a.stopPropagation(),a6(c)},children:"×"})]}):null]},`slot-${c}`)})})]}),(0,b.jsxs)("section",{id:"choose",ref:aH,className:"ot-card right-panel",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t,{className:"mb-0 text-left",children:"Choose chords"}),(0,b.jsx)(s.default,{title:"Choose Chords",text:l?"ルートとコードタイプを選んでください。追加ボタンでコード進行のスロットに追加できます。\nProプランの場合、より複雑なコードタイプを選ぶことができます。":"Select a root note and chord type. Use the Add button to add to chord progression slots.\nPro plan allows you to select more complex chord types."})]}),(0,b.jsxs)("button",{type:"button",className:"chip-pressable text-sm px-3 py-1 inline-flex items-center gap-1 rounded-lg border",title:"Load preset progression",onClick:()=>bn(!0),children:[(0,b.jsx)("span",{children:"📋"}),(0,b.jsx)("span",{children:"Presets"})]})]}),(0,b.jsx)(aX,{plan:a7?"pro":"free",onPreview:async a=>{try{await D.player.resume();let b=(0,aL.chordToMidi)(a);D.player.playChord(b,"lightStrum",300)}catch{}},onBlock:a=>{bG(!0)},onConfirm:a=>{J(b=>{let c=[...b],d=c.findIndex(a=>!a);return -1===d&&(d=0),c[d]=a,c}),P(a=>{let b=[...F].findIndex(a=>!a);return -1===b?0:b}),bI(!0)}}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("button",{className:`w-full px-6 py-2 text-base rounded-lg font-semibold text-white transition-transform active:scale-[.98] active:translate-y-px focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-300 ${bJ?"bg-rose-400/70 cursor-wait":"bg-rose-400 hover:bg-rose-500"}`,onClick:()=>{(!M.map(a=>{let b=a.match(/^([A-G](?:#|b)?)(.*)$/);return{root:b?.[1]||a,quality:b?.[2]||""}}).some(a=>w.some(b=>a.quality.includes(b)))||a7)&&bK(()=>{_((0,v.analyzeChordProgression)(M));let a=(0,g.rankKeys)(M);if(ab(a.slice(0,4)),a.length>0){let b="Major"===a[0].mode?"major":"minor",c={tonic:a[0].label.split(" ")[0],mode:b};aD(c),ah(M.map(a=>q(a,c.tonic,c.mode,{showQuality:!0,uppercase:!0})))}else ad([]),aD(null),ah([]);ak(M),setTimeout(()=>{let a=document.getElementById("result");a&&a.scrollIntoView({behavior:"smooth",block:"start"})},100)})},disabled:bJ,"aria-busy":bJ,children:bJ?(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 0 1 8-8v4a4 4 0 0 0-4 4H4z"})]}),"Analyzing…"]}):"Analyze"})})]}),(0,b.jsxs)("section",{id:"result",ref:aG,className:"ot-card",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(t,{className:"text-left mb-0",children:"Result"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("button",{type:"button",className:"chip-pressable inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm border",onClick:()=>bs(!0),title:"Save sketch",children:[(0,b.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M17 3H5a2 2 0 0 0-2 2v14l4-4h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"})}),"Save"]})})]}),br&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10000]",role:"dialog","aria-modal":"true",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{bs(!1),bu("")}}),(0,b.jsxs)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-neutral-900 border rounded-lg shadow-xl p-4 w-[92vw] max-w-[420px]",children:[(0,b.jsx)("div",{className:"text-base font-semibold mb-2",children:"Save sketch"}),(0,b.jsx)("input",{type:"text",className:"chip px-2 py-2 text-sm w-full",placeholder:bv,value:bt,onChange:a=>bu(a.target.value),"aria-label":"Sketch name",autoFocus:!0}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-2",children:[(0,b.jsx)("button",{type:"button",className:"chip-pressable inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm border",onClick:()=>{bs(!1),bu("")},children:"Cancel"}),(0,b.jsx)("button",{type:"button",className:"chip-pressable inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm border",onClick:bC,children:"OK"})]})]})]}),bh&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[10001]",role:"dialog","aria-modal":"true",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>bi(null)}),(0,b.jsxs)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-neutral-900 border rounded-lg shadow-xl p-4 w-[92vw] max-w-[320px]",children:[(0,b.jsx)("div",{className:"text-base font-semibold mb-3",children:bh.name}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("button",{type:"button",className:"w-full chip-pressable inline-flex items-center justify-center gap-1 px-4 py-2 rounded-lg text-sm border",onClick:()=>{try{let a=Array(12).fill("");(bh?.progression?.items||[]).forEach((b,c)=>{c<12&&(a[c]=String(b?.id||""))}),J(a),P(-1===a.findIndex(a=>!a)?11:a.findIndex(a=>!a));try{ak(a.filter(Boolean))}catch{}let b=h.PC_NAMES.indexOf(bh.key.tonic);if(b>=0)try{al?.({tonic:b,mode:String(bh.key.scaleId||"")?.toLowerCase().includes("aeolian")||String(bh.key.scaleId||"").toLowerCase().includes("minor")?"Minor":"Major"})}catch{}(0,I.track)("open_project",{page:"chord_progression",id:bh.id}),bg(!1),bi(null)}catch{}},children:"Edit"}),(0,b.jsx)("button",{type:"button",className:"w-full chip-pressable inline-flex items-center justify-center gap-1 px-4 py-2 rounded-lg text-sm border",onClick:async()=>{try{await bB(bh),bi(null)}catch{}},children:"Export"}),(0,b.jsx)("button",{type:"button",className:"w-full chip-pressable inline-flex items-center justify-center gap-1 px-4 py-2 rounded-lg text-sm border",onClick:()=>bi(null),children:"Cancel"})]})]})]}),(0,b.jsx)("div",{ref:E,"aria-hidden":!0,style:{position:"fixed",left:0,top:0,zIndex:9999,opacity:1e-4,pointerEvents:"none",width:800,height:600,background:"#ffffff",color:"#000000",padding:24,borderRadius:12,border:"2px solid #cbd5e1",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:(()=>{let a=bz||(bt?.trim()?bt:bv),c=aj?`${h.PC_NAMES[aj.tonic]} ${aj.mode}`:"-",d=M.join(" "),e=an?(0,i.scaleTypeLabel)(an.type):"-",g=(()=>{let a=an?an.root:void 0,c=an&&"number"==typeof a?(0,i.getScalePitchesById)(a,an.type).map(a=>h.PC_NAMES[a]):[],d=aB?aq:"degrees",e=(()=>{let a=an?.type;return a&&(a.toLowerCase().includes("aeolian")||a.toLowerCase().startsWith("min"))?"min":"maj"})();return(0,b.jsx)("div",{style:{marginTop:8,background:"#ffffff",border:"2px solid #cbd5e1",borderRadius:"8px",padding:"12px",width:"100%"},children:(0,b.jsx)(f.default,{overlay:{viewMode:"sounding",capo:0,notes:c,chordNotes:au??void 0,showScaleGhost:!!au,display:d,scaleRootPc:"number"==typeof a?a:0,scaleType:an?.type??"Ionian",context:{chordRootPc:"number"==typeof a?a:0,quality:e}},onRequestForms:()=>{}})})})();return(0,b.jsxs)("div",{style:{background:"#ffffff",color:"#000000",fontFamily:"ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif",width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:"12px",padding:"8px"},children:[(0,b.jsx)("div",{style:{fontWeight:700,fontSize:24,color:"#000000",lineHeight:1.3},children:a}),(0,b.jsxs)("div",{style:{fontSize:18,color:"#000000",fontWeight:600},children:["Key: ",(0,b.jsx)("span",{style:{color:"#1e40af"},children:c})]}),(0,b.jsxs)("div",{style:{fontSize:16,color:"#000000",fontWeight:500},children:["Progression: ",(0,b.jsx)("span",{style:{color:"#1e40af"},children:d||"-"})]}),(0,b.jsxs)("div",{style:{fontSize:16,color:"#000000",fontWeight:500},children:["Scale: ",(0,b.jsx)("span",{style:{color:"#1e40af"},children:e})]}),(0,b.jsx)("div",{style:{flex:1,background:"#ffffff",border:"2px solid #cbd5e1",borderRadius:"8px",padding:"12px",overflow:"hidden"},children:g})]})})()}),ai.length>0?(0,b.jsxs)("div",{className:"space-y-4",children:[ai.length>0&&M.length<8&&(0,b.jsxs)("div",{className:"text-xs px-3 py-2 rounded-lg bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200",children:["⚠️ 精度向上のため、8コード以上の入力を推奨します（現在: ",M.length,"コード）"]}),(0,b.jsx)(u,{children:"Key"}),(0,b.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,b.jsx)("div",{className:"chip-row mb-2",role:"tablist","aria-label":"Key candidates",children:ai.map((a,c)=>{let d=aj&&aj.tonic===a.tonic&&aj.mode===a.mode,e=`${h.PC_NAMES[a.tonic]} ${a.mode}`,f=a.reasons.join("\n");return(0,b.jsxs)("button",{role:"tab","aria-selected":d,className:["chip chip--key",d?"chip--active":""].join(" "),title:`Why this key
${f}`,onClick:()=>al({tonic:a.tonic,mode:a.mode}),"data-roving":"item",children:[e," ",Math.round(a.confidence),"%"]},`${e}-${c}`)})})}),(0,b.jsxs)("div",{className:"result-block",children:[(0,b.jsx)(u,{children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:"Scale"}),(()=>{let a=an?.type??am?.[0]?.type??"Ionian",c=k.SCALE_CATALOG.find(b=>b.id===a);if(!c)return null;let d=(0,i.getScalePitchesById)(0,c.id).map(a=>h.PC_NAMES[a]).join(" ");return(0,b.jsx)(s.default,{title:c.display.en,className:"ml-1",linkHref:"/resources/glossary",linkLabel:"Glossary",children:(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("div",{className:"mb-1",children:[(0,b.jsx)("b",{children:"Degrees:"})," ",c.degrees.join(" ")]}),(0,b.jsxs)("div",{className:"mb-1",children:[(0,b.jsx)("b",{children:"Notes in C:"})," ",d]}),c.info?.oneLiner&&(0,b.jsxs)("div",{className:"mb-1",children:[(0,b.jsx)("b",{children:"About:"})," ",c.info.oneLiner]})]})})})()]})}),(0,b.jsx)("div",{className:"chip-row mb-2",role:"tablist","aria-label":"Scale candidates",children:am.map((a,c)=>{let d=(0,i.normalizeScaleId)(a.type),e=an?.type===d&&an?.root===a.root,f=`${h.PC_NAMES[a.root]} ${(0,i.scaleTypeLabel)(d)}`;return(0,b.jsxs)("button",{role:"tab","aria-selected":e,className:["chip chip--key",e?"chip--active":""].join(" "),onClick:()=>{ao(a),(0,I.track)("scale_pick",{page:"find-key",scale:a.type,key:h.PC_NAMES[a.root]})},"data-roving":"item",children:[f," ",Math.round(a.score),"%"]},`${f}-${c}`)})})]})]}):(0,b.jsx)("div",{className:"text-sm opacity-70",children:"Click Analyze to see results."})]}),(0,b.jsxs)("section",{className:"ot-card mt-2",children:[(0,b.jsx)(t,{children:"Tools"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"result-block",children:[(0,b.jsx)(u,{right:(0,b.jsxs)("div",{ref:n,className:"flex items-center gap-2 bg-transparent shadow-none fretboard-toggle","aria-label":"Fretboard notation",role:"tablist",children:[(0,b.jsx)("button",{role:"tab","aria-selected":"degrees"===aq,tabIndex:"degrees"===aq?0:-1,className:["chip chip--key","degrees"===aq?"chip--active":""].join(" "),onClick:()=>ar("degrees"),"data-roving":"item",children:"Degrees"}),(0,b.jsx)("button",{role:"tab","aria-selected":"names"===aq,tabIndex:aB&&"names"===aq?0:-1,"aria-disabled":!aB,className:["chip chip--key","names"===aq?"chip--active":"",!aB?"chip--disabled":""].join(" "),onClick:()=>{aB&&ar("names")},"data-roving":"item",children:"Names"})]}),children:"Fretboard"}),(0,b.jsx)("div",{className:"fret-wrap",children:(0,b.jsx)("div",{className:"fret-inner",children:an?(()=>{let a=an.root,c=(0,i.getScalePitchesById)(a,an.type).map(a=>h.PC_NAMES[a]),d=aB?aq:"degrees",e=(()=>{let a=an?.type;return a&&(a.toLowerCase().includes("aeolian")||a.toLowerCase().startsWith("min"))?"min":"maj"})();return(0,b.jsx)(f.default,{overlay:{viewMode:"sounding",capo:0,notes:c,chordNotes:au??void 0,showScaleGhost:!!au,display:d,scaleRootPc:a,scaleType:an.type,context:{chordRootPc:a,quality:e}},onRequestForms:(b,c)=>{ax({at:b,rootPc:c.rootPc??a,quality:c.quality})},formShape:ay})})():(0,b.jsx)("div",{className:"text-center text-sm opacity-50 py-8",children:"Click Analyze to see fretboard"})})})]}),(0,b.jsxs)("section",{className:"result-block space-y-2",children:[(0,b.jsx)(u,{children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:"Diatonic"}),(0,b.jsxs)(s.default,{className:"ml-1",title:"Diatonic chords",linkHref:"/resources/glossary",linkLabel:"Glossary",children:[(0,b.jsx)("p",{className:"text-sm",children:"Chords built only from the key’s scale tones (I–ii–iii–IV–V–vi–vii°)."}),(0,b.jsxs)("ul",{className:"mt-2 list-disc pl-5 space-y-1 text-sm",children:[(0,b.jsx)("li",{children:"Stable sound: everything stays inside the key."}),(0,b.jsx)("li",{children:"Use: begin inside → add color with a borrowed chord (iv, bVII, bVI)."}),(0,b.jsx)("li",{children:"Try: ii–V–I or IV–V–I for clear motion."})]}),(0,b.jsx)("h4",{className:"mt-3 font-medium",children:"Shaped vs. Sounding (Capo)"}),(0,b.jsxs)("ul",{className:"mt-1 list-disc pl-5 space-y-1 text-sm",children:[(0,b.jsx)("li",{children:"Shaped: labels show the shapes you fret after capo."}),(0,b.jsx)("li",{children:"Sounding: labels show the actual pitch you hear."})]})]})]})}),(0,b.jsx)(y.default,{selectedId:as,onSelectId:a=>at(a),onPick:async({id:a,pcs:b,isRightClick:c})=>{if(c){let b=r.useAnalysisStore.getState().selectedKey,c=r.useAnalysisStore.getState().selectedScale;if(!b||!c)return;let d=c.type,e=i.SCALE_INTERVALS[d]??[];if(7!==e.length){let a=(0,i.parentModeOf)(d);a&&(e=i.SCALE_INTERVALS[a]??[])}if(7!==e.length)return;let f=(0,j.diatonicTriads)({tonicPc:b.tonic,scaleIntervals:e})[parseInt(a.replace("open-",""))];if(!f)return;let g=(0,j.triadToChordSym)({rootPc:f.rootPc,quality:f.quality}),h=[...F];h[O]=g,J(h),O<11&&P(O+1),(0,I.track)("diatonic_pick",{page:"find-key",action:"right_click_add"});return}if(as===a){av(null),at(null),aA();return}av(b.map(a=>h.PC_NAMES[a])),at(a),aA(),(0,I.track)("diatonic_pick",{page:"find-key"});try{await D.player.resume();let a=b.map(a=>60+a%12);D.player.playChord(a,"lightStrum",260)}catch{}}})]}),aB&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u,{children:"Roman"}),(0,b.jsx)("div",{ref:bR,className:"rounded-md border px-3 py-2","aria-live":"polite","data-testid":"roman-row",children:(0,b.jsx)("div",{className:"flex-1 overflow-x-auto whitespace-nowrap text-lg md:text-xl tracking-wide",children:0===ag.length?(0,b.jsx)("span",{children:"-"}):ag.map((a,d)=>(0,b.jsxs)(c.default.Fragment,{children:[(0,b.jsx)("span",{"data-idx":d,className:bP&&d>=bP.start&&d<=bP.end?"roman-mark":void 0,children:String(a||"").toUpperCase()}),d<ag.length-1?(0,b.jsx)("span",{"aria-hidden":!0,className:"mx-1",children:"–"}):null]},`rom-${d}`))})})]}),bL.length>0&&(0,b.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs opacity-70",children:"Patterns"}),(()=>{var a;let c=bL[0],d={"doo-wop":"dooWop",axis:"axis",canon:"canon","ii-V-I":"twoFiveOne",turnaround:"turnaround",andalusian:"andalusian",authentic:"authentic",plagal:"plagal",deceptive:"deceptive"},e=d[c.id]?{label:A[a=d[c.id]],summary:B[a]}:null,f=e?.label||c.name.replace(/\(([^)]+)\)/g,(a,b)=>{let c=b.replace(/[ivx]+/g,a=>a.toUpperCase());return`(${c})`}).replace(/\(I–vi–IV–V\)/,"(I–VI–IV–V)"),g=e?.summary||c.summary||c.name;return bP&&bP.start===c.start&&(bP.end,c.end),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",className:"text-sm leading-tight font-medium hover:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400/50 rounded",title:g,onClick:()=>{bQ(a=>a&&a.start===c.start&&a.end===c.end?null:{start:Math.max(0,c.start),end:Math.max(c.start,Math.min(ag.length-1,c.end))}),requestAnimationFrame(()=>{let a=bR.current;if(!a)return;let b=a.querySelector(`[data-idx="${c.start}"]`);b&&(a.scrollLeft=Math.max(0,b.offsetLeft-12))})},children:f},`${c.id}-0`),(0,b.jsx)(s.default,{ariaLabel:`${f} – info`,text:`${f}

${g}`})]})})()]}),(bN.length>0||bT)&&(0,b.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs opacity-70",children:"Cadence"}),(()=>{let a=bN[0]??bT,c=a?.type??a,d=a?.tail??a?.tailRoman,e=c?"perfect"===c?`Perfect (${d?.from??"V"} → ${d?.to??"I"})`:"deceptive"===c?`Deceptive (${d?.from??"V"} → ${d?.to??"vi"})`:`Half (${d?.from?`${d.from} → `:"… → "}V)`:"";return(0,b.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-sm leading-tight",children:[(0,b.jsx)("span",{className:"font-medium",children:e}),(0,b.jsx)(s.default,{text:c?"perfect"===c?"Resolves to the Tonic: V → I. Feels fully resolved.":"deceptive"===c?"Surprises by avoiding I: V → vi (or similar).":"Phrase ends on the Dominant: … → V. Feels unresolved.":"No cadence detected."})]})})()]})]})]}),(0,b.jsx)("section",{className:"ot-card","aria-label":"Ad",children:(0,b.jsx)(d.default,{page:"chord_progression",format:"horizontal"})}),bm&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",style:{backdropFilter:"blur(4px)"},children:(0,b.jsxs)("div",{ref:bq,className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl p-6 max-w-md w-full mx-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Load Preset"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"text-xs opacity-70 mb-1 block",children:"Key"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].map(a=>(0,b.jsx)("button",{className:`chip ${bo===a?"chip--active":""}`,onClick:()=>bp(a),children:a},a))})]}),(0,b.jsxs)("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:[(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-V-vi-IV",["Ⅰ","Ⅴ","Ⅵm","Ⅳ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅴ–Ⅵm–Ⅳ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Pop progression"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("ii-V-I",["Ⅱm","Ⅴ","Ⅰ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅱm–Ⅴ–Ⅰ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Jazz turnaround"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("12-bar-blues",["Ⅰ","Ⅰ","Ⅰ","Ⅰ","Ⅳ","Ⅳ","Ⅰ","Ⅰ","Ⅴ","Ⅳ","Ⅰ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"12-bar Blues"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Classic blues form (all 12 slots)"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-II",["Ⅰ","Ⅱ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅱ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Simple two-chord progression"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-bVII-IV",["Ⅰ","♭Ⅶ","Ⅳ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅶ–Ⅳ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Rock progression"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("vi-IV-I-V",["Ⅵm","Ⅳ","Ⅰ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅳ–Ⅰ–Ⅴ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Emotional / Ballad (I-V-vi-IVの逆回転)"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-vi-IV-V",["Ⅰ","Ⅵm","Ⅳ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅵm–Ⅳ–Ⅴ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"50's progression / Doo-wop"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-IV-V",["Ⅰ","Ⅳ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅳ–Ⅴ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Three-chord song / Rock classic"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("vi-ii-V-I",["Ⅵm","Ⅱm","Ⅴ","Ⅰ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅱm–Ⅴ–Ⅰ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Circle progression / Jazz standard"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-bVII-bVI-bVII",["Ⅰ","♭Ⅶ","♭Ⅵ","♭Ⅶ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅶ–♭Ⅵ–♭Ⅶ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Mixolydian vamp / Rock anthem"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-IVm-I-V",["Ⅰ","Ⅳm","Ⅰ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅳm–Ⅰ–Ⅴ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Borrowed chord / Minor IV"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("vi-IV-I-III",["Ⅵm","Ⅳ","Ⅰ","Ⅲ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅳ–Ⅰ–Ⅲ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Andalusian cadence / Spanish feel"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-bIII-bVII-IV",["Ⅰ","♭Ⅲ","♭Ⅶ","Ⅳ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅲ–♭Ⅶ–Ⅳ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Modal interchange / Epic progression"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-iii-IV-V",["Ⅰ","Ⅲm","Ⅳ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅲm–Ⅳ–Ⅴ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Classic progression / Beatles style"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-V-vi-iii-IV-I-IV-V",["Ⅰ","Ⅴ","Ⅵm","Ⅲm","Ⅳ","Ⅰ","Ⅳ","Ⅴ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅴ–Ⅵm–Ⅲm–Ⅳ–Ⅰ–Ⅳ–Ⅴ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Pachelbel's Canon / Wedding classic"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-bVI-bVII-I",["Ⅰ","♭Ⅵ","♭Ⅶ","Ⅰ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅵ–♭Ⅶ–Ⅰ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Power ballad / 80s rock"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("vi-V-IV-III",["Ⅵm","Ⅴ","Ⅳ","Ⅲ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅵm–Ⅴ–Ⅳ–Ⅲ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Descending progression / Melancholic"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-IV-bVII-IV",["Ⅰ","Ⅳ","♭Ⅶ","Ⅳ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅳ–♭Ⅶ–Ⅳ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Folk/Country vamp"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-bVII-IV-I",["Ⅰ","♭Ⅶ","Ⅳ","Ⅰ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–♭Ⅶ–Ⅳ–Ⅰ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Stadium anthem / Closing progression"})]}),(0,b.jsxs)("button",{className:"w-full text-left px-4 py-2.5 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>bS("I-iii-vi-IV",["Ⅰ","Ⅲm","Ⅵm","Ⅳ"],bo),children:[(0,b.jsx)("div",{className:"font-medium",children:"Ⅰ–Ⅲm–Ⅵm–Ⅳ"}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Smooth descent / R&B style"})]})]}),(0,b.jsx)("button",{className:"mt-4 w-full px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>bn(!1),children:"Cancel"})]})}),bw&&(0,b.jsx)(aO,{message:bw.message,type:bw.type,ctaText:bw.ctaText,ctaHref:bw.ctaHref,ctaPlace:bw.ctaPlace,onClose:()=>bx(null)})]})}}];

//# sourceMappingURL=src_app_chord-progression_page_tsx_4b90b741._.js.map
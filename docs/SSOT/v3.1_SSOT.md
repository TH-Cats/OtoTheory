# OtoTheory v3.1 — Single Source of Truth（仕様 正本）

*最終更新: 2025/10/16*

> 本書は v3.0 SSOT をベースに、**Web Lite のGA（録音UI非露出）**、**iOS収益主軸**、**Undoキャンセル（非搭載）**、**PNG白背景固定** など合意事項を反映した **v3.1 差分統合版**です。旧版（v2.4〜v3.0）は参照資料とし、本書と矛盾する場合は本書を優先します。

---

## 0. 本版の主要決定（v3.0 → v3.1 の差分）

* **Webは M3 完了の Lite を GA**：録音UI（Melody/Solo Analyze）は**メニューから撤去**し、**Flag OFF**のまま（UI非露出）。
* **iOS を収益主軸**（M4）：**セクション編集**／**MIDI出力（Chord Track＋Section Markers＋Guide Tones）**／**Sketch無制限（クラウド）**／**IAP（¥490/月）**。
* **Undo は非搭載（キャンセル確定）**：個別削除・並べ替えで代替。**DoD と Telemetry から "undo" を削除**。
* **PNG 出力は白背景固定（v3.1）**：テーマ自動反転は将来再検討。`export_png` は**成功/失敗に関わらず1回のみ**発火。
* v3.0の中核原則（**二層Overlay／非ヘプタ規則／Capo Top2（Shapedのみ・無音）／"試聴→＋Add→即ループ"**）は継続。

---

## 1. 画面モジュール（共通哲学）

* **結果カード**：Key ≤3 候補＋% → **Diatonic** → **Fretboard（二層 Overlay）** → **Patterns / Cadence / 基礎代理**。操作は **「試聴→＋Add→即ループ」2タップ以内**。
* **二層 Overlay**：Scale 層＝輪郭/小/無地、Chord 層＝塗り/大/ラベル。**Reset＝Chordのみ**。**Degrees / Names** のみトグル。
* **非ヘプタ**：Roman 非表示・Diatonic は Open 限定（**Pent/Blues は例外的に Roman 表示**）。
* **Capo**：Diatonic 折りたたみ内に **Top2（Shaped 表記）**。**音は鳴らさない**。注記 *Shaped=fingered / Sounding=actual* を併記。
* **スケール名称の統一**：**Ionian → "Major Scale"**、**Aeolian → "Natural Minor"** と表記。ロック/ポップでは一般的な呼称を優先し、モード名は Dorian, Lydian 等の他モードのみ使用。

### 1.1 Chord Progression（メイン）

* **Lite（Web／iOS Free）**

  * 12コード上限／**プリセットFree 20種**／自動ループ（4/4・BPM）／**Undoなし**／Sketch 3件（ローカル）。
  * 他画面からの`＋Add to progression`で即挿入＆自動再生。
  * **Advanced Chord制限** ✅ 完了（2025-10-14）：
    - **Altered Dominant**: 7b9, 7#9, 7#11, 7b13, 7alt → 👑 Pro専用
    - **13th系**: 13, M13, m13 → 👑 Pro専用
    - **Slash/On-Bass**: C/E等のベース音指定 → 👑 Pro専用
    - **視聴（Play）**: すべてのコードで可能（Free/Pro共通）
    - **Add to Progression**: Free版では上記Pro専用コードの追加がブロックされる
    - **👑 Proバッジ**: Pro専用コードのチップ右上に小さく表示（Free時のみ）
    - **11th警告**: maj/domで`11`選択時、セッション1回のみ警告表示

* **Pro（iOS）**

  * **プリセット50種（Free 20＋Pro 30）** ✅ 完了（2025-10-14）
    - 7カテゴリー（Pop, Rock, Jazz, Blues, Ballad, R&B/Soul, Acoustic）
    - Pro専用30種（Pop 10, Rock 5, Jazz 7, Blues 2, R&B/Soul 3, Acoustic 3）
    - チップスタイルUI、プリセット数表示、魅力的なPro誘導
  * **セクション編集**（Verse/Chorus/Bridge…）：**各セクションが独立したコード進行を持つ** ✅ 完了（2025-10-13）
    - Post-chorusセクションタイプを含む10種類のセクション
    - PlaybackOrderEditor（ドラッグ&ドロップ、繰り返し回数調整）
  * **MIDI出力**：SMF Type‑1、5トラック（**Guitar＋Bass＋Scale Guide×2＋Guide Tones**）✅ 完了
  * **Sketch無制限（クラウド同期）** ✅ 完了（2025-10-14）／**IAP（¥490/月）**
    - CloudKit統合（iCloud自動バックアップ & デバイス間同期）
    - Pro: 無制限保存、Free: 3個制限（LRU削除）
    - 競合解決: Last-Write-Wins（lastModified基準）
    - UI: 同期状態表示、最終同期日時、エラー表示、Pro誘導
    - **要設定**: Xcode Capabilities（iCloud + CloudKit有効化）
  * **Fretboard & Diatonic & Roman（Chord Progression）** ✅ 完了（2025-10-13）：
    - Result下のToolsセクションに統合（Web版同様の構成）
    - **Fretboard**: Degrees/Names toggle、ダイアトニック選択時のコードトーンoverlay表示、全モード対応
    - **Diatonic Table**: タップで再生、長押しで進行に追加、全モード対応（11スケール）
    - **Roman Numerals**: 進行をローマ数字表記で表示（横スクロール対応）。Major=大文字、minor=小文字、dim=°、aug=+（例: I–vi–IV–V）
    - **Patterns**: 6種類の一般的なパターンを自動検出（Canon、Doo-wop、ii-V-I等）
    - **Cadence**: 4種類の終止形を自動検出（Perfect、Plagal、Deceptive、Half）
  * **iOS実装状況（2025-10-14）**：
    - ✅ **コード追加機能**（長押しで追加、Toast通知、ハプティク、スロットハイライト）
    - ✅ **ProgressionStore**（共有ストア、状態管理）
    - ✅ **Advanced Chord Builder**（Phase E-4B完了）
    - ✅ **Slash Chord Editor**（Phase E-4C完了）
    - ✅ **Section別コード進行**（Phase E-5A~F完了）
    - ✅ **PlaybackOrderEditor**（Phase E-5C完了）
    - ✅ **Fretboard & Diatonic in Chord Progression**（Phase E-6A~B完了）
    - ✅ **Roman Numerals**（Phase E-6C完了）
    - ✅ **Patterns自動検出**（Phase E-6D完了）
    - ✅ **Cadence自動検出**（Phase E-6E完了）
    - ✅ **Sketch保存機能**（Phase E-7完了）
    - ✅ **UX改善 & MIDI修正**（Phase E-8完了）：
      - MIDI小節数修正（barDuration: 8.0 → 4.0）
      - Sectionsボタンの混乱解消（Enable Sections vs Section）
      - 上部メニューボタンのレイアウト改善（2行、縦型デザイン）
    - ✅ **プリセット拡張**（Phase 5完了）：
      - 50種のプリセット（Free 20 + Pro 30）
      - 7カテゴリー（Pop, Rock, Jazz, Blues, Ballad, R&B/Soul, Acoustic）
      - チップスタイルUI、プリセット数表示、Pro誘導強化
    - ✅ **Sketch無制限＋クラウド同期**（Phase 4完了）：
      - CloudKitManager（iCloud統合、CRUD、競合解決）
      - SketchManager拡張（Pro判定、自動同期、エラーハンドリング、Singleton化）
      - UI強化（同期状態表示、Pro/Free区別、Paywall統合）
      - CloudKit設定完了（Bundle ID: TH-Quest.OtoTheory、Container: iCloud.TH-Quest.OtoTheory）
      - recordNameインデックス追加（QUERYABLE）
      - **UX改善**: Sketch導線統一（タブバーのみ）、Convert to Section機能拡張（Type選択、Name編集、重複時の自動番号付与）

### 1.2 Find Chords（キー/スケール→使えるコード）

* Key/Scale 選択で **Diatonic→Fretboard** 即更新。**Scale Table（2–3件＋Why＋ⓘGlossary＋短いアルペジオ）**／**Chord Forms（Open/Barre＋試聴）**／**基礎代理（2–3件＋試聴/＋Add）** を搭載。
* **iOS（Phase E-1 ~ E-4A完了）**：
  - ✅ **Fretboard二層Overlay**（15フレット、Landscape Full-Screen、強制横向き）
  - ✅ **Diatonic Table**（Open + Capo Top2、長押しでProgression追加）
  - ✅ **Suggested Scales**（Chord quality判定、アルペジオ試聴）
  - ✅ **Substitute Chords**（和声理論ベース、長押しでProgression追加）
  - ✅ **Toast通知＋ハプティクフィードバック**
  - ⏳ **Advanced Chord Builder**（次回実装予定）

### 1.3 Resources（学習リソース）✅ 完了（2025-10-13）

* **3つのサブセクション構成**（Reference → Resources にリブランド）：
  - **Glossary**（用語解説）：音楽理論用語の定義と解説（日英対応）
  - **Music Theory**（理論解説）：ギタリスト向けの実践的理論ガイド（日英対応）
  - **Chord Library**（コードライブラリ）：インタラクティブなコードフォーム集

* **Chord Library 機能**：
  - **フォーム表示**：
    - **v3.1 現状（Static v0, iOS）**：Open / Root‑6 / Root‑5 / Root‑4 / Triad（3和音）
    - **表示順を固定**：Open → Root‑6 → Root‑5 → Root‑4 → Triad‑1 → Triad‑2
    - **今後拡張**：Triad転回形（第1・第2転回形）
    - **タイトル推定**：`shapeName`が未指定のフォームはUIで名称を推定（開放弦/バレー有無）
    - **My Forms保存**：Free=ローカル（最大30）／Pro=CloudKit同期（無制限）
    - **長押し導線**：Find Chords/Progressionのコードチップから「フォームを確認」でライブラリページへ
  - **横向きフレットボード**：標準的なギター配置（1弦が上、6弦が下）、横向き推奨UI
  - **3つの表示モード**：
    - Finger：指番号表示（1,2,3,4）
    - Roman：音程表示（R, III, V, ♭VII など）
    - Note：音名表示（C, E, G など）
  - **音再生機能**：
    - Play（▶）：ストラム（じゃーん）再生 — すべてのコードで利用可能（Pro制限なし）
    - Arp：アルペジオ再生 — すべてのコードで利用可能（Pro制限なし）
    - Web Audio API による高品質サウンド
  - **構成音表示**：コード名の下に「R · III · V | C · E · G」形式で表示
  - **40+種類のコード対応**：Major, minor, 7th, M7, m7, 6, m6, aug, dim, sus2, sus4, 9th, 11th, 13th, altered など
  - **開放弦表示**：Roman/Noteモードでは開放弦にも音程/音名を表示
  - **Pro制限対応**（Chord Progression機能で使用時）：
    - **Altered Dominant**: 7b9, 7#9, 7#11, 7b13, 7alt → 👑 Pro専用
    - **13th系**: 13, M13, m13 → 👑 Pro専用
    - **Slash/On-Bass**: C/E等のベース音指定 → 👑 Pro専用
    - **視聴（Play）**: すべてのコードで可能（Free/Pro共通）
    - **Add to Progression**: Free版では上記Pro専用コードの追加がブロックされる
    - **👑 Proバッジ**: Pro専用コードのチップ右上に小さく表示（Free時のみ）
  - **11th警告機能**：maj/domコンテキストで`11`選択時、セッション1回のみ警告表示（「3rdと衝突」）

#### 1.3.1 Chord Library ページ文言（マスター）

本節はChord Libraryページで使用する説明テキストのマスター（JP/EN）です。実装はi18n（`messages.ts`）から参照し、本節と矛盾時は本節を優先して更新します。

【JP】
- インタラクティブカード（3つのクリック可能カード）
  - 🎯 使い方
    - ルート音とコードタイプを選択するだけで、様々なコードフォームが表示されます。「指」「度数」「音名」ボタンで詳細情報を切り替えられます。
  - 🎵 実用的なコードフォーム
    - オープンコード、6/5/4弦ルート、トライアド（高/中域）など、作曲やアレンジに役立つフォームを厳選。曲の流れに合うフォームを素早く比較できます。
  - 👁️ 視覚化と音の確認
    - 左上に構成音と度数を表示。「度数」「音名」ボタンでフレット上に可視化できます。Play/Arpで音を確認し、右クリックでコード進行スロットへ保存できます。
- ヘルプ（Info）
  - 指番号: ①人差し指 ②中指 ③薬指 ④小指 T親指
  - 度数表示: 度数表示（Root=1、長3度=3、短7度=b7 など）
  - 音名表示: フレットボード上の実際の音名を表示します

【EN】
- Interactive Cards (3 clickable cards)
  - 🎯 How to Use
    - Simply select a root note and chord type to display various chord forms. Switch between detailed information using "Finger", "Intervals", and "Note Names" buttons.
  - 🎵 Practical Chord Forms
    - Carefully selected forms useful for composition and arranging, including open chords, 6/5/4 string roots, and triads (high/mid range). Quickly compare forms that fit your song's flow.
  - 👁️ Visualization & Audio Preview
    - Shows chord tones and intervals in the top-left. Visualize on the fretboard using "Intervals" and "Note Names" buttons. Preview audio with Play/Arp and save to chord progression slots with right-click.
- Info
  - Finger: 1 Index, 2 Middle, 3 Ring, 4 Pinky, T Thumb
  - Intervals: Intervals view (Root=1, Major 3rd=3, Minor 7th=b7, etc.)
  - Note Names: Shows actual note names on the fretboard

* **SEO最適化**：
  - 各ページに専用メタデータ（title, description, keywords, OpenGraph）
  - `/resources`、`/resources/glossary`、`/resources/music-theory`、`/resources/chord-library`
  - 301リダイレクト設定（旧`/reference` → 新`/resources`）

* **ナビゲーション**：
  - メインナビゲーションバーに「Resources」リンク
  - Chord Libraryは「Find Chords」の右隣に専用リンク配置
  - レスポンシブ対応（モバイルでは改行表示）

### 1.4 Melody/Solo Analyze（録音→Key/Scale）

* **v3.1 は UI 非露出（Flag OFF）**。Line‑in 前提／停止後サーバ解析。将来解禁時も **Key候補≤3＋Conf%** と**低信頼時の再録ガイド**を必須。

---

## 2. 保存（Sketch）

* 保存単位は **Sketch（ソングスケッチ）**。
* **保存内容**：
  - **Free**: Key＋Scale＋進行（≤12）＋Fretboard表示状態（Degrees/Names＋Overlay）
  - **Pro**: 上記＋**セクション進行**（SectionDefinitions＋PlaybackOrder）
* **Free**：ローカル 3 件（LRU 上書き／自動保存 3 秒）。**Pro**：無制限（クラウド同期）。復元時も **非ヘプタ規則／Capo注記** を厳守。

---

## 3. 出力・共有

* **PNG（Free）**：**白背景固定（v3.1）**・視認性最適化。`export_png` は保存成否に関わらず **1回のみ**発火。
* **テキスト（Free）**：Key/Scale／Diatonic／進行（Roman/実音）／Capo注記のコピー。
* **MIDI（iOS Pro）**：**Chord Track＋Section Markers＋Guide Tones** を SMF Type‑1 で書き出し。

---

## 4. Free / Pro 境界

* **Free（Web/iOS）**：Find Chords 拡張／二層 Overlay／Capo Top2／Progression Lite（12上限・**プリセットFree 20種**・自動ループ）／Sketch 3 件／PNG・テキスト出力。
* **Pro（iOS）**：**プリセット50種（Free 20＋Pro 30）**／**セクション編集**／**MIDI 出力**／**Sketch無制限**／将来の高度機能。

---

## 5. Telemetry（最小セット）

* **共通**：`page_view, key_pick, scale_pick, diatonic_pick, overlay_shown, fb_toggle, overlay_reset, play_note, play_chord, export_png, instrument_change`（**1操作=1発火**）※`overlay_shown`は**初回ユーザー操作時のみ**。`page_view` ラベルは `chord_progression / find_chords / melody_solo_analyze`（旧ラベル互換は90日維持）。
* **進行**：`progression_play, preset_inserted, toast_shown(kind)`（`limit_warn / limit_block / low_conf`。**undoは廃止**）、**`cta_appstore_click{place}`**（header/sticky/limit_toast/png_toast/qr）。
* **保存**：`save_project, open_project, project_rename, project_delete, project_duplicate, project_limit_warn, project_limit_block`。
* **録音（将来露出）**：`audio_record_start/stop, audio_analyze_ok, audio_analyze_conf(engine,conf)`（Flag OFFのまま維持）。
* **広告（Web版のみ）**：`ad_shown{page}`（広告表示時、ページごとに記録）✅ 完了（2025-10-13）

---

## 6. 受け入れ基準（DoD）

1. **Find Chords**：Key/Scale 選択のみで Result 更新。Open 行タップで和音再生＆Chord 層強調。Reset で Scale は保持。
2. **Capo**：折りたたみ内に **Top2（Shaped）**＋注記。音は鳴らさない。
3. **Progression**：**ドラッグ並べ替え／プリセット→自動ループ**が動作（**Undoなし**）。
4. **提案の追加**：Patterns / Cadence / 基礎代理 は **試聴→＋Add** が 2 タップ以内、直後に自動再生。
5. **Sketch**：Key/Scale・Capo（Shaped）・進行・Overlay 表示を完全復元。Free=3 件、Pro=無制限。
6. **出力**：Free＝PNG（白固定）/テキスト、Pro＝MIDI（Chord+Markers+Guide）。`export_png` は必ず 1 回。
7. **録音（将来 Flag ON 時）**：Line‑inのみ開始可。停止→Key 候補≤3＋Conf% 表示、低信頼は Advice。デフォルトは UI 非露出。

---

## 7. ロードマップ（期日なし方式）

* **M3.5 Web Lite GA**：Analyze撤去・6面CTA・`cta_appstore_click` 追加。
* **M4 iOS v1**：Free＝M3パリティ／Pro＝**セクション編集・MIDI（Chord+Markers+Guide）・無制限保存・IAP**。
* **M4.1+（任意）**：Split Bar／Groove（簡易ドラム）／ミニベース（パターンのみ）／**MIDI多トラック拡張**。**ミニDAW化は回避**。
* **M5 Polish**：A11y・Telemetry最終化・PNG反転の将来再検討。


---

## 8. Web版収益化（広告）✅ 完了（2025-10-13）

### 8.1 Google AdSense統合

**目的**：Web版（Free）の収益化施策として、Google AdSenseを統合

**実装内容**：
- **パブリッシャーID**: `ca-pub-9662479821167655`
- **配置箇所**（4ページ）：
  - ホームページ（`/`）：ページ下部に横長フォーマット
  - Chord Progression（`/chord-progression`）：Toolsセクション下
  - Find Chords（`/find-chords`）：メインコンテンツ下
  - Chord Library（`/resources/chord-library`）：フッター下（ダークテーマ対応スタイリング）

**Pro版対応**：
- Pro版ユーザーには広告を非表示（`usePro()`フックで判定）
- 将来的にiOS Pro購入者がWeb版でも広告非表示となる連携を想定

**技術実装**：
- Next.js `Script`コンポーネントでAdSenseスクリプト読み込み（`afterInteractive`）
- `AdSlot.client.tsx`コンポーネントで広告表示を一元管理
- CLS（Cumulative Layout Shift）対策：`minHeight: 110px`でレイアウトシフトを防止
- ads.txt設置：`google.com, pub-9662479821167655, DIRECT, f08c47fec0942fa0`
- 認証メタタグ：`<meta name="google-adsense-account" content="ca-pub-9662479821167655">`

**Telemetry**：
- `ad_shown{page}` イベント（ページごとの広告表示を記録）
- ページ値：`home / chord_progression / find_chords / chord_library`

**ドキュメント**：
- 詳細な設定手順は `ototheory-web/AD_SETUP_GUIDE.md` に記載
- トラブルシューティング、審査手順も含む

---

## 9. リスク / 決めごと

* **ミニDAW化の回避**：パターンの範囲に限定、音色作り込まず、成果物は **MIDI** に集中。
* **録音の扱い**：**Flag OFF 維持**。合格指標（例：Top‑1≥85% 等）に達するまで解禁しない。
* **表記整合**：非ヘプタ例外（Pent/Blues Roman）／Capo注記／二層Overlayのルールを全画面で統一。

---

## 10. 運用メモ（リポジトリ／PR手順）

* **配置**：`docs/SSOT/OtoTheory_v3.1_SSOT.md`（本書）。旧版は `docs/SSOT/legacy/` へ移動し「参照目的のみ」と明記。
* **PR テンプレ**：SSOT欄は**要更新**を選択。**Roadmap / Implementation SSOT** も同時に差分PR（Undo削除／PNG白固定／Analyze非露出を揃える）。
* **計測タグ**：Webの送客強化に伴い **`cta_appstore_click{place}`** を新設。既存イベント（`export_png / progression_play / preset_inserted / instrument_change / toast_shown` など）と統合して可視化。


---

### 備考（非エンジニア向け）

* **使い方はシンプル**：①Key/Scale→②Diatonic＋Fretboard（二層）→③提案を**試聴→＋Add→即ループ**→④良ければ**Sketch保存**。
* **迷ったらこのSSOT**：**Capo Top2（Shapedのみ）／非ヘプタのRoman非表示／Reset＝Chordのみ** を守れば体験は自然に揃います。

---

## 7. サイト/ポリシー（v3.1）

**目的**：App Store審査通過率の向上と利用者の信頼担保（法務・サポートの可視化）

**実装済みURL**（JP/EN）：
- `/privacy` - プライバシーポリシー
- `/terms` - 利用規約
- `/support` - サポート・お問い合わせ
- `/faq` - よくある質問
- `/about` - OtoTheoryについて
- `/pricing` - 料金プラン

**コアツール**：
- `/chord-progression` - コード進行ビルダー（旧 /find-key 統合）
- `/find-chords` - コード検索ツール
- `/resources` - リソースハブ
  - `/resources/chord-library` - コードライブラリ
  - `/resources/music-theory` - 音楽理論ガイド
  - `/resources/glossary` - 用語集
- `/getting-started` - 使い方ガイド

**非搭載機能**：
- ~~`/analyze`~~ - 録音機能（Flag OFF、UI非露出）

**導線**：
- フッター常設リンク（全画面共通）
- App内「設定」＞「プライバシー/利用規約」へ1タップ遷移
- Web Lite本体から6面CTA（ヘッダー／下部スティッキー／到達トースト／保存制限／PNG後／フッターQR）で App Store誘導

**Free/Proの境界**（従来通り）：
- Free=PNG/テキスト、Pro=iOSのMIDI（Chord+Markers+Guide）
- 録音UIはβ/Flag OFF（UI非露出）

**計測**：
- Web Lite（M3完了機能）からApp Storeへ6面CTAで誘導
- `cta_appstore_click{place}` を追加（Web→iOSファネル可視化）
- `export_png` は成功/失敗に関わらず1回のみ

**KPI**：
- 公開14日内の審査一次指摘0件
- Support返信SLA=2営業日以内

---

## 日本語UI定義（v3.1 JP terminology alignment）

本節は日本市場向けUI統一方針に基づく用語の最終定義です。英語表記は現行維持（My Sketches, My Chords, Preset Progressions）。iOS / Web 双方で統一し、以下の画面で同一表記を用います（トップメニュー／コード進行エディタ／コードライブラリ）。

- My進行（EN: My Sketches）
  - 説明: 自分で作ったコード進行を保存・呼び出せる機能。
  - プラン: Free=ローカル最大3件、Pro=クラウド同期＆無制限保存。
  - 表示箇所: トップメニュー導線（iOSはタブ）、コード進行エディタ内の呼び出しUI、コードライブラリからの保存導線。

- Myコード（EN: My Chords）
  - 説明: お気に入りのコードフォームを保存できる機能。
  - 備考: コード進行作成画面からも呼び出し可能。Chord Libraryとの連携導線を持つ。

- プリセット進行（EN: Preset Progressions）
  - 説明: あらかじめ用意した進行テンプレート群。カテゴリ別（Pop, Rock, Jazz, など）。

注記: 本節はSSOT差分記録の一環として追加（変更履歴コメント: v3.1 JP terminology alignment）。

### 日本語UI訳語マスター（参照）

管理ファイル:
- docs/SSOT/terminology/v3.1_ja_master_terms.md（人間可読）
- docs/SSOT/terminology/v3.1_ja_master_terms.csv（機械可読: area,key,en,ja,notes）

本編と矛盾時は本SSOTを最優先とし、マスター側を更新すること。

### 度数表記のルール（Interval / Degree Notation Rules）

【1】コード進行での度数表記（Chord Progression / Roman Numerals）
目的：度数とコードのクオリティを同時に表現

表記ルール：
- メジャーコード → 大文字（I, IV, V）
- マイナーコード → 小文字（ii, iii, vi）
- ディミニッシュコード → 小文字+°（vii°）
- オーギュメントコード → 大文字+augまたは+（III+）

例（Cメジャーのダイアトニック）: I (C), ii (Dm), iii (Em), IV (F), V (G), vi (Am), vii° (Bdim)

【2】スケール/音程での度数表記（Scale Intervals）
目的：各音の音程の性質を明確に表現

表記ルール：
- Perfect（完全音程） → 大文字P（P1, P4, P5, P8）
- Major（長音程） → 大文字M（M2, M3, M6, M7）
- minor（短音程） → 小文字m（m2, m3, m6, m7）
- Augmented（増音程） → 大文字A（A4, A5 など）
- diminished（減音程） → 小文字d（d5, d7 など）

例：
- メジャースケール: 1 - M2 - M3 - P4 - P5 - M6 - M7
- ナチュラルマイナー: 1 - M2 - m3 - P4 - P5 - m6 - m7
- ドリアン: 1 - M2 - m3 - P4 - P5 - M6 - m7

【3】実装上の注意点
- コード進行表記：大文字小文字の区別でコードタイプを判別
- スケール表記：P/M/m/A/d の接頭辞で音程の質を判別
- 両方とも数字は度数（1-7または1-8）を表す

